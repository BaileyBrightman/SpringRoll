<!DOCTYPE html>
<html lang='en'>

<head>
  <title>SpringRoll v0.3.0 API Documentation : src/displays/easeljs/cutscene/Cutscene.js</title>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>
  <link rel='shortcut icon' type='image/png' href='../assets/images/favicon.ico?v=0.3.0'>
  <link href='//fonts.googleapis.com/css?family=Titillium+Web:300,200,600' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' type='text/css' href='../assets/css/libraries.css?v=0.3.0'>
  <link rel='stylesheet' type='text/css' href='../assets/css/main.css?v=0.3.0'>
</head>

<body>
  <header>
    <div class='container'>
      <div class='version pull-right'>
        <em>API Documentation for: 0.3.0</em>
      </div>
      <div class='logo'>

        <h1><a href='https://github.com/SpringRoll/SpringRoll'><img src='../assets/images/logo.png?v=0.3.0' title='SpringRoll'><span class='project-name'>SpringRoll</span></a></h1> 
      </div>
<div class='scope-toggles pull-right'>
  <input class='scope-toggle' id='toggle-inherited' type='checkbox' data-toggle='toggle' data-on='Inherited' data-off='Inherited' data-size='mini'>
  <input class='scope-toggle' id='toggle-protected' type='checkbox' data-toggle='toggle' data-on='Protected' data-off='Protected' data-size='mini'>
  <input class='scope-toggle' id='toggle-private' type='checkbox' data-toggle='toggle' data-on='Private' data-off='Private' data-size='mini'>
  <input class='scope-toggle' id='toggle-deprecated' type='checkbox' data-toggle='toggle' data-on='Deprecated' data-off='Deprecated' data-size='mini'>
</div>    </div>
  </header>
  <div class='container'>
    <div class='row'>
      <nav id='sidebar' class='col-sm-4 col-md-3'>
<h2>APIs</h2>
<div class='input-group'>
  <div class='input-group-addon'>
    <span class='glyphicon glyphicon-search'></span>
  </div>
  <input type='search' class='form-control' id='api-filter' placeholder='Type to filter APIs'>
</div>
<nav class='navbar navbar-default'>
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="btn-group" role="group" aria-label="...">
    <button type="button" class="sidebar-toggle collapsed btn btn-default" id='toggle-classes' data-target='#classes-collapse'>
      Classes
      <span class='collapsed glyphicon glyphicon-chevron-up'></span>
      <span class='expanded glyphicon glyphicon-chevron-down'></span>
    </button>
    <button type="button" class="sidebar-toggle collapsed btn btn-default"id='toggle-modules'  data-target='#modules-collapse'>
      Modules
      <span class='collapsed glyphicon glyphicon-chevron-up'></span>
      <span class='expanded glyphicon glyphicon-chevron-down'></span>
    </button>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class='collapse' id='classes-collapse'>
    <ul class='nav navbar-nav'>
        <li class=''>
          <a href='../classes/createjs.Container.html'>createjs.Container</a>
        </li>
        <li class=''>
          <a href='../classes/createjs.MovieClip.html'>createjs.MovieClip</a>
        </li>
        <li class=''>
          <a href='../classes/createjs.Point.html'>createjs.Point</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.AbstractDisplay.html'>springroll.AbstractDisplay</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.AbstractHint.html'>springroll.AbstractHint</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.AnimatorHint.html'>springroll.AnimatorHint</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Application.html'>springroll.Application</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.ApplicationOptions.html'>springroll.ApplicationOptions</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.ApplicationPlugin.html'>springroll.ApplicationPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.BaseState.html'>springroll.BaseState</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.CacheManager.html'>springroll.CacheManager</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Captions.html'>springroll.Captions</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.CaptionsPlugin.html'>springroll.CaptionsPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.CombinedCallback.html'>springroll.CombinedCallback</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.ConfigPlugin.html'>springroll.ConfigPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Container.html'>springroll.Container</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.ContainerPlugin.html'>springroll.ContainerPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Debug.html'>springroll.Debug</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.DebugOptions.html'>springroll.DebugOptions</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.DebugPlugin.html'>springroll.DebugPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.DelayedCall.html'>springroll.DelayedCall</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.Animator.html'>springroll.easeljs.Animator</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.AnimatorPlugin.html'>springroll.easeljs.AnimatorPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.AnimatorTimeline.html'>springroll.easeljs.AnimatorTimeline</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.AssetManager.html'>springroll.easeljs.AssetManager</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.BasePanel.html'>springroll.easeljs.BasePanel</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.BaseState.html'>springroll.easeljs.BaseState</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.BitmapMovieClip.html'>springroll.easeljs.BitmapMovieClip</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.BitmapUtils.html'>springroll.easeljs.BitmapUtils</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.Button.html'>springroll.easeljs.Button</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.Cutscene.html'>springroll.easeljs.Cutscene</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.DisplayAdapter.html'>springroll.easeljs.DisplayAdapter</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.DragManager.html'>springroll.easeljs.DragManager</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.DwellTimer.html'>springroll.easeljs.DwellTimer</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.EaselJSDisplay.html'>springroll.easeljs.EaselJSDisplay</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.ManifestsPlugin.html'>springroll.easeljs.ManifestsPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.OffClickPlugin.html'>springroll.easeljs.OffClickPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.ReversePlayback.html'>springroll.easeljs.ReversePlayback</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.SoundButton.html'>springroll.easeljs.SoundButton</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.Texture.html'>springroll.easeljs.Texture</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.easeljs.TextureAtlas.html'>springroll.easeljs.TextureAtlas</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Enum.html'>springroll.Enum</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.EnumValue.html'>springroll.EnumValue</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.EventCatalog.html'>springroll.EventCatalog</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.EventDispatcher.html'>springroll.EventDispatcher</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.EventError.html'>springroll.EventError</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.EventSignature.html'>springroll.EventSignature</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.EventUtils.html'>springroll.EventUtils</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Features.html'>springroll.Features</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.FunctionHint.html'>springroll.FunctionHint</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.FunctionTask.html'>springroll.FunctionTask</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.GroupHint.html'>springroll.GroupHint</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.HintsPlayer.html'>springroll.HintsPlayer</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.HintsPlugin.html'>springroll.HintsPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Languages.html'>springroll.Languages</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LanguagesPlugin.html'>springroll.LanguagesPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Learning.html'>springroll.Learning</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LearningError.html'>springroll.LearningError</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LearningMedia.html'>springroll.LearningMedia</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LearningMediaPlugin.html'>springroll.LearningMediaPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LearningPlugin.html'>springroll.LearningPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.ListTask.html'>springroll.ListTask</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Loader.html'>springroll.Loader</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LoaderPlugin.html'>springroll.LoaderPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LoaderQueueItem.html'>springroll.LoaderQueueItem</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LoaderResult.html'>springroll.LoaderResult</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.LoadTask.html'>springroll.LoadTask</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.native.Circle.html'>springroll.native.Circle</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.native.DisplayAdapter.html'>springroll.native.DisplayAdapter</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.native.Ellipse.html'>springroll.native.Ellipse</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.native.NativeDisplay.html'>springroll.native.NativeDisplay</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.native.Point.html'>springroll.native.Point</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.native.Polygon.html'>springroll.native.Polygon</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.native.Rectangle.html'>springroll.native.Rectangle</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.PageVisibility.html'>springroll.PageVisibility</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.PageVisibilityPlugin.html'>springroll.PageVisibilityPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.Animator.html'>springroll.pixi.Animator</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.AnimatorPlugin.html'>springroll.pixi.AnimatorPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.AnimatorTimeline.html'>springroll.pixi.AnimatorTimeline</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.AssetManager.html'>springroll.pixi.AssetManager</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.Button.html'>springroll.pixi.Button</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.DisplayAdapter.html'>springroll.pixi.DisplayAdapter</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.DragManager.html'>springroll.pixi.DragManager</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.ParallelSpineData.html'>springroll.pixi.ParallelSpineData</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.pixi.PixiDisplay.html'>springroll.pixi.PixiDisplay</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.PixiTask.html'>springroll.PixiTask</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Positioner.html'>springroll.Positioner</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.PropertyDispatcher.html'>springroll.PropertyDispatcher</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.SavedData.html'>springroll.SavedData</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Sound.html'>springroll.Sound</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.SoundContext.html'>springroll.SoundContext</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.SoundInstance.html'>springroll.SoundInstance</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.SoundListTask.html'>springroll.SoundListTask</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.SoundPlugin.html'>springroll.SoundPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.StateEvent.html'>springroll.StateEvent</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.StateManager.html'>springroll.StateManager</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.StatesPlugin.html'>springroll.StatesPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.StringFilters.html'>springroll.StringFilters</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.StringFiltersPlugin.html'>springroll.StringFiltersPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.Task.html'>springroll.Task</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.TaskEvent.html'>springroll.TaskEvent</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.TaskManager.html'>springroll.TaskManager</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.TimeUtils.html'>springroll.TimeUtils</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.TouchPlugin.html'>springroll.TouchPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.UIElement.html'>springroll.UIElement</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.UIElementSettings.html'>springroll.UIElementSettings</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.UIScaler.html'>springroll.UIScaler</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.UIScalerPlugin.html'>springroll.UIScalerPlugin</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.ValidationError.html'>springroll.ValidationError</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.VOHint.html'>springroll.VOHint</a>
        </li>
        <li class=''>
          <a href='../classes/springroll.VOPlayer.html'>springroll.VOPlayer</a>
        </li>
        <li class=''>
          <a href='../classes/window.Array.html'>window.Array</a>
        </li>
        <li class=''>
          <a href='../classes/window.async.html'>window.async</a>
        </li>
        <li class=''>
          <a href='../classes/window.extend.html'>window.extend</a>
        </li>
        <li class=''>
          <a href='../classes/window.include.html'>window.include</a>
        </li>
        <li class=''>
          <a href='../classes/window.Math.html'>window.Math</a>
        </li>
        <li class=''>
          <a href='../classes/window.namespace.html'>window.namespace</a>
        </li>
        <li class=''>
          <a href='../classes/window.Object.html'>window.Object</a>
        </li>
        <li class=''>
          <a href='../classes/window.String.html'>window.String</a>
        </li>
    </ul>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class='collapse' id='modules-collapse'>
    <ul class='nav navbar-nav'>
        <li class=''>
          <a href='../modules/Captions.html'>Captions</a>
        </li>
        <li class=''>
          <a href='../modules/Container.html'>Container</a>
        </li>
        <li class=''>
          <a href='../modules/Container Client.html'>Container Client</a>
        </li>
        <li class=''>
          <a href='../modules/Core.html'>Core</a>
        </li>
        <li class=''>
          <a href='../modules/Debug.html'>Debug</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Animation.html'>EaselJS Animation</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Cutscene.html'>EaselJS Cutscene</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Display.html'>EaselJS Display</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Learning.html'>EaselJS Learning</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS States.html'>EaselJS States</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS UI.html'>EaselJS UI</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Utilities.html'>EaselJS Utilities</a>
        </li>
        <li class=''>
          <a href='../modules/Game.html'>Game</a>
        </li>
        <li class=''>
          <a href='../modules/Hints.html'>Hints</a>
        </li>
        <li class=''>
          <a href='../modules/Languages.html'>Languages</a>
        </li>
        <li class=''>
          <a href='../modules/Learning.html'>Learning</a>
        </li>
        <li class=''>
          <a href='../modules/Learning Media.html'>Learning Media</a>
        </li>
        <li class=''>
          <a href='../modules/Native Display.html'>Native Display</a>
        </li>
        <li class=''>
          <a href='../modules/PIXI Animation.html'>PIXI Animation</a>
        </li>
        <li class=''>
          <a href='../modules/PIXI Display.html'>PIXI Display</a>
        </li>
        <li class=''>
          <a href='../modules/PIXI UI.html'>PIXI UI</a>
        </li>
        <li class=''>
          <a href='../modules/Sound.html'>Sound</a>
        </li>
        <li class=''>
          <a href='../modules/Tasks.html'>Tasks</a>
        </li>
        <li class=''>
          <a href='../modules/UI.html'>UI</a>
        </li>
    </ul>
  </div>
  <!-- /.container-fluid -->
</nav>      </nav>
      <div class='col-sm-8 col-md-9'>
        <div id='docs-main' class='apidocs'>
<script>
  var name = {
  	{
  		name
  	}
  }
</script>
<h1 class="file-heading">File:Cutscene.js</h1>

<div class="file">
  <pre class="code prettyprint linenums">/**
 * @module EaselJS Cutscene
 * @namespace springroll.easeljs
 * @requires Core, Tasks, EaselJS Display, EaselJS Utilities
 */
(function()
{
	var Debug,
		Container = include(&#x27;createjs.Container&#x27;),
		BitmapUtils,
		Application,
		LoadTask,
		TaskManager,
		Sound,
		ListTask;

	/**
	*  Cutscene is a class for playing a single EaselJS animation synced to a
	*  single audio file with springroll.Sound, with optional captions. Utilizes the Tasks module.
	*
	*  @class Cutscene
	*  @constructor
	*  @param {Object} options The runtime specific setup data for the cutscene.
	*  @param {String|Display} options.display The display or display id of the EaselJSDisplay
	*                                          to draw on.
	*  @param {String} options.configUrl The url of the json config file describing the cutscene.
	*                                    See the example project.
	*  @param {Function} [options.loadCallback] A function to call when loading is complete.
	*  @param {String} [options.pathReplaceTarg] A string found in the paths of images that should
	*                                            be replaced with another value.
	*  @param {String} [options.pathReplaceVal] The string to use when replacing
	*                                           options.pathReplaceTarg.
	*  @param {Number} [options.imageScale=1] Scaling to apply to all images loaded for the
	*                                         cutscene.
	*  @param {Captions} [options.captions] A Captions instance to display captions text on.
	*/
	var Cutscene = function(options)
	{
		if(!Application)
		{
			Debug = include(&#x27;springroll.Debug&#x27;, false);
			Application = include(&#x27;springroll.Application&#x27;);
			LoadTask = include(&#x27;springroll.LoadTask&#x27;);
			TaskManager = include(&#x27;springroll.TaskManager&#x27;);
			Sound = include(&#x27;springroll.Sound&#x27;);
			ListTask = include(&#x27;springroll.ListTask&#x27;);
			BitmapUtils = include(&#x27;springroll.easeljs.BitmapUtils&#x27;);
		}

		Container.call(this);

		if(!options)
			throw new Error(&quot;need options to create Cutscene&quot;);

		/**
		*	When the cutscene is ready to use
		*	@property {Boolean} isReady
		*	@public
		*/
		this.isReady = false;

		/**
		*	The framerate the cutscene should play at.
		*	@property {int} framerate
		*	@private
		*/
		this.framerate = 0;

		/**
		*	Reference to the display we are drawing on
		*	@property {Display} display
		*	@public
		*/
		this.display = typeof options.display == &quot;string&quot; ?
			Application.instance.getDisplay(options.display) :
			options.display;

		/**
		*	The source url for the config until it is loaded, then the config object.
		*	@property {String|Object} config
		*	@private
		*/
		this.config = options.configUrl;

		/**
		*	The scaling value for all images.
		*	@property {Number} imageScale
		*	@private
		*/
		this.imageScale = options.imageScale || 1;

		/**
		*	A string found in the paths of images that should be replaced with another value.
		*	@property {String} pathReplaceTarg
		*	@private
		*/
		this.pathReplaceTarg = options.pathReplaceTarg || null;

		/**
		*	The string to use when replacing options.pathReplaceTarg.
		*	@property {String} pathReplaceVal
		*	@private
		*/
		this.pathReplaceVal = options.pathReplaceVal || null;

		/**
		*	The TaskManager used to load up assets.
		*	@property {TaskManager} _taskMan
		*	@private
		*/
		this._taskMan = null;

		/**
		*	The time elapsed in seconds.
		*	@property {Number} _elapsedTime
		*	@private
		*/
		this._elapsedTime = 0;

		/**
		*	All audio aliases used by this Cutscene, for preloading and later unloading.
		*	@property {Array} _audioAliases
		*	@private
		*/
		this._audioAliases = null;

		/**
		*	Time sorted list of audio that needs to be played, as well as information on if they
		*	should be synced or not.
		*	@property {Array} _audio
		*	@private
		*/
		this._audio = null;

		/**
		*	Index of the sound that is next up in _audio.
		*	@property {int} _audioIndex
		*	@private
		*/
		this._audioIndex = 0;

		/**
		*	Time sorted list of audio that needs to be played, as well as information on if they
		*	should be synced or not.
		*	@property {Array} _audio
		*	@private
		*/
		this._audio = null;

		/**
		*	The clip that is being animated.
		*	@property {createjs.MovieClip} _clip
		*	@private
		*/
		this._clip = null;

		/**
		*	The queue of sound instances of playing audio that the animation should be synced to.
		*	Only the most recent active one will be synced to.
		*	@property {Array} _activeSyncAudio
		*	@private
		*/
		this._activeSyncAudio = [];

		/**
		*	The time in seconds into the animation that the current synced audio started.
		*	@property {Number} _soundStartTime
		*	@private
		*/
		this._soundStartTime = -1;

		/**
		*	Array of active SoundInstances that are not the currently synced one.
		*	@property {Array} _activeAudio
		*	@private
		*/
		this._activeAudio = [];

		/**
		*	If the animation has finished playing.
		*	@property {Boolean} _animFinished
		*	@private
		*/
		this._animFinished = false;

		/**
		*	If the audio has finished playing.
		*	@property {Boolean} _audioFinished
		*	@private
		*/
		this._audioFinished = false;

		/**
		*	The Captions object to use to manage captions.
		*	@property {Captions} _captionsObj
		*	@private
		*/
		this._captionsObj = options.captions || null;

		// Make sure the captions don&#x27;t update themselves
		if (this._captionsObj) this._captionsObj.selfUpdate = false;

		/**
		*	The function to call when loading is complete.
		*	@property {Function} _loadCallback
		*	@private
		*/
		this._loadCallback = options.loadCallback || null;

		/**
		*	The function to call when playback is complete.
		*	@property {Function} _endCallback
		*	@private
		*/
		this._endCallback = null;
		
		/**
		*	Names of library (window.lib) items to delete when the cutscene is destroyed.
		*	@property {Array} _libItemsToUnload
		*	@private
		*/
		this._libItemsToUnload = [];
		
		/**
		*	Names of image (window.images) entries to unload when the cutscene is destroyed.
		*	@property {Array} _imagesToUnload
		*	@private
		*/
		this._imagesToUnload = [];

		//bind some callbacks
		this.update = this.update.bind(this);
		this.resize = this.resize.bind(this);

		this.setup();
	};

	var p = extend(Cutscene, Container);

	/**
	*   Called from the constructor to complete setup and start loading.
	*
	*   @method setup
	*   @private
	*/
	p.setup = function()
	{
		this.display.stage.addChild(this);

		// create a texture from an image path
		this._taskMan = new TaskManager([new LoadTask(
			&quot;config&quot;, this.config, this.onConfigLoaded.bind(this)
		)]);

		this._taskMan.on(TaskManager.ALL_TASKS_DONE, this.onLoadComplete.bind(this));
		this._taskMan.startAll();
	};

	/**
	*	Callback for when the config file is loaded.
	*	@method onConfigLoaded
	*	@param {LoaderResult} result The loaded result.
	*	@private
	*/
	p.onConfigLoaded = function(result)
	{
		this.config = result.content;

		//parse config
		this.framerate = this.config.settings.fps;

		//figure out what to load
		var manifest = [];
		//the javascript file
		manifest.push({id:&quot;clip&quot;, src:this.config.settings.clip});
		//all the images
		var url;
		for (var key in this.config.images)
		{
			url = this.pathReplaceTarg ?
				this.config.images[key].replace(this.pathReplaceTarg, this.pathReplaceVal) :
				this.config.images[key];
			manifest.push({id:key, src:url});
		}

		this._taskMan.addTask(new ListTask(&quot;art&quot;, manifest, this.onArtLoaded.bind(this)));
		if(this.config.settings.audioAlias)
		{
			this._audioAliases = [this.config.settings.audioAlias];
			this._audio = [{alias:this.config.settings.audioAlias, start:0, sync:true}];
		}
		else if(this.config.settings.audio)
		{
			this._audio = this.config.settings.audio.slice();
			this._audio.sort(audioSorter);
			this._audioAliases = [];
			for(var i = 0, length = this._audio.length; i &lt; length; ++i)
			{
				if(this._audioAliases.indexOf(this._audio[i].alias) == -1)
					this._audioAliases.push(this._audio[i].alias);
			}
		}
		else
		{
			if (DEBUG &amp;&amp; Debug) Debug.error(&quot;Cutscene really needs some audio to play&quot;);
			return;
		}
		if(this._audioAliases.length)
		{
			this._taskMan.addTask(Sound.instance.createPreloadTask(&quot;audio&quot;,
				this._audioAliases, this.onAudioLoaded));
		}
	};

	function audioSorter(a, b)
	{
		return a.start - b.start;
	}

	/**
	*	Callback for when the audio has been preloaded.
	*	@method onAudioLoaded
	*	@private
	*/
	p.onAudioLoaded = function()
	{
		//do nothing
	};

	/**
	*	Callback for when all art assets have been loaded.
	*	@method onArtLoaded
	*	@param {Object} results The loaded results.
	*	@private
	*/
	p.onArtLoaded = function(results)
	{
		if(!window.images)
			window.images = {};
		var atlasData = {}, atlasImages = {}, id;

		var result, imgScale, key;
		for (id in results)
		{
			result = results[id].content;
			if(id.indexOf(&quot;atlasData_&quot;) === 0)//look for spritesheet data
			{
				atlasData[id.replace(&quot;atlasData_&quot;, &quot;&quot;)] = result;
			}
			else if(id.indexOf(&quot;atlasImage_&quot;) === 0)//look for spritesheet images
			{
				atlasImages[id.replace(&quot;atlasImage_&quot;, &quot;&quot;)] = result;
			}
			else if(id == &quot;clip&quot;)//look for the javascript animation file
			{
				//the javascript file
				
				//get javascript text
				var text = result.text;
				if(!text) continue;
				//split into the initialization functions, that take &#x27;lib&#x27; as a parameter
				var textArray = text.split(/[\(!]function\s*\(/);
				//go through each initialization function
				for(var i = 0; i &lt; textArray.length; ++i)
				{
					text = textArray[i];
					if(!text) continue;
					//determine what the &#x27;lib&#x27; parameter has been minified into
					var libName = text.substring(0, text.indexOf(&quot;,&quot;));
					if(!libName) continue;
					//get all the things that are &#x27;lib.X = &lt;stuff&gt;&#x27;
					var varFinder = new RegExp(&quot;\\(&quot; + libName + &quot;.(\\w+)\\s*=&quot;, &quot;g&quot;);
					var foundName = varFinder.exec(text);
					while(foundName)
					{
						//keep track of all library items in the js file
						this._libItemsToUnload.push(foundName[1]);
						foundName = varFinder.exec(text);
					}
				}
				
				//if bitmaps need scaling, then do black magic to the object prototypes so the
				//scaling is built in
				if(this.imageScale != 1)
				{
					imgScale = this.imageScale;
					for (key in this.config.images)
					{
						BitmapUtils.replaceWithScaledBitmap(key, imgScale);
					}
				}
			}
			else//anything left must be individual images that we were expecting
			{
				images[id] = result;
				this._imagesToUnload.push(id);
			}
		}
		for (id in atlasData)//if we loaded any spritesheets, load them up
		{
			if(atlasData[id] &amp;&amp; atlasImages[id])
			{
				BitmapUtils.loadSpriteSheet(
					atlasData[id],
					atlasImages[id],
					this.imageScale);
				this._imagesToUnload.push(atlasImages[id]);
			}
		}
	};

	/**
	*	Callback for when all loading is complete.
	*	@method onLoadComplete
	*	@param {Event} evt An event
	*	@private
	*/
	p.onLoadComplete = function(evt)
	{
		this._taskMan.off();
		this._taskMan.destroy();
		this._taskMan = null;

		var clip = this._clip = new lib[this.config.settings.clipClass]();
		//if the animation was for the older ComicCutscene, we should handle it gracefully
		//so if the clip only has one frame or is a container, then we get the child of the clip
		//as the animation
		if(!this._clip.timeline || this._clip.timeline.duration == 1)
		{
			clip = this._clip.getChildAt(0);
		}
		clip.mouseEnabled = false;
		clip.framerate = this.framerate;
		clip.tickEnabled = false;
		//internally, movieclip has to be playing to change frames during tick() or advance().
		clip.gotoAndPlay(0);
		clip.loop = false;
		this.addChild(this._clip);

		this.resize(this.display.width, this.display.height);
		Application.instance.on(&quot;resize&quot;, this.resize);

		this.isReady = true;

		if(this._loadCallback)
		{
			this._loadCallback();
			this._loadCallback = null;
		}
	};

	/**
	*	Listener for when the Application is resized.
	*	@method resize
	*	@param {int} width The new width of the display.
	*	@param {int} height The new height of the display.
	*	@private
	*/
	p.resize = function(width, height)
	{
		if(!this._clip) return;

		var settings = this.config.settings;
		var designedRatio = settings.designedWidth / settings.designedHeight,
			currentRatio = width / height,
			scale;

		if(designedRatio &gt; currentRatio)
		{
			//current ratio is narrower than the designed ratio, scale to width
			scale = width / settings.designedWidth;
			this.x = 0;
			this.y = (height - settings.designedHeight * scale) * 0.5;
		}
		else
		{
			scale = height / settings.designedHeight;
			this.x = (width - settings.designedWidth * scale) * 0.5;
			this.y = 0;
		}
		this._clip.scaleX = this._clip.scaleY = scale;
	};

	/**
	*	Starts playing the cutscene.
	*	@method start
	*	@param {Function} callback The function to call when playback is complete.
	*	@public
	*/
	p.start = function(callback)
	{
		this._endCallback = callback;

		this._elapsedTime = 0;
		this._animFinished = false;
		this._audioFinished = false;
		for(var i = 0; i &lt; this._audio.length; ++i)
		{
			var data = this._audio[i];
			if(data.start === 0)
			{
				var alias = data.alias;
				var instanceRef = {};
				if(data.sync)
				{
					var audio = Sound.instance.play(
						alias,
						this._audioCallback.bind(this, instanceRef));
					this._activeSyncAudio.unshift(audio);
					instanceRef.instance = audio;
					audio._audioData = data;
					this._soundStartTime = data.start;
					if(this._captionsObj)
					{
						this._captionsObj.play(alias);
					}
				}
				else
				{
					var instance = Sound.instance.play(
						alias,
						this._audioCallback.bind(this, instanceRef));
					instanceRef.instance = instance;
					this._activeAudio.push(instance);
				}
				++this._audioIndex;
			}
			else
				break;
		}

		Application.instance.on(&quot;update&quot;, this.update);
	};

	/**
	*	Callback for when the audio has finished playing.
	*	@method _audioCallback
	*	@private
	*/
	p._audioCallback = function(instanceRef)
	{
		var index = this._activeSyncAudio.indexOf(instanceRef.instance);
		if(index != -1)
		{
			if(index === 0)
				this._activeSyncAudio.shift();
			else
				this._activeSyncAudio.splice(index, 1);

			if(this._activeSyncAudio.length &lt; 1)
			{
				this._audioFinished = true;
				this._soundStartTime = -1;
				if(this._captionsObj)
					this._captionsObj.stop();
				if(this._animFinished)
				{
					this.stop(true);
				}
			}
			else
			{
				var data = this._activeSyncAudio[0]._audioData;
				this._soundStartTime = data.start;
				if(this._captionsObj)
				{
					this._captionsObj.play(data.alias);
				}
			}
		}
		else
		{
			index = this._activeAudio.indexOf(instanceRef.instance);
			if(index != -1)
				this._activeAudio.splice(index, 1);
		}
	};

	/**
	*	Listener for frame updates.
	*	@method update
	*	@param {int} elapsed Time in milliseconds
	*	@private
	*/
	p.update = function(elapsed)
	{
		if(this._animFinished) return;

		//update the elapsed time first, in case it starts audio
		if(!this._activeSyncAudio.length)
			this._elapsedTime += elapsed * 0.001;

		for(var i = this._audioIndex; i &lt; this._audio.length; ++i)
		{
			var data = this._audio[i];
			if(data.start &lt;= this._elapsedTime)
			{
				var alias = data.alias;
				var instanceRef = {};
				if(data.sync)
				{
					this._audioFinished = false;
					var audio = Sound.instance.play(
						alias,
						this._audioCallback.bind(this, instanceRef));
					this._activeSyncAudio.unshift(audio);
					instanceRef.instance = audio;
					audio._audioData = data;
					this._soundStartTime = data.start;
					if(this._captionsObj)
					{
						this._captionsObj.play(alias);
					}
				}
				else
				{
					var instance = Sound.instance.play(
						alias,
						{
							complete: this._audioCallback.bind(this, instanceRef),
							offset: (this._elapsedTime - data.start) * 1000
						});
					instanceRef.instance = instance;
					this._activeAudio.push(instance);
				}
				++this._audioIndex;
			}
			else
				break;
		}

		if(this._activeSyncAudio.length)
		{
			var pos = this._activeSyncAudio[0].position * 0.001;
			//sometimes (at least with the flash plugin), the first check of the
			//position would be very incorrect
			if(this._elapsedTime === 0 &amp;&amp; pos &gt; elapsed * 2)
			{
				//do nothing here
			}
			else
			{
				//save the time elapsed
				this._elapsedTime = this._soundStartTime + pos;
			}
		}

		if(this._captionsObj &amp;&amp; this._soundStartTime &gt;= 0)
		{
			this._captionsObj.seek(this._activeSyncAudio[0].position);
		}
		if(!this._animFinished)
		{
			//set the elapsed time of the clip
			var clip = (!this._clip.timeline || this._clip.timeline.duration == 1) ?
				this._clip.getChildAt(0) :
				this._clip;
			clip.elapsedTime = this._elapsedTime;
			clip.advance();
			if(clip.currentFrame == clip.timeline.duration)
			{
				this._animFinished = true;
				if(this._audioFinished)
				{
					this.stop(true);
				}
			}
		}
	};

	/**
	*	Stops playback of the cutscene.
	*	@method stop
	*	@param {Boolean} [doCallback=false] If the end callback should be performed.
	*	@public
	*/
	p.stop = function(doCallback)
	{
		Application.instance.off(&quot;update&quot;, this.update);
		var i;
		for(i = 0; i &lt; this._activeSyncAudio.length; ++i)
			this._activeSyncAudio[i].stop();
		for(i = 0; i &lt; this._activeAudio.length; ++i)
			this._activeAudio[i].stop();
		if(this._captionsObj)
			this._captionsObj.stop();

		if(doCallback &amp;&amp; this._endCallback)
		{
			this._endCallback();
			this._endCallback = null;
		}
	};

	/**
	*	Destroys the cutscene.
	*	@method destroy
	*	@public
	*/
	p.destroy = function()
	{
		Application.instance.off(&quot;resize&quot;, this.resize);
		this.removeAllChildren(true);
		//unload audio
		Sound.instance.unload(this._audioAliases);
		//unload library stuff
		var i;
		for(i = this._libItemsToUnload.length - 1; i &gt;= 0; --i)
		{
			delete lib[this._libItemsToUnload[i]];
		}
		for(i = this._imagesToUnload.length - 1; i &gt;= 0; --i)
		{
			var img = this._imagesToUnload[i];
			if(typeof img == &quot;string&quot;)
			{
				images[img].src = &quot;&quot;;
				delete images[img];
			}
			else
			{
				img.src = &quot;&quot;;
			}
		}
		this._libItemsToUnload = this._imagesToUnload = this.config = null;
		if(this._taskMan)
		{
			this._taskMan.off();
			this._taskMan.destroy();
			this._taskMan = null;
		}
		this._activeSyncAudio = this._activeAudio = this._audioAliases = this._audio = null;
		this._loadCallback = this._endCallback = this._clip = this._captionsObj = null;
		if(this.parent)
			this.parent.removeChild(this);
		this.display = null;
	};

	namespace(&quot;springroll&quot;).Cutscene = Cutscene;
	namespace(&quot;springroll.easeljs&quot;).Cutscene = Cutscene;
}());
</pre>
</div>        </div>
      </div>
    </div>
  </div>
  <script src='../assets/js/libraries.js?v=0.3.0'></script>
  <script src='../assets/js/main.js?v=0.3.0'></script>
</body>
</html>