<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://yui-s.yahooapis.com/3.8.0/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.ico">
    <script src="https://yui-s.yahooapis.com/3.10.1/build/yui/yui-min.js"></script>
	<title>SpringRoll v0.0.6 API Documentation : /LocalStorage/AndrewStart/Projects/JSLibs/SpringRoll/src/Application.js</title>  
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><a href="http://github.com/springrollStudio/SpringRoll"><img src="../assets/css/logo.png" title="SpringRoll"></a></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Documentation for: 0.0.6</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>
		<ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
			<li><a href="#api-modules">Modules</a></li>
        </ul>
        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Array.html">Array</a></li>
            
                <li><a href="../classes/Debug.html">Debug</a></li>
            
                <li><a href="../classes/include.html">include</a></li>
            
                <li><a href="../classes/Math.html">Math</a></li>
            
                <li><a href="../classes/namespace.html">namespace</a></li>
            
                <li><a href="../classes/Object.html">Object</a></li>
            
                <li><a href="../classes/springroll.AbstractDisplay.html">springroll.AbstractDisplay</a></li>
            
                <li><a href="../classes/springroll.Application.html">springroll.Application</a></li>
            
                <li><a href="../classes/springroll.BaseState.html">springroll.BaseState</a></li>
            
                <li><a href="../classes/springroll.CacheManager.html">springroll.CacheManager</a></li>
            
                <li><a href="../classes/springroll.Captions.html">springroll.Captions</a></li>
            
                <li><a href="../classes/springroll.CombinedCallback.html">springroll.CombinedCallback</a></li>
            
                <li><a href="../classes/springroll.createjs.Animator.html">springroll.createjs.Animator</a></li>
            
                <li><a href="../classes/springroll.createjs.AnimatorTimeline.html">springroll.createjs.AnimatorTimeline</a></li>
            
                <li><a href="../classes/springroll.createjs.Button.html">springroll.createjs.Button</a></li>
            
                <li><a href="../classes/springroll.createjs.CharacterClip.html">springroll.createjs.CharacterClip</a></li>
            
                <li><a href="../classes/springroll.createjs.CharacterController.html">springroll.createjs.CharacterController</a></li>
            
                <li><a href="../classes/springroll.createjs.CreateJSDisplay.html">springroll.createjs.CreateJSDisplay</a></li>
            
                <li><a href="../classes/springroll.createjs.Cutscene.html">springroll.createjs.Cutscene</a></li>
            
                <li><a href="../classes/springroll.createjs.DisplayAdapter.html">springroll.createjs.DisplayAdapter</a></li>
            
                <li><a href="../classes/springroll.createjs.DragManager.html">springroll.createjs.DragManager</a></li>
            
                <li><a href="../classes/springroll.createjs.MovieClipUtils.html">springroll.createjs.MovieClipUtils</a></li>
            
                <li><a href="../classes/springroll.createjs.SoundButton.html">springroll.createjs.SoundButton</a></li>
            
                <li><a href="../classes/springroll.DelayedCall.html">springroll.DelayedCall</a></li>
            
                <li><a href="../classes/springroll.EventDispatcher.html">springroll.EventDispatcher</a></li>
            
                <li><a href="../classes/springroll.FallbackWorker.html">springroll.FallbackWorker</a></li>
            
                <li><a href="../classes/springroll.FunctionTask.html">springroll.FunctionTask</a></li>
            
                <li><a href="../classes/springroll.Game.html">springroll.Game</a></li>
            
                <li><a href="../classes/springroll.ListTask.html">springroll.ListTask</a></li>
            
                <li><a href="../classes/springroll.Loader.html">springroll.Loader</a></li>
            
                <li><a href="../classes/springroll.LoaderQueueItem.html">springroll.LoaderQueueItem</a></li>
            
                <li><a href="../classes/springroll.LoaderResult.html">springroll.LoaderResult</a></li>
            
                <li><a href="../classes/springroll.LoadTask.html">springroll.LoadTask</a></li>
            
                <li><a href="../classes/springroll.native.Circle.html">springroll.native.Circle</a></li>
            
                <li><a href="../classes/springroll.native.DisplayAdapter.html">springroll.native.DisplayAdapter</a></li>
            
                <li><a href="../classes/springroll.native.Ellipse.html">springroll.native.Ellipse</a></li>
            
                <li><a href="../classes/springroll.native.NativeDisplay.html">springroll.native.NativeDisplay</a></li>
            
                <li><a href="../classes/springroll.native.Point.html">springroll.native.Point</a></li>
            
                <li><a href="../classes/springroll.native.Polygon.html">springroll.native.Polygon</a></li>
            
                <li><a href="../classes/springroll.native.Rectangle.html">springroll.native.Rectangle</a></li>
            
                <li><a href="../classes/springroll.PageVisibility.html">springroll.PageVisibility</a></li>
            
                <li><a href="../classes/springroll.pixi.Animator.html">springroll.pixi.Animator</a></li>
            
                <li><a href="../classes/springroll.pixi.AnimatorTimeline.html">springroll.pixi.AnimatorTimeline</a></li>
            
                <li><a href="../classes/springroll.pixi.AssetManager.html">springroll.pixi.AssetManager</a></li>
            
                <li><a href="../classes/springroll.pixi.Button.html">springroll.pixi.Button</a></li>
            
                <li><a href="../classes/springroll.pixi.DisplayAdapter.html">springroll.pixi.DisplayAdapter</a></li>
            
                <li><a href="../classes/springroll.pixi.DragManager.html">springroll.pixi.DragManager</a></li>
            
                <li><a href="../classes/springroll.pixi.PixiDisplay.html">springroll.pixi.PixiDisplay</a></li>
            
                <li><a href="../classes/springroll.PixiTask.html">springroll.PixiTask</a></li>
            
                <li><a href="../classes/springroll.Positioner.html">springroll.Positioner</a></li>
            
                <li><a href="../classes/springroll.SavedData.html">springroll.SavedData</a></li>
            
                <li><a href="../classes/springroll.ScalingGame.html">springroll.ScalingGame</a></li>
            
                <li><a href="../classes/springroll.Sound.html">springroll.Sound</a></li>
            
                <li><a href="../classes/springroll.SoundContext.html">springroll.SoundContext</a></li>
            
                <li><a href="../classes/springroll.SoundGame.html">springroll.SoundGame</a></li>
            
                <li><a href="../classes/springroll.SoundInstance.html">springroll.SoundInstance</a></li>
            
                <li><a href="../classes/springroll.SoundListTask.html">springroll.SoundListTask</a></li>
            
                <li><a href="../classes/springroll.StateEvent.html">springroll.StateEvent</a></li>
            
                <li><a href="../classes/springroll.StateGame.html">springroll.StateGame</a></li>
            
                <li><a href="../classes/springroll.StateManager.html">springroll.StateManager</a></li>
            
                <li><a href="../classes/springroll.SubWorker.html">springroll.SubWorker</a></li>
            
                <li><a href="../classes/springroll.Task.html">springroll.Task</a></li>
            
                <li><a href="../classes/springroll.TaskEvent.html">springroll.TaskEvent</a></li>
            
                <li><a href="../classes/springroll.TaskManager.html">springroll.TaskManager</a></li>
            
                <li><a href="../classes/springroll.TimeUtils.html">springroll.TimeUtils</a></li>
            
                <li><a href="../classes/springroll.Translate.html">springroll.Translate</a></li>
            
                <li><a href="../classes/springroll.UIElement.html">springroll.UIElement</a></li>
            
                <li><a href="../classes/springroll.UIElementSettings.html">springroll.UIElementSettings</a></li>
            
                <li><a href="../classes/springroll.UIScaler.html">springroll.UIScaler</a></li>
            
                <li><a href="../classes/springroll.VOPlayer.html">springroll.VOPlayer</a></li>
            
                <li><a href="../classes/springroll.Worker.html">springroll.Worker</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Captions.html">Captions</a></li>
            
                <li><a href="../modules/CreateJS Display.html">CreateJS Display</a></li>
            
                <li><a href="../modules/Framework.html">Framework</a></li>
            
                <li><a href="../modules/Game.html">Game</a></li>
            
                <li><a href="../modules/Interface.html">Interface</a></li>
            
                <li><a href="../modules/Native Display.html">Native Display</a></li>
            
                <li><a href="../modules/PIXI Display.html">PIXI Display</a></li>
            
                <li><a href="../modules/Sound.html">Sound</a></li>
            
                <li><a href="../modules/States.html">States</a></li>
            
                <li><a href="../modules/Tasks.html">Tasks</a></li>
            
                <li><a href="../modules/Translate.html">Translate</a></li>
            
                <li><a href="../modules/Worker.html">Worker</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
            <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <script>
	var name = /LocalStorage/AndrewStart/Projects/JSLibs/SpringRoll/src/Application.js      
</script>
<h1 class="file-heading">File:Application.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
*  @module Framework
*  @namespace springroll
*/
(function(undefined){

	// classes to import
	var Debug,
		Loader,
		TimeUtils,
		PageVisibility,
		EventDispatcher = include(&#x27;springroll.EventDispatcher&#x27;);

	/**
	*  Creates a new application, for example (HappyCamel extends Application)
	*  manages displays, update loop controlling, handles resizing
	*
	*	var app = new Application({fps:60, resizeElement:window});
	*
	*  @class Application
	*  @extend EventDispatcher
	*  @constructor
	*  @param {Object} [options] The options for creating the application
	*  @param {int} [options.fps=60] The framerate to use for rendering the stage
	*  @param {Boolean} [options.raf=true] Use request animation frame
	*  @param {String|int} [options.version] The current version number for your application. This 
	*       number will automatically be appended to all file requests. For instance, if the version
	*       is &quot;0.0.1&quot; all file requests will be appended with &quot;?v=0.0.1&quot;
	*  @param {String} [options.versionsFile] Path to a text file which contains explicit version
	*		numbers for each asset. This is useful for controlling the live browser cache.
	*		For instance, this text file would have an asset on each line followed by a number:
	*		&#x60;assets/config/config.json 2&#x60; this would load &#x60;assets/config/config.json?v=2&#x60;
	*  @param {Boolean} [options.cacheBust=false] Override the end-user browser cache by adding &quot;?v=&quot;
	*		to the end of each file path requested. Use for developmently, debugging only!
	*  @param {String} [options.basePath] The optional file path to prefix to any relative file requests
	*		this is a great way to load all load requests with a CDN path.
	*  @param {String|DOMElement|Window} [options.resizeElement] The element to resize the canvas to
	*  @param {Boolean} [options.uniformResize=true] Whether to resize the displays to the original aspect ratio
	*  @param {Number} [options.maxAspectRatio] If doing uniform resizing, optional parameter to add a maximum aspect ratio.
	*         This allows for &quot;title-safe&quot; responsiveness. Must be greater than the original aspect ratio of the canvas.
	*  @param {Boolean} [options.queryStringParameters=false] Parse the query string paramenters as options
	*  @param {Boolean} [options.debug=false] Enable the Debug class
	*  @param {int} [options.minLogLevel=0] The minimum log level to show debug messages for from 0 (general) to 4 (error),
	*		the &#x60;Debug&#x60; class must be used for this feature.
	*  @param {String} [options.debugRemote] The host computer for remote debugging,
	*		the debug module must be included to use this feature. Can be an IP address or host name.
	*  @param {Boolean} [options.updateTween=false] If using TweenJS, the Application will update the Tween itself
	*  @param {String} [options.canvasId] The default display DOM ID name
	*  @param {Function} [options.display] The name of the class to instaniate as the display (e.g. &#x60;springroll.PixiDisplay&#x60;)
	*  @param {Object} [options.displayOptions] Display-specific options
	*  @param {Boolean} [options.crossOrigin=false] Used by &#x60;springroll.PixiTask&#x60;, default behavior is to load assets from the same domain.
	*/
	var Application = function(options)
	{
		if (_instance)
		{
			throw &quot;Only one Application can be opened at a time&quot;;
		}
		_instance = this;

		EventDispatcher.call(this);

		if(!Debug)
		{
			Debug = include(&#x27;Debug&#x27;);
			Loader = include(&#x27;springroll.Loader&#x27;);
			TimeUtils = include(&#x27;springroll.TimeUtils&#x27;);
			PageVisibility = include(&#x27;springroll.PageVisibility&#x27;);
		}

		/**
		*  Initialization options/query string parameters, these properties are read-only
		*  Application properties like raf, fps, don&#x27;t have any affect on the options object.
		*  @property {Object} options
		*  @readOnly
		*/
		this.options = options || {};

		/**
		*  Primary renderer for the application, for simply accessing Application.instance.display.stage;
		*  The first display added becomes the primary display automatically.
		*  @property {Display} display
		*  @public
		*/
		this.display = null;

		/**
		*  If we should wait to init the Application, this is useful is something is inheriting
		*  Application but want to do some extra stuff before init is actually called.
		*  @property {Boolean} _readyToInit
		*  @protected
		*/
		this._readyToInit = true;

		_displays = {};
		_tickCallback = this._tick.bind(this);

		//other initialization stuff too
		//if there are some specific properties on the options, use them to make a display
		//call init after handling loading up a versions file or any other needed asynchronous stuff?
		this._internalInit();
	};

	// Reference to the prototype
	var s = EventDispatcher.prototype;
	var p = Application.prototype = Object.create(s);

	/**
	*  The collection of function references to call when initializing the application
	*  these are registered by external libraries that need to setup, destroyed
	*  for instance Loader
	*  @property {Array} _globalInit
	*  @private
	*  @static
	*/
	Application._globalInit = [];

	/**
	*  The collection of function references to call when destroying the application
	*  these are registered by external libraries that need to setup, destroyed
	*  for instance Loader
	*  @property {Array} _globalDestroy
	*  @private
	*  @static
	*/
	Application._globalDestroy = [];

	/**
	*  The frame rate object
	*  @private
	*  @property {DOMObject} _framerate
	*/
	var _framerate = null,
	
	/**
	*  The number of ms since the last frame update
	*  @private
	*  @property {int} _lastFrameTime
	*/
	_lastFrameTime = 0,
	
	/**
	*  The last time since the last fps update
	*  @private
	*  @property {int} _lastFPSUpdateTime
	*/
	_lastFPSUpdateTime = 0,
	
	/**
	*  The number of frames since the last fps update
	*  @private
	*  @property {int} _frameCount
	*/
	_frameCount = 0,

	/**
	*	The bound callback for listening to tick events
	*	@private
	*   @property {Function} _tickCallback
	*/
	_tickCallback = null,

	/**
	*  If the current application is paushed
	*  @private
	*  @property {Boolean} _paused
	*/
	_paused = false,

	/**
	*  The id of the active requestAnimationFrame or setTimeout call.
	*  @property {Number} _tickId
	*  @private
	*/
	_tickId = -1,

	/**
	*  If requestionAnimationFrame should be used
	*  @private
	*  @property {Bool} _useRAF
	*  @default false
	*/
	_useRAF = false,

	/**
	*  The current internal frames per second
	*  @property {Number} _fps
	*  @private
	*  @default 0
	*/
	_fps = 0,

	/**
	* The number of milliseconds per frame
	* @property {int} _msPerFrame
	* @private
	*/
	_msPerFrame = 0,

	/**
	*  Dom element (or the window) to attach resize listeners and read the size from
	*  @property {DOMElement|Window|null} _resizeElement
	*  @private
	*  @default null
	*/
	_resizeElement = null,

	/**
	*  The aspect ratio of the primary display, as width / height.
	*  @property {Number} _aspectRatio
	*  @private
	*/
	_aspectRatio = 0,

	/**
	*  A PageVisibility object to automatically pause Application when the page is hidden.
	*  @property {PageVisibility} _pageVisibility
	*  @private
	*/
	_pageVisibility = null,


	/**
	*  Rendering plugins, in a dictionary by canvas id
	*  @property {dictionary} _displays
	*  @private
	*/
	_displays = null,

	/**
	*  Default initialization options.
	*  @property {dictionary} _defaultOptions
	*  @private
	*/
	_defaultOptions =
	{
		//application properties
		raf: true,
		fps: 60,
		resizeElement: null,
		uniformResize: true,
		queryStringParameters: false,
		debug: false,
		minLogLevel: 0,
		ip: null,
		//default display properties
		canvasId: null,
		display: null,
		displayOptions: null,
		updateTween: false
	},

	/**
	*  A helper object to avoid object creation each resize event.
	*  @property {Object} _resizeHelper
	*  @private
	*/
	_resizeHelper = { width: 0, height: 0},

	/**
	*  Fired when initialization of the application is done
	*  @event init
	*/
	INIT = &#x27;init&#x27;,

	/**
	*  Event when everything&#x27;s done but we haven&#x27;t actually inited
	*  @event preInit
	*  @protected
	*/
	BEFORE_INIT = &#x27;beforeInit&#x27;,

	/**
	*  Fired when an update is called, every frame update
	*  @event update
	*  @param {int} elasped The number of milliseconds since the last frame update
	*/
	UPDATE = &#x27;update&#x27;,

	/**
	*  Fired when a resize is called
	*  @event resize
	*  @param {int} width The width of the resize element
	*  @param {int} height The height of the resize element
	*/
	RESIZE = &#x27;resize&#x27;,

	/**
	*  Fired when the pause state is toggled
	*  @event pause
	*  @param {boolean} paused If the application is now paused
	*/
	PAUSE = &#x27;pause&#x27;,

	/**
	*  Fired when the application becomes paused
	*  @event paused
	*/
	PAUSED = &#x27;paused&#x27;,

	/**
	*  Fired when the application resumes from a paused state
	*  @event resumed
	*/
	RESUMED = &#x27;resumed&#x27;,

	/**
	*  Fired when the application is destroyed
	*  @event destroy
	*/
	DESTROY = &#x27;destroy&#x27;;

	/**
	*  Libraries would register global initialization functions when they are created, e.g.
	*  Application.registerInit(Loader.init);
	*  @method registerInit
	*  @param {Function} func
	*  @static
	*  @public
	*/
	Application.registerInit = function(func)
	{
		Application._globalInit.push(func);
	};
	/**
	*  Libraries would register global destroy functions when they are created or initialized, e.g.
	*  Application.registerInit(Loader.instance.destroy.bind(Loader.instance));
	*  @method registerDestroy
	*  @param {Function} func
	*  @static
	*  @public
	*/
	Application.registerDestroy = function(func)
	{
		Application._globalDestroy.push(func);
	};

	/**
	*  Get the singleton instance of the application
	*  @property {Application} instance
	*  @static
	*  @public
	*/
	var _instance = null;
	Object.defineProperty(Application, &quot;instance&quot;, {
		get: function() {
			return _instance;
		}
	});

	/**
	*  The internal initialization
	*  @method _internalInit
	*  @private
	*/
	p._internalInit = function()
	{
		//grab the query string parameters if we should be doing so
		var query = !!this.options.parseQueryString ? parseQueryStringParams() : {};
		
		// Assemble all of the options, the last takes precedence
		this.options = Object.merge({}, _defaultOptions, this.options, query);

		// Call any global libraries to initialize
		for(var i = 0; i &lt; Application._globalInit.length; ++i)
		{
			Application._globalInit[i]();
		}

		_useRAF = this.options.raf;
		this.fps = this.options.fps;
		var framerate = this.options.framerate;
		if(framerate)
		{
			if(typeof framerate == &quot;string&quot;)
				_framerate = document.getElementById(framerate);
			else
				_framerate = framerate;
		}
		var resizeElement = this.options.resizeElement;
		if(resizeElement)
		{
			if(typeof resizeElement == &quot;string&quot;)
				_resizeElement = document.getElementById(resizeElement);
			else
				_resizeElement = resizeElement;
			this.triggerResize = this.triggerResize.bind(this);
			window.addEventListener(&quot;resize&quot;, this.triggerResize);
		}

		// Turn on debugging
		if (this.options.debug !== undefined)
			Debug.enabled = this.options.debug === true || this.options.debug === &quot;true&quot;;
		
		if (this.options.minLogLevel !== undefined)
			Debug.minLogLevel = parseInt(this.options.minLogLevel, 10);

		//if we were supplied with an IP address, connect to it with the Debug class for logging
		if(typeof this.options.debugRemote == &quot;string&quot;)
			Debug.connect(this.options.debugRemote);

		// If tween and/or ticker are included
		var Tween = include(&#x27;createjs.Tween&#x27;, false),
			Ticker = include(&#x27;createjs.Ticker&#x27;, false);

		// Add an option to have the application control the Tween tick
		if (Tween &amp;&amp; this.options.updateTween)
		{
			if (Ticker)
			{
				Ticker.setPaused(true);
			}
			this.on(&#x27;update&#x27;, Tween.tick);
		}
		
		//set up the page visibility listener
		_pageVisibility = new PageVisibility(this._onVisible.bind(this), this._onHidden.bind(this));

		if(this.options.canvasId &amp;&amp; this.options.display)
			this.addDisplay(this.options.canvasId, this.options.display, this.options.displayOptions);


		// Bind the do init
		this._doInit = this._doInit.bind(this);

		// Check to see if we should load a versions file
		// The versions file keeps track of file versions to avoid cache issues
		if (this.options.versionsFile !== undefined)
		{
			// Try to load the default versions file
			// callback should be made with a scope in mind
			Loader.instance.cacheManager.addVersionsFile(
				this.options.versionsFile,
				this._doInit
			);
		}
		else
		{
			// Wait until the next execution sequence
			// so that init can be added after construction
			setTimeout(this._doInit, 0);
		}
	};

	/**
	*  Initialize the application
	*  @method _doInit
	*  @protected
	*/
	p._doInit = function()
	{
		this.trigger(BEFORE_INIT);

		// If a sub-class will manually try to init later on
		if (!this._readyToInit) return;

		// Call the init function
		if (this.init) this.init();

		//do an initial resize to make sure everything is sized properly
		this.triggerResize();

		//start update loop
		this.paused = false;

		// Dispatch the init event
		this.trigger(INIT);
	};

	/**
	*  Define all of the query string parameters
	*  @private
	*  @method parseQueryStringParams
	*  @return {object} The object reference to update
	*/
	var parseQueryStringParams = function()
	{
		var output = {};
		var href = window.location.search;
		if(!href)//empty string is false
			return output;
		var vars = href.substr(href.indexOf(&quot;?&quot;)+1);
		var pound = vars.indexOf(&#x27;#&#x27;);
		vars = pound &lt; 0 ? vars : vars.substring(0, pound);
		var splitFlashVars = vars.split(&quot;&amp;&quot;);
		var myVar;
		for (var i = 0; i &lt; splitFlashVars.length; i++)
		{
			myVar = splitFlashVars[i].split(&quot;=&quot;);
			if (DEBUG)
			{
				Debug.log(myVar[0] + &quot; -&gt; &quot; + myVar[1]);
			}
			output[myVar[0]] = myVar[1];
		}
		return output;
	};

	/**
	*  Override this to do post constructor initialization
	*  @method init
	*  @protected
	*/
	p.init = null;

	/**
	*  Private listener for when the page is hidden.
	*  @method _onHidden
	*  @private
	*/
	p._onHidden = function()
	{
		this.paused = true;
	};

	/**
	*  Private listener for when the page is shown.
	*  @method _onVisible
	*  @private
	*/
	p._onVisible = function()
	{
		this.paused = false;
	};

	/**
	*  Pause updates at the application level
	*  @property {Boolean} paused
	*/
	Object.defineProperty(p, &quot;paused&quot;, {
		get: function()
		{
			return _paused;
		},
		set: function(value)
		{
			_paused = !!value;
			this.trigger(PAUSE, _paused);
			this.trigger(_paused ? PAUSED : RESUMED, _paused);

			if(_paused)
			{
				if(_tickId != -1)
				{
					if(_useRAF)
					{
						cancelAnimationFrame(_tickId);
					}
					else
						clearTimeout(_tickId);
					_tickId = -1;
				}
			}
			else
			{
				if(_tickId == -1)
				{
					_tickId = _useRAF ?
						requestAnimFrame(_tickCallback):
						setTargetedTimeout(_tickCallback);
				}
				_lastFPSUpdateTime = _lastFrameTime = TimeUtils.now();
			}
		}
	});

	/**
	*  Makes a setTimeout with a time based on _msPerFrame and the amount of time spent in the
	*  current tick.
	*  @method setTargetedTimeout
	*  @param {Function} callback The tick function to call.
	*  @param {int} timeInFrame=0 The amount of time spent in the current tick in milliseconds.
	*  @private
	*/
	var setTargetedTimeout = function(callback, timeInFrame)
	{
		var timeToCall = _msPerFrame;
		//subtract the time spent in the frame to actually hit the target fps
		if(timeInFrame)
			timeToCall = Math.max(0, _msPerFrame - timeInFrame);
		return setTimeout(callback, timeToCall);
	};

	/**
	*  Fire a resize event with the current width and height of the display
	*  @method triggerResize
	*/
	p.triggerResize = function()
	{
		if(!_resizeElement) return;

		// window uses innerWidth, DOM elements clientWidth
		_resizeHelper.width = (_resizeElement.innerWidth || _resizeElement.clientWidth) | 0;
		_resizeHelper.height = (_resizeElement.innerHeight || _resizeElement.clientHeight) | 0;

		this.calculateDisplaySize(_resizeHelper);
		
		//round down, as canvases require integer sizes
		_resizeHelper.width |= 0;
		_resizeHelper.height |= 0;

		//resize the displays
		for(var key in _displays)
		{
			_displays[key].resize(_resizeHelper.width, _resizeHelper.height);
		}
		//send out the resize event
		this.trigger(RESIZE, _resizeHelper.width, _resizeHelper.height);
	};

	/**
	*  Calculates the resizing of displays. By default, this limits the new size
	*  to the initial aspect ratio of the primary display. Override this function
	*  if you need variable aspect ratios.
	*  @method calculateDisplaySize
	*  @protected
	*  @param {Object} size A size object containing the width and height of the resized container.
	* 				The size parameter is also the output of the function, so the size properties are edited in place.
	*  @param {int} size.width The width of the resized container.
	*  @param {int} size.height The height of the resized container.
	*/
	p.calculateDisplaySize = function(size)
	{
		if (!_aspectRatio || !this.options.uniformResize) return;

		var maxAspectRatio = this.options.maxAspectRatio || _aspectRatio,
			currentAspect = size.width / size.height;

		if (currentAspect &lt; _aspectRatio)
		{
			//limit to the narrower width
			size.height = size.width / _aspectRatio;
		}
		else if (currentAspect &gt; maxAspectRatio)
		{
			//limit to the shorter height
			size.width = size.height * maxAspectRatio;
		}
	};

	/**
	*  Add a display. If this is the first display added, then it will be stored as this.display.
	*  @method addDisplay
	*  @param {String} id The id of the canvas element, this will be used to grab the Display later
	*                also the Display should be the one to called document.getElementById(id)
	*                and not the application sinc we don&#x27;t care about the DOMElement as this point
	*  @param {function} displayConstructor The function to call to create the display instance
	*  @param {Object} [options] Optional Display specific options
	*  @return {Display} The created display.
	*/
	p.addDisplay = function(id, displayConstructor, options)
	{
		if(_displays[id])
		{
			if (DEBUG)
			{
				Debug.error(&quot;A display already exists with the id of &quot; + id);
			}
			return;
		}
		var display = _displays[id] = new displayConstructor(id, options);
		if (!this.display)
		{
			this.display = display;
			_aspectRatio = display.width / display.height;
			var maxAspectRatio = this.options.maxAspectRatio || _aspectRatio;

			if (maxAspectRatio &lt; _aspectRatio)
			{
				if (DEBUG)
				{
					throw &quot;Invalid &#x27;maxAspectRatio&#x27;: Must be greater than the original aspect ratio of the display&quot;;
				}
				else
				{
					throw &quot;Invalid &#x27;maxAspectRatio&#x27;&quot;;
				}
			}
		}
		return display;
	};

	/**
	*  Gets a specific renderer by the canvas id.
	*  @method getDisplay
	*  @param {String} id The id of the canvas
	*  @return {Display} The requested display.
	*/
	p.getDisplay = function(id)
	{
		return _displays[id];
	};

	/**
	*  Gets a specific renderer by the canvas id.
	*  @method getDisplays
	*  @public
	*  @param {function} [each] Optional looping method, callback takes a single parameter of the display
	*  @return {Array} The collection of Display objects
	*/
	p.getDisplays = function(each)
	{
		var output = [];
		for(var key in _displays)
		{
			output.push(_displays[key]);
			if (typeof each === &quot;function&quot;)
			{
				each.call(this, _displays[key]);
			}
		}
		return output;
	};

	/**
	* Removes and destroys a display
	* @method removeDisplay
	* @param {String} id The Display&#x27;s id (also the canvas ID)
	*/
	p.removeDisplay = function(id)
	{
		var display = _displays[id];
		if(display)
		{
			display.destroy();
			delete _displays[id];
		}
	};

	/**
	*  Property for getting/setting the target fps (when not using RAF)
	*  @public
	*  @property {Number} fps
	*/
	Object.defineProperty(p, &quot;fps&quot;, {
		get: function()
		{
			return _fps;
		},
		set: function(value)
		{
			if(typeof value != &quot;number&quot;) return;
			_fps = value;
			_msPerFrame = (1000 / _fps) | 0;
		}
	});

	/**
	*  Getter and setting for using Request Animation Frame
	*  @public
	*  @property {Boolean} raf
	*/
	Object.defineProperty(p, &quot;raf&quot;, {
		get: function()
		{
			return _useRAF;
		},
		set: function(value)
		{
			_useRAF = !!value;
		}
	});

	/**
	*  _tick would be bound in _tickCallback
	*  @method _tick
	*  @private
	*/
	p._tick = function()
	{
		if (_paused)
		{
			_tickId = -1;
			return;
		}

		var now = TimeUtils.now();
		var dTime = now - _lastFrameTime;
		
		// Only update the framerate every second
		if(_framerate)
		{
			_frameCount++;
			var elapsed = now - _lastFPSUpdateTime;
			if (elapsed &gt; 1000)
			{
				var framerateValue = 1000 / elapsed * _frameCount;
				_framerate.innerHTML = &quot;FPS: &quot; + (Math.round(framerateValue * 1000) / 1000);
				_lastFPSUpdateTime = now;
				_frameCount = 0;
			}
		}
		_lastFrameTime = now;

		//trigger the update event
		this.trigger(UPDATE, dTime);

		//then update all displays
		for(var key in _displays)
		{
			_displays[key].render(dTime);
		}

		//request the next tick
		//request the next animation frame
		_tickId = _useRAF ?
			requestAnimFrame(_tickCallback) :
			setTargetedTimeout(_tickCallback, TimeUtils.now() - _lastFrameTime);
	};

	/**
	* Destroys the application, global libraries registered via Application.registerDestroy() and all active displays
	* @method destroy
	*/
	p.destroy = function()
	{
		this._readyToInit = false;
		this.paused = true;
		this.trigger(DESTROY);
		
		for(var key in _displays)
		{
			_displays[key].destroy();
		}
		_displays = null;

		for(var i = 0; i &lt; Application._globalDestroy.length; ++i)
		{
			Application._globalDestroy[i]();
		}

		if(_resizeElement)
		{
			window.removeEventListener(&quot;resize&quot;, this.triggerResize);
		}

		_pageVisibility.destroy();
		_pageVisibility = null;

		_instance =
		_tickCallback =
		_framerate =
		_resizeElement = null;

		Debug.disconnect();

		s.destroy.call(this);
	};

	// Add to the name space
	namespace(&#x27;springroll&#x27;).Application = Application;

}());
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>