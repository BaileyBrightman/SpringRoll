<!DOCTYPE html>
<html lang='en'>

<head>
<title>SpringRoll v0.3.9 API Documentation : src/loaders/Loader.js</title>
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>
<link rel='shortcut icon' type='image/png' href='../assets/images/favicon.ico?v=0.3.9'>
<link href='//fonts.googleapis.com/css?family=Titillium+Web:300,200,600' rel='stylesheet' type='text/css'>
<link rel='stylesheet' type='text/css' href='../assets/css/libraries.css?v=0.3.9'>
<link rel='stylesheet' type='text/css' href='../assets/css/main.css?v=0.3.9'>
</head>

<body>
<header>
<div class='container'>
<div class='version pull-right'>
<em>API Documentation for: 0.3.9</em>
</div>
<div class='logo'>

<h1><a href='https://github.com/SpringRoll/SpringRoll'><img src='../assets/images/logo.png?v=0.3.9' title='SpringRoll'><span class='project-name'>SpringRoll</span></a></h1> 
</div>
<div class='scope-toggles pull-right'>
<input class='scope-toggle' id='toggle-inherited' type='checkbox' data-toggle='toggle' data-on='Inherited' data-off='Inherited' data-size='mini'>
<input class='scope-toggle' id='toggle-protected' type='checkbox' data-toggle='toggle' data-on='Protected' data-off='Protected' data-size='mini'>
<input class='scope-toggle' id='toggle-private' type='checkbox' data-toggle='toggle' data-on='Private' data-off='Private' data-size='mini'>
<input class='scope-toggle' id='toggle-deprecated' type='checkbox' data-toggle='toggle' data-on='Deprecated' data-off='Deprecated' data-size='mini'>
</div></div>
</header>
<div class='container'>
<div class='row'>
<nav id='sidebar' class='col-sm-4 col-md-3'>
<h2>APIs</h2>
<div class='input-group'>
  <div class='input-group-addon'>
    <span class='glyphicon glyphicon-search'></span>
  </div>
  <input type='search' class='form-control' id='api-filter' placeholder='Type to filter APIs'>
  <span class='collapsed btn-close glyphicon glyphicon-remove-sign hidden'></span>
</div>
<nav class='navbar navbar-default'>
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="btn-group" role="group" aria-label="...">
    <button type="button" class="sidebar-toggle collapsed btn btn-default" id='toggle-classes' data-target='#classes-collapse'>
      Classes
      <span class='collapsed glyphicon glyphicon-chevron-up'></span>
      <span class='expanded glyphicon glyphicon-chevron-down'></span>
    </button>
    <button type="button" class="sidebar-toggle collapsed btn btn-default" id='toggle-modules' data-target='#modules-collapse'>
      Modules
      <span class='collapsed glyphicon glyphicon-chevron-up'></span>
      <span class='expanded glyphicon glyphicon-chevron-down'></span>
    </button>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class='collapse' id='classes-collapse'>
    <ul class='nav navbar-nav'>
        <li class='public'>
          <a href='../classes/createjs.Container.html'>createjs.Container</a>
        </li>
        <li class='public'>
          <a href='../classes/createjs.MovieClip.html'>createjs.MovieClip</a>
        </li>
        <li class='public'>
          <a href='../classes/createjs.Point.html'>createjs.Point</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.AbstractDisplay.html'>springroll.AbstractDisplay</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.AbstractHint.html'>springroll.AbstractHint</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.AnimatorHint.html'>springroll.AnimatorHint</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Application.html'>springroll.Application</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ApplicationOptions.html'>springroll.ApplicationOptions</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ApplicationPlugin.html'>springroll.ApplicationPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.CacheManager.html'>springroll.CacheManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Captions.html'>springroll.Captions</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.CaptionsPlugin.html'>springroll.CaptionsPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.CombinedCallback.html'>springroll.CombinedCallback</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ConfigPlugin.html'>springroll.ConfigPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Container.html'>springroll.Container</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ContainerPlugin.html'>springroll.ContainerPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Debug.html'>springroll.Debug</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.DebugOptions.html'>springroll.DebugOptions</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.DebugPlugin.html'>springroll.DebugPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.DelayedCall.html'>springroll.DelayedCall</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.Animator.html'>springroll.easeljs.Animator</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.AnimatorPlugin.html'>springroll.easeljs.AnimatorPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.AnimatorTimeline.html'>springroll.easeljs.AnimatorTimeline</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.AssetManager.html'>springroll.easeljs.AssetManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.AssetManagerPlugin.html'>springroll.easeljs.AssetManagerPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.BasePanel.html'>springroll.easeljs.BasePanel</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.BaseState.html'>springroll.easeljs.BaseState</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.BitmapMovieClip.html'>springroll.easeljs.BitmapMovieClip</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.BitmapUtils.html'>springroll.easeljs.BitmapUtils</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.Button.html'>springroll.easeljs.Button</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.Cutscene.html'>springroll.easeljs.Cutscene</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.DisplayAdapter.html'>springroll.easeljs.DisplayAdapter</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.DragManager.html'>springroll.easeljs.DragManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.DwellTimer.html'>springroll.easeljs.DwellTimer</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.EaselJSDisplay.html'>springroll.easeljs.EaselJSDisplay</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.ManifestsPlugin.html'>springroll.easeljs.ManifestsPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.OffClickPlugin.html'>springroll.easeljs.OffClickPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.ReversePlayback.html'>springroll.easeljs.ReversePlayback</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.SoundButton.html'>springroll.easeljs.SoundButton</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.Texture.html'>springroll.easeljs.Texture</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.easeljs.TextureAtlas.html'>springroll.easeljs.TextureAtlas</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Enum.html'>springroll.Enum</a>
        </li>
        <li class='private'>
          <a href='../classes/springroll.EnumValue.html'>springroll.EnumValue</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.EventCatalog.html'>springroll.EventCatalog</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.EventDispatcher.html'>springroll.EventDispatcher</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.EventError.html'>springroll.EventError</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.EventSignature.html'>springroll.EventSignature</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.EventUtils.html'>springroll.EventUtils</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Features.html'>springroll.Features</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.FunctionHint.html'>springroll.FunctionHint</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.FunctionTask.html'>springroll.FunctionTask</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.GroupHint.html'>springroll.GroupHint</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.HintsPlayer.html'>springroll.HintsPlayer</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.HintsPlugin.html'>springroll.HintsPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Languages.html'>springroll.Languages</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LanguagesPlugin.html'>springroll.LanguagesPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Learning.html'>springroll.Learning</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LearningError.html'>springroll.LearningError</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LearningMedia.html'>springroll.LearningMedia</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LearningMediaPlugin.html'>springroll.LearningMediaPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LearningPlugin.html'>springroll.LearningPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ListTask.html'>springroll.ListTask</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Loader.html'>springroll.Loader</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LoaderPlugin.html'>springroll.LoaderPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LoaderQueueItem.html'>springroll.LoaderQueueItem</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LoaderResult.html'>springroll.LoaderResult</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.LoadTask.html'>springroll.LoadTask</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.native.Circle.html'>springroll.native.Circle</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.native.DisplayAdapter.html'>springroll.native.DisplayAdapter</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.native.Ellipse.html'>springroll.native.Ellipse</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.native.NativeDisplay.html'>springroll.native.NativeDisplay</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.native.Point.html'>springroll.native.Point</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.native.Polygon.html'>springroll.native.Polygon</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.native.Rectangle.html'>springroll.native.Rectangle</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.PageVisibility.html'>springroll.PageVisibility</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.PageVisibilityPlugin.html'>springroll.PageVisibilityPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.Animator.html'>springroll.pixi.Animator</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.AnimatorPlugin.html'>springroll.pixi.AnimatorPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.AnimatorTimeline.html'>springroll.pixi.AnimatorTimeline</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.AssetManager.html'>springroll.pixi.AssetManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.Button.html'>springroll.pixi.Button</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.DisplayAdapter.html'>springroll.pixi.DisplayAdapter</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.DragManager.html'>springroll.pixi.DragManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.ParallelSpineData.html'>springroll.pixi.ParallelSpineData</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.pixi.PixiDisplay.html'>springroll.pixi.PixiDisplay</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.PixiTask.html'>springroll.PixiTask</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Positioner.html'>springroll.Positioner</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.PropertyDispatcher.html'>springroll.PropertyDispatcher</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ResizePlugin.html'>springroll.ResizePlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.SavedData.html'>springroll.SavedData</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ScaleItem.html'>springroll.ScaleItem</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ScaleManager.html'>springroll.ScaleManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ScalingPlugin.html'>springroll.ScalingPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Sound.html'>springroll.Sound</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.SoundContext.html'>springroll.SoundContext</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.SoundInstance.html'>springroll.SoundInstance</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.SoundListTask.html'>springroll.SoundListTask</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.SoundPlugin.html'>springroll.SoundPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.State.html'>springroll.State</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.StateEvent.html'>springroll.StateEvent</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.StateManager.html'>springroll.StateManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.StatesPlugin.html'>springroll.StatesPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.StringFilters.html'>springroll.StringFilters</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.StringFiltersPlugin.html'>springroll.StringFiltersPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.Task.html'>springroll.Task</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.TaskEvent.html'>springroll.TaskEvent</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.TaskManager.html'>springroll.TaskManager</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.TimeUtils.html'>springroll.TimeUtils</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.TouchPlugin.html'>springroll.TouchPlugin</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.ValidationError.html'>springroll.ValidationError</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.VOHint.html'>springroll.VOHint</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.VOPlayer.html'>springroll.VOPlayer</a>
        </li>
        <li class='public'>
          <a href='../classes/springroll.WeightedRandom.html'>springroll.WeightedRandom</a>
        </li>
        <li class='public'>
          <a href='../classes/window.Array.html'>window.Array</a>
        </li>
        <li class='public'>
          <a href='../classes/window.async.html'>window.async</a>
        </li>
        <li class='public'>
          <a href='../classes/window.extend.html'>window.extend</a>
        </li>
        <li class='public'>
          <a href='../classes/window.include.html'>window.include</a>
        </li>
        <li class='public'>
          <a href='../classes/window.Math.html'>window.Math</a>
        </li>
        <li class='public'>
          <a href='../classes/window.mixin.html'>window.mixin</a>
        </li>
        <li class='public'>
          <a href='../classes/window.namespace.html'>window.namespace</a>
        </li>
        <li class='public'>
          <a href='../classes/window.Number.html'>window.Number</a>
        </li>
        <li class='public'>
          <a href='../classes/window.Object.html'>window.Object</a>
        </li>
        <li class='public'>
          <a href='../classes/window.String.html'>window.String</a>
        </li>
    </ul>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class='collapse' id='modules-collapse'>
    <ul class='nav navbar-nav'>
        <li class=''>
          <a href='../modules/Captions.html'>Captions</a>
        </li>
        <li class=''>
          <a href='../modules/Container.html'>Container</a>
        </li>
        <li class=''>
          <a href='../modules/Container Client.html'>Container Client</a>
        </li>
        <li class=''>
          <a href='../modules/Core.html'>Core</a>
        </li>
        <li class=''>
          <a href='../modules/Debug.html'>Debug</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Animation.html'>EaselJS Animation</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Cutscene.html'>EaselJS Cutscene</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Display.html'>EaselJS Display</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Learning.html'>EaselJS Learning</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS States.html'>EaselJS States</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS UI.html'>EaselJS UI</a>
        </li>
        <li class=''>
          <a href='../modules/EaselJS Utilities.html'>EaselJS Utilities</a>
        </li>
        <li class=''>
          <a href='../modules/Hints.html'>Hints</a>
        </li>
        <li class=''>
          <a href='../modules/Languages.html'>Languages</a>
        </li>
        <li class=''>
          <a href='../modules/Learning.html'>Learning</a>
        </li>
        <li class=''>
          <a href='../modules/Learning Media.html'>Learning Media</a>
        </li>
        <li class=''>
          <a href='../modules/Native Display.html'>Native Display</a>
        </li>
        <li class=''>
          <a href='../modules/PIXI Animation.html'>PIXI Animation</a>
        </li>
        <li class=''>
          <a href='../modules/PIXI Display.html'>PIXI Display</a>
        </li>
        <li class=''>
          <a href='../modules/PIXI UI.html'>PIXI UI</a>
        </li>
        <li class=''>
          <a href='../modules/Sound.html'>Sound</a>
        </li>
        <li class=''>
          <a href='../modules/States.html'>States</a>
        </li>
        <li class=''>
          <a href='../modules/Tasks.html'>Tasks</a>
        </li>
        <li class=''>
          <a href='../modules/UI.html'>UI</a>
        </li>
    </ul>
  </div>
  <!-- /.container-fluid -->
</nav></nav>
<div class='col-sm-8 col-md-9'>
<div id='docs-main' class='apidocs'>
<script>
var name = {
{
name
}
}
</script>
<h1 class="file-heading">File:Loader.js</h1>

<div class="file">
<pre class="code prettyprint linenums">/**
*  @module Core
*  @namespace springroll
*/
(function()
{
	// Classes to import
	var LoaderQueueItem,
		CacheManager,
		Application,
		Sound,
		LoadQueue,
		LoaderResult,
		Debug;

	/**
	*  The Loader is the singleton loader for loading all assets
	*  including images, data, code and sounds. Loader supports cache-busting
	*  in the browser using dynamic query string parameters.
	*
	*  @class Loader
	*/
	var Loader = function()
	{
		if (!Application)
		{
			LoaderQueueItem = include(&#x27;springroll.LoaderQueueItem&#x27;);
			CacheManager = include(&#x27;springroll.CacheManager&#x27;);
			Application = include(&#x27;springroll.Application&#x27;);
			LoaderResult = include(&#x27;springroll.LoaderResult&#x27;);
			LoadQueue = include(&#x27;createjs.LoadQueue&#x27;);
			Sound = include(&#x27;createjs.Sound&#x27;, false);
			Debug = include(&#x27;springroll.Debug&#x27;, false);
		}

		/**
		*  If we can load
		*  @property {Boolean} _canLoad 
		*  @default true
		*  @private
		*/
		this._canLoad = true;

		if (DEBUG)
		{
			/**
			*  If the logging should be verbose (unminified library only)
			*  @property {Boolean} verbose
			*  @default  false
			*/
			this.verbose = false;
		}
		
		/**
		*  The maximum number of simulaneous loads
		*  @public
		*  @property {int} maxSimultaneousLoads
		*  @default 2
		*/
		this.maxSimultaneousLoads = 2;
		
		/**
		*  The reference to the cache manager
		*  @public
		*  @property {CacheManager} cacheManager
		*/
		this.cacheManager = null;
	};
	
	/** The prototype */
	var p = Loader.prototype;
	
	/**
	* Reference to the private instance object
	* @static
	* @protected
	*/
	var _instance = null;
	
	/**
	*  The collection of LoaderQueueItems
	*  @private
	*/
	var queue = null;
	
	/**
	*  The collection of LoaderQueueItems by url
	*  @private
	*/
	var queueItems = null;
	
	/**
	*  The collection of loaders
	*  @private
	*  @property {object} loaders
	*/
	var loaders = null;
	
	/**
	*  The pool of queue items
	*  @private
	*  @property {array} loaders
	*/
	var qiPool = null;

	/**
	*  The pool of loader items
	*  @private
	*  @property {array} loaders
	*/
	var loaderPool = null;

	/**
	*  The pool of result items
	*  @private
	*  @property {array} loaders
	*/
	var resultPool = null;
	
	/**
	*  The current number of items loading
	*  @private
	*  @property {int} numLoads
	*  @default 0
	*/
	var numLoads = 0;
	
	/**
	*  The retry attempts
	*  @private
	*  @property {Object} retries
	*/
	var retries = null;
	
	/**
	*  Static constructor creating the singleton
	*  @method init
	*  @static
	*  @public
	*/
	Loader.init = function()
	{
		if (!_instance)
		{
			_instance = new Loader();
			_instance._initialize();
		}
		return _instance;
	};
		
	/**
	*  Static function for getting the singleton instance
	*  @static
	*  @readOnly
	*  @public
	*  @property {Loader} instance
	*/
	Object.defineProperty(Loader, &quot;instance&quot;, {
		get:function()
		{
			return _instance;
		}
	});
	
	/**
	*  Destroy the Loader singleton, don&#x27;t use after this
	*  @public
	*  @method destroy
	*/
	p.destroy = function()
	{
		var i, len, key, arr = this.queue;
		if(arr)
		{
			for(i = 0, len = arr.length; i &lt; i; ++i)
				arr[i].destroy();
			arr = qiPool;
			for(i = 0, len = arr.length; i &lt; i; ++i)
				arr[i].destroy();
			arr = resultPool;
			for(i = 0, len = arr.length; i &lt; i; ++i)
				arr[i].destroy();
			for(key in loaders)
			{
				queueItems[key].destroy();
				loaders[key].close();
			}
		}
		_instance = null;
		if (this.cacheManager)
			this.cacheManager.destroy();
		this.cacheManager = null;
		queue = null;
		resultPool = null;
		loaderPool = null;
		qiPool = null;
		queueItems = null;
		retries = null;
		loaders = null;
	};
	
	/**
	*  Initilize the object
	*  @protected
	*  @method _initialize
	*/
	p._initialize = function()
	{
		qiPool = [];
		loaderPool = [];
		resultPool = [];
		queue = [];
		queueItems = {};
		loaders = {};
		retries = {};
		this.cacheManager = new CacheManager();
	};
	
	/**
	*  Load a file
	*  @method load
	*  @public
	*  @param {string} url The file path to load
	*  @param {function} callback The callback function when completed
	*  @param {function*} updateCallback The callback for load progress update, passes 0-1 as param
	*  @param {int*} priority The priority of the load
	*  @param {*} data optional data
	*/
	p.load = function(url, callback, updateCallback, priority, data)
	{
		var qi = this._getQI();
		
		var basePath = Application.instance.options.basePath;
		if (basePath !== undefined &amp;&amp; /^http(s)?\:/.test(url) === false &amp;&amp; url.search(basePath) == -1)
		{
			qi.basePath = basePath;
		}
		
		qi.url = url;
		qi.callback = callback;
		qi.updateCallback = updateCallback || null;
		qi.priority = priority || LoaderQueueItem.PRIORITY_NORMAL;
		qi.data = data || null;
		
		queue.push(qi);
		
		// Sory by priority
		queue.sort(function(a, b){
			return a.priority - b.priority;
		});
		
		// Try to load the next queue item
		this._tryNextLoad();
	};
	
	/**
	*  There was an error loading the file
	*  @private
	*  @method _onLoadFailed
	*  @param {LoaderQueueItem} qi The loader queue item
	*/
	p._onLoadFailed = function(qi, event)
	{
		if(!_instance)
			return;
		
		if (DEBUG &amp;&amp; Debug) 
		{
			Debug.error(&quot;Unable to load file: &quot; + qi.url  + &quot; - reason: &quot; + event.error);
		}
		
		var loader = loaders[qi.url];
		loader.removeAllEventListeners();
		loader.close();
		this._poolLoader(loader);
		
		delete queueItems[qi.url];
		delete loaders[qi.url];
		
		if(retries[qi.url])
			retries[qi.url]++;
		else
			retries[qi.url] = 1;
		if(retries[qi.url] &gt; 3)
			this._loadDone(qi, null);
		else
		{
			numLoads--;
			queue.push(qi);
			this._tryNextLoad();
		}
	};
	
	/**
	*  The file load progress event
	*  @method _onLoadProgress
	*  @private
	*  @param {LoaderQueueItem} qi The loader queue item
	*  @param {object} event The progress event
	*/
	p._onLoadProgress = function(qi, event)
	{
		qi.progress = event.progress;
		if (qi.updateCallback){
			qi.updateCallback(qi.progress);
		}
	};
	
	/**
	*  The file was loaded successfully
	*  @private
	*  @method _onLoadCompleted
	*  @param {LoaderQueueItem} qi The loader queue item
	*  @param {object} ev The load event
	*/
	p._onLoadCompleted = function(qi, ev)
	{
		if(!_instance)
			return;

		if (DEBUG &amp;&amp; Debug &amp;&amp; this.verbose)
		{
			Debug.log(&quot;File loaded successfully from &quot; + qi.url);
		}
		var loader = loaders[qi.url];
		loader.removeAllEventListeners();
		loader.close();
		this._poolLoader(loader);
		
		delete queueItems[qi.url];
		delete loaders[qi.url];
		this._loadDone(qi, this._getResult(ev.result, qi.url, loader, qi.data));
	};
	
	/**
	*  Attempt to do the next load
	*  @method _tryNextLoad
	*  @private
	*/
	p._tryNextLoad = function()
	{
		if (numLoads &gt; this.maxSimultaneousLoads - 1 || queue.length === 0) return;
		
		numLoads++;
		
		var qi = queue.shift();
		
		if (DEBUG &amp;&amp; Debug &amp;&amp; this.verbose)
		{
			Debug.log(&quot;Attempting to load file &#x27;&quot; + qi.url + &quot;&#x27;&quot;);
		}
		
		queueItems[qi.url] = qi;
		
		var loader = this._getLoader(qi.basePath);
		
		// Add to the list of loaders
		loaders[qi.url] = loader;
		
		loader.addEventListener(&quot;fileload&quot;, qi._boundComplete);
		loader.addEventListener(&quot;error&quot;, qi._boundFail);
		loader.addEventListener(&quot;fileprogress&quot;, qi._boundProgress);
		var url = this.cacheManager.prepare(qi.url);
		loader.loadFile(qi.data ? {id:qi.data.id, src:url, data:qi.data} : url);
	};
	
	/**
	*  Alert that the loading is finished
	*  @private
	*  @method _loadDone
	*  @param {LoaderQueueItem} qi The loader queue item
	*  @param {object} result The event from preloadjs or null
	*/
	p._loadDone = function(qi, result)
	{
		numLoads--;
		if(qi.data &amp;&amp; result)//a way to keep track of load results without excessive function binding
			result.id = qi.data.id;
		qi.callback(result);
		//qi.destroy();
		this._poolQI(qi);
		this._tryNextLoad();
	};
	
	/**
	*  Cancel a load that&#x27;s currently in progress
	*  @public
	*  @method cancel
	*  @param {string} url The url
	*  @return {bool} If canceled returns true, false if not canceled
	*/
	p.cancel = function(url)
	{
		var qi = queueItems[url];
		var loader = loaders[url];
		
		if (qi &amp;&amp; loader)
		{
			loader.close();
			delete loaders[url];
			delete queueItems[qi.url];
			numLoads--;
			this._poolLoader(loader);
			this._poolQI(qi);
			return true;
		}
		
		for(var i = 0, len = queue.length; i &lt; len; i++)
		{
			qi = queue[i];
			if (qi.url == url){
				queue.splice(i, 1);
				this._poolQI(qi);
				return true;
			}
		}
		return false;
	};
	
	p._getQI = function()
	{
		var rtn;
		if(qiPool.length)
			rtn = qiPool.pop();
		else
		{
			rtn = new LoaderQueueItem();
			rtn._boundFail = this._onLoadFailed.bind(this, rtn);
			rtn._boundProgress = this._onLoadProgress.bind(this, rtn);
			rtn._boundComplete = this._onLoadCompleted.bind(this, rtn);
		}
		return rtn;
	};
	
	p._poolQI = function(qi)
	{
		qiPool.push(qi);
		qi.callback = qi.updateCallback = qi.data = qi.url = null;
		qi.progress = 0;
	};
	
	p._getLoader = function(basePath)
	{
		var rtn;
		if(loaderPool.length)
		{
			rtn = loaderPool.pop();
			rtn._basePath = basePath;//apparently they neglected to make this public
		}
		else
			rtn = new LoadQueue(true, basePath, Application.instance.options.crossOrigin);
		//allow the loader to handle sound as well
		if(Sound)
		{
			rtn.installPlugin(Sound);
		}
		return rtn;
	};
	
	p._poolLoader = function(loader)
	{
		loader.removeAll();//clear the loader for reuse
		loaderPool.push(loader);
	};
	
	p._getResult = function(result, url, loader, manifestData)
	{
		var rtn;
		if(resultPool.length)
		{
			rtn = resultPool.pop();
			rtn.content = result;
			rtn.url = url;
			rtn.loader = loader;
			rtn.manifestData = manifestData;
		}
		else
			rtn = new LoaderResult(result, url, loader, manifestData);
		return rtn;
	};
	
	p._poolResult = function(result)
	{
		result.content = result.url = result.loader = result.id = null;
		resultPool.push(result);
	};
	
	// MediaLoader name is deprecated
	namespace(&#x27;springroll&#x27;).MediaLoader = Loader;
	namespace(&#x27;springroll&#x27;).Loader = Loader;
}());</pre>
</div></div>
</div>
</div>
</div>
<script src='../assets/js/libraries.js?v=0.3.9'></script>
<script src='../assets/js/main.js?v=0.3.9'></script>
</body>
</html>