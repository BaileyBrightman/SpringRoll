<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>AssetManager Example</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width">
		<link rel="stylesheet" href="assets/css/main.css">

		<!-- Examples dependencies, these are only necessary for examples -->
		<link rel="stylesheet" href="../components/google-code-prettify/bin/prettify.min.css">
		<script src="../components/google-code-prettify/bin/prettify.min.js"></script>
		<script src="../components/google-code-prettify/bin/run_prettify.min.js"></script>
		<script src="assets/js/examples.js"></script>

		<!-- External dependencies -->
		<script src="../components/tweenjs/lib/tweenjs.min.js"></script>
		<script src="../components/easeljs/lib/easeljs.combined.js"></script>
		<script src="../components/easeljs/lib/movieclip.combined.js"></script>
		<script src="../components/preloadjs/lib/preloadjs.min.js"></script>

		<!-- Library and modules -->
		<script src="../dist/core.js"></script>
		<script src="../dist/modules/debug.js"></script>
		<script src="../dist/modules/easeljs-display.js"></script>
		<script src="../dist/modules/easeljs-ui.js"></script>
		<script src="../dist/modules/easeljs-animation.js"></script>

	</head>
	<body>
		<div id="content" class="canvas">
			<nav>
				<button id="canvas">Application</button>
				<button id="code">Code</button>
				<button id="back">Back</button>
			</nav>
			<div id="framerate">FPS: 00.000</div>
			<canvas id="stage" width="800" height="400"></canvas>
			<pre id="codeDisplay"></pre>
<script>

var Application = include('springroll.Application'),
	Button = include('springroll.easeljs.Button'),
	EaselJSDisplay = include('springroll.EaselJSDisplay'),
	AssetManager = include('springroll.AssetManager'),
	Animator = include('springroll.easeljs.Animator');

// Create the new application
var app = new Application({
	resizeElement : "stageContainer",
	framerate: "framerate",
	canvasId: "stage",
	display: EaselJSDisplay,
	displayOptions: {
		clearView: true // clear the stage on render
	}
});

// The list of assets to load and remember for later
// with the AssetManager, we will be able to unload
var manifest = [
	// Standard asset loading
	{
		id:'Button',
		src:'assets/images/button.png'
	},
	// Load some Flash data
	{
		id: 'Transition',
		src: 'assets/js/Transition.js'
	},
	// Loading a BitmapMovieClip (requires anim, atlas, image)
	// this type is in the easeljs-animation module
	{
		id:'Flower',
		anim:'assets/images/FlowerData.json',
		atlas:'assets/images/FlowerSheet.json',
		image:'assets/images/FlowerSheet.png'
	}
];

// Add the manifest with the loading event to make sure
// assets are loaded before the application is init
app.once('loading', function(assets)
{
	AssetManager.load(manifest, assets);
});

// Wait until the app is ready
app.once('init', function()
{
	// The asset manager just loaded the JavaScript
	// now we can actually create a MovieClip
	// from the JavaScript library
	var transition = new lib.Transition();
	
	// Get the Bitmap movieclip
	var flower = AssetManager.get('Flower');
	
	// Create a button that destroys the universe
	var unloadButton = new Button(AssetManager.get('Button'), {
		text: 'Unload',
		font: "16px Arial",
		color: "#ffffff"
	});

	// Fudge positions
	transition.x = -140;
	flower.x = 400;
	flower.y = 200;
	unloadButton.x = 340;
	unloadButton.y = 300;

	// Add items to the stage
	this.display.stage.addChild(flower, unloadButton, transition);
	
	// Add the animation
	Animator.play(flower, "wet");
	Animator.play(transition, "onTransitionIn");

	// Handler to clear the stage
	unloadButton.addEventListener(Button.BUTTON_PRESS, function()
	{
		// Destroy display objects
		unloadButton.destroy();
		unloadButton = null;

		// Stop the animation
		Animator.stop(flower);
		flower = null;

		Animator.stop(transition);
		transition = null;

		// Remove all display objects
		app.display.stage.removeAllChildren();

		// Unload assets that have been loaded
		AssetManager.unload(manifest);
	});
});


</script>
		</div>
	</body>
</html>