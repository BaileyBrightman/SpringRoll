/*! SpringRoll 0.2.0 */
!function(){"use strict";!function(){var a,b,c,d=include("createjs.Container"),e=function(){c||(c=include("springroll.Application"),a=include("springroll.easeljs.DwellTimer",!1),b=include("springroll.Animator",!1)),d.call(this),this.game=c.instance,this.config=this.game.config,this.background=null},f=extend(e,d);f.setup=function(){},f.teardown=function(){var a=this.children.slice();this.cleanupChildren.apply(this,a)},f.cleanupChildren=function(c){var d,e,f=arguments.length;for(e=0;f>e;e++)d=arguments[e],d&&(Array.isArray(d)&&d.length>0?this.cleanupChildren.apply(this,d):(a&&a.destroy(d),b&&b.stop(d,!0),d.stop&&d.stop(),d.destroy&&d.destroy(),d.removeAllChildren&&d.removeAllChildren(!0),this.contains(d)&&this.removeChild(d)))},f.destroy=function(){this.game=null,this.config=null,this.background=null,this.removeAllChildren()},namespace("springroll.easeljs").BasePanel=e}(),function(a){var b,c,d,e,f,g,h=include("springroll.BaseState"),i=function(a,i,j){if(c||(c=include("springroll.Application"),e=include("springroll.easeljs.BasePanel"),d=include("springroll.ListTask"),f=include("springroll.TaskManager"),g=include("springroll.UIScaler"),b=include("springroll.Debug",!1)),!(a instanceof e))throw"springroll.BaseState requires the panel be a springroll.easeljs.BasePanel";h.call(this,a,i,j),this.game=c.instance,this.player=this.game.player,this.config=this.game.config,this.manifest=null,this.assetsLoaded=!1,this.scaler=null,this.resizeOnReload=!0,this.useDefaultManifest=!0,this.delayLoadFrames=0},j=h.prototype,k=extend(i,h);k.enter=function(){this.loadingStart(),this.assetsLoaded=!1;var a=[];this.useDefaultManifest&&this.manifest&&this.manifest.length&&a.push(new d("manifests",this.manifest,m)),this.addTasks(a),a.length?f.process(a,l.bind(this)):l.call(this)},k.addTasks=function(a){},k.onAssetsLoaded=function(){};var l=function(){this.assetsLoaded=!0,this.panel.setup();var b=this.config.scaling[this.stateId];if(b!==a){(!this.scaler||this.resizeOnReload)&&(this.scaler=new g(this.panel,this.config.designedSettings,b,!1));var c=this.panel.background;c&&c.image&&this.scaler.addBackground(c)}else(!this.scaler||this.resizeOnReload)&&(this.panel.x=this.panel.y=0,this.panel.scaleX=this.panel.scaleY=1,b={panel:{align:"top-left",titleSafe:!0}},this.scaler=new g(this,this.config.designedSettings,b,!1));if(this.scaler.enabled=!0,this.onAssetsLoaded(),this.delayLoadFrames>0){var d=this.delayLoadFrames,e=this.game,f=this.loadingDone.bind(this),h=function(){--d<=0&&(e.off("update",h),f())};e.on("update",h)}else this.loadingDone()},m=function(a){for(var b in a)-1===a[b].url.indexOf(".js")&&(images[b]=a[b].content)};k.exit=function(){if(this.assetsLoaded){if(this.panel.teardown(),this.scaler&&(this.scaler.enabled=!1,this.scaler.removeBackground(this.panel.background),this.resizeOnReload&&(this.scaler.destroy(),this.scaler=null)),this.manifest)for(var a,b=this.manifest,c=b.length,d=0;c>d;d++)a=b[d].id,delete images[a];this.assetsLoaded=!1}},k.destroy=function(){this.manifest=null,this.game=null,this.config=null,this.player=null,this.panel.destroy(),this.scaler&&(this.scaler.destroy(),this.scaler=null),j.destroy.apply(this)},namespace("springroll.easeljs").BaseState=i,namespace("springroll.easeljs").ManifestState=i}(),function(a){var b,c,d,e,f=include("springroll.TrackingGame"),g=include("springroll.easeljs.EaselJSDisplay"),h=function(a){c=include("createjs.Text"),d=include("springroll.LoadTask"),e=include("springroll.easeljs.BaseState"),b=include("springroll.easeljs.Animator"),f.call(this,Object.merge({manifestsPath:"assets/config/manifests.json",display:g,displayOptions:{clearView:!0},fps:30},a)),this._manifests={},this.offClickParams=[],null!==this.options.manifestsPath&&(l=l.bind(this),this.once("configLoaded",l)),this.on("statesReady",m.bind(this)),o=o.bind(this),this.display&&this.display.stage&&this.display.stage.addEventListener("stagemousedown",o)},i=f.prototype,j=extend(h,f),k="manifestLoaded",l=function(a,b){b.addTask(new d("manifests",this.options.manifestsPath,n.bind(this)))},m=function(){var a=this.display.stage;this.captions.textField instanceof c&&a.addChild(this.captions.textField),a.addChild(this.transition)},n=function(a,b,c){var d,e=this._manifests,f=a.content;for(var g in f)d=g.toString().toLowerCase(),e[d]||(e[d]=f[g]);this.trigger(k,c)};j.addState=function(b,c){if(!(c instanceof e))throw"springroll.easeljs.TrackingGame requires states to extend springroll.easeljs.BaseState";i.addState.call(this,b,c);var d=[],f=this.config.manifests;f!==a&&f[b]!==a&&(d=f[b]),this._manifests[b]!==a&&(d=d.concat(this._manifests[b])),c.manifest=d};var o=function(a){if(this.tracker){var b=a.target,c=b._getObjectsUnderPoint(a.stageX,a.stageY,null,!0),d=!1;if(c)for(;c&&c!=b;){if(c.hasEventListener("mousedown")||c.hasEventListener("click")){d=!0;break}c=c.parent}if(!d){var e=this.offClickParams.slice(0);e.unshift(this.normalizePosition(a.stageX,a.stageY)),this.tracker.offClick.apply(this,e)}}};j.destroy=function(){this.display&&this.display.stage&&this.display.stage.removeEventListener("stagemousedown",o),this.offClickParams=null,this._manifests=null,i.destroy.call(this)},Object.defineProperty(j,"manifests",{get:function(){return this._manifests}}),namespace("springroll.easeljs").TrackingGame=h}();}();