/*! SpringRoll 0.0.7 */
!function(){"use strict";!function(a){var b=include("springroll.Loader"),c=include("springroll.EventDispatcher"),d=function(a){if(h)throw"Only one Language can exist at a time!";if(h=this,c.call(this),!a.languages||!a["default"])throw"Language requires a language dictionary and a default language!";this._replace=a.replace||"%LANG%",this._current=null,this._default=a["default"],this.languages=a.languages,this._stringTable=null,this.setLanguage(this.getPreferredLanguages()),this.modifyUrl=this.modifyUrl.bind(this),b.instance.cacheManager.registerURLFilter(this.modifyUrl)},e=c.prototype,f=d.prototype=Object.create(e),g="changed",h=null;Object.defineProperty(d,"instance",{get:function(){return h}}),Object.defineProperty(f,"current",{get:function(){return this._current}}),f.getPreferredLanguages=function(){var b,c=a.navigator;return b=c.languages?c.languages:c.language?[c.language||c.userLanguage]:[]},f.setLanguage=function(a){if(a){Array.isArray(a)||(a=[a]);for(var b,c=0,d=a.length;d>c;++c){var e=a[c].toLowerCase();if(this.languages.indexOf(e)>=0){b=e;break}if(e.indexOf("-")>=0&&(e=e.split("-")[0].toLowerCase(),this.languages.indexOf(e)>=0)){b=e;break}}b||(b=this._default),b!=this._current&&(this._current=b,this.trigger(g,b))}},f.setStringTable=function(a){this._stringTable=a},f.getString=function(a){return this._stringTable?this._stringTable[a]:null},f.getFormattedString=function(a){var b=this._stringTable?this._stringTable[a]:null;return b?b.format(Array.prototype.slice.call(arguments,1)):null},f.modifyUrl=function(a){for(;a.indexOf(this._replace)>=0;)a=a.replace(this._replace,this._current);return a},f.destroy=function(){e.destroy.call(this),b.instance&&b.instance.cacheManager.unregisterURLFilter(this.modifyUrl),this.modifyUrl=this.languages=null,h=null},namespace("springroll").Language=d}(window);}();