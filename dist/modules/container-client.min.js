/*! SpringRoll 0.3.7 */
!function(){"use strict";!function(a){var b=include("springroll.PageVisibility"),c=include("Bellhop"),d=mixin({},"springroll.ApplicationPlugin",50);d.setup=function(){this.options.add("singlePlay",!1,!0),this.options.add("playOptions",null,!0),this.container=new c,this.container.connect(),this.on("learningEvent",function(a){this.container.send("learningEvent",a)}),this.on("analyticEvent",function(a){this.container.send("analyticEvent",a)}),this.once("beforeInit",function(){this.container.send("loadDone")}),this.singlePlay=!1,this.playOptions=null,this.singlePlayEnd=function(){this.singlePlay&&this.endGame()},this.endGame=function(a){this.trigger("endGame",a||"game_completed"),this.destroy()},this.analyticEvent=function(a,b,c){this.trigger("analyticEvent",{category:this.name,action:a,label:b,value:c})},window.onunload=window.onbeforeunload=e.bind(this)};var e=function(){return window.onunload=window.onbeforeunload=null,this.endGame("left_site"),a};d.preload=function(a){if(!this.name)throw"Application name is empty";if(this.singlePlay=!!this.options.singlePlay,this.playOptions=this.options.playOptions||{},this.container.supported){this.container.on({soundMuted:g.bind(this),captionsMuted:h.bind(this),musicMuted:i.bind(this,"music"),voMuted:i.bind(this,"vo"),sfxMuted:i.bind(this,"sfx"),captionsStyles:j.bind(this),pause:f.bind(this),singlePlay:l.bind(this),playOptions:k.bind(this),close:m.bind(this)});var c=!!this.sound;this.container.send("features",{learning:!!this.learning,sound:c,hints:!!this.hints,music:c&&this.sound.contextExists("music"),vo:c&&this.sound.contextExists("vo"),sfx:c&&this.sound.contextExists("sfx"),captions:!!this.captions}),this.options.autoPause=!1;var d=this.container;this._pageVisibility=new b(d.send.bind(d,"focus",!0),d.send.bind(d,"focus",!1))}a()};var f=function(a){this.paused=!!a.data,this.enabled=!this.paused},g=function(a){this.sound.muteAll=!!a.data},h=function(a){this.captions.mute=!!a.data},i=function(a,b){this.sound.setContextMute(a,!!b.data)},j=function(a){var b=a.data,c=this.captions||{},d=c.textField||null;d&&d.nodeName&&(d.className="size-"+b.size+" bg-"+b.background+" color-"+b.color+" edge-"+b.edge+" font-"+b.font+" align-"+b.align)},k=function(a){Object.merge(this.playOptions,a.data||{})},l=function(){this.singlePlay=!0},m=function(){this.endGame("closed_container")};d.teardown=function(){this._pageVisibility&&(this._pageVisibility.destroy(),this._pageVisibility=null),this.container&&(this.container.send("endGame"),this.container.destroy(),this.container=null)},d.register()}();}();