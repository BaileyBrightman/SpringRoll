/*! SpringRoll 0.0.6 */
!function(){"use strict";!function(){var a={};a.gotoAndCache=function(a,b,c){b=void 0===b?0:b,c=void 0===c?15:c,a.timeline&&a.gotoAndStop(b);var d=a.nominalBounds;a.cache(d.x-c,d.y-c,d.width+2*c,d.height+2*c,1)},namespace("springroll").MovieClipUtils=a,namespace("springroll.createjs").MovieClipUtils=a}(),function(a){var b={};b.Circle=include("createjs.Circle",!1),b.Ellipse=include("createjs.Ellipse",!1),b.Rectangle=include("createjs.Rectangle"),b.Sector=include("createjs.Sector",!1),b.Point=include("createjs.Point"),b.Polygon=include("createjs.Polygon",!1),b.useRadians=!1,b.getLocalBounds=function(b){var c;if(b.nominalBounds)c=b.nominalBounds.clone();else if(b.width!==a&&b.height!==a){var d=b.width/b.scaleX,e=b.height/b.scaleY;c=new createjs.Rectangle(-b.regX,-b.regY,d,e)}else b.getLocalBounds&&(c=b.getLocalBounds(),c&&(c=c.clone())),c||(c=new createjs.Rectangle);return c.right=c.x+c.width,c.bottom=c.y+c.height,c},b.getScale=function(b,c){return c!==a?b["scale"+c.toUpperCase()]:{x:b.scaleX,y:b.scaleY}},b.setPosition=function(b,c,d){return d!==a?b[d]=c:(c.x!==a&&(b.x=c.x),c.y!==a&&(b.y=c.y)),b},b.getPosition=function(b,c){return c!==a?b[c]:{x:b.x,y:b.y}},b.setScale=function(b,c,d){return d!==a?b["scale"+d.toUpperCase()]=c:b.scaleX=b.scaleY=c,b},b.setPivot=function(b,c,d){return d!==a&&(b["reg"+d.toUpperCase()]=c),b.regX=c.x,b.regY=c.y,b},b.setHitArea=function(a,b){return a.hitShape=b,a},b.getBitmapSize=function(a){return{h:a.image.height,w:a.image.width}},b.removeChildren=function(a){a.removeAllChildren()},namespace("springroll.createjs").DisplayAdapter=b}(),function(){var a,b,c=include("springroll.AbstractDisplay"),d=function(d,e){a||(a=include("createjs.Stage"),b=include("createjs.Touch")),c.call(this,d,e),e=e||{},this.mouseOverRate=e.mouseOverRate||30,"spriteStage"==e.stageType||(this.stage=new a(d)),this.stage.autoClear=!!e.clearView,this.animator=include("springroll.createjs.Animator"),this.adapter=include("springroll.createjs.DisplayAdapter")},e=c.prototype,f=d.prototype=Object.create(e),g={delta:0};Object.defineProperty(f,"enabled",{get:function(){return this._enabled},set:function(a){Object.getOwnPropertyDescriptor(e,"enabled").set.call(this,a),a?(this.stage.enableMouseOver(this.mouseOverRate),this.stage.enableDOMEvents(!0),b.enable(this.stage)):(this.stage.enableMouseOver(!1),this.stage.enableDOMEvents(!1),b.disable(this.stage),this.canvas.style.cursor="")}}),f.render=function(a){!this.paused&&this._visible&&(g.delta=a,this.stage.update(g))},f.destroy=function(){e.destroy.call(this),this.stage.removeAllChildren(!0),this.stage=null},namespace("springroll").CreateJSDisplay=d,namespace("springroll.createjs").CreateJSDisplay=d}(),function(){var a=function(){this.onComplete=null,this.onCompleteParams=null,this.onCancelled=null,this.event=null,this.instance=null,this.firstFrame=-1,this.lastFrame=-1,this.isLooping=!1,this.length=0,this.useCaptions=!1,this._paused=!1,this.startTime=0,this.duration=0,this.speed=1,this.time=0,this.soundAlias=null,this.soundInst=null,this.playSound=!1,this.soundStart=0,this.soundEnd=0};Object.defineProperty(a.prototype,"paused",{get:function(){return this._paused},set:function(a){a!=this._paused&&(this._paused=!!a,this.soundInst&&(this.paused?this.soundInst.pause():this.soundInst.unpause()))}}),namespace("springroll").AnimatorTimeline=a,namespace("springroll.createjs").AnimatorTimeline=a}(),function(a){var b,c=include("springroll.Application"),d=include("springroll.createjs.AnimatorTimeline"),e={};e.debug=!1,e.captions=null;var f=null,g=null,h=null,i=!1,j={};e.init=function(){f=[],g=[],h={},i=!1,b=include("springroll.Sound",!1)},e.destroy=function(){e.stopAll(),e.captions=null,j=null,f=null,g=null,h=null},c.registerInit(e.init),c.registerDestroy(e.destroy),e.play=function(c,d,g){var i,k,l,m,n,o;g&&"function"==typeof g?(i=g,g=j):g||(g=j),i=g.onComplete||i||null,k=g.onCompleteParams||null,l=g.startTime,l=l?.001*l:0,m=g.speed||1,o=g.onCancelled||null,n=g.soundData||null,f||e.init(),h[c.id]!==a&&e.stop(c);var p=e._makeTimeline(c,d,i,k,m,n,o);return p.firstFrame>-1&&p.lastFrame>-1?(p.time=-1==l?Math.random()*p.duration:l,c.elapsedTime=p.startTime+p.time,c.play(),c._tick(),e._hasTimelines()||e._startUpdate(),f.push(p),h[c.id]=p,p.soundStart>0&&b.instance.preloadSound(p.soundAlias),p):(i&&i.apply(null,k),null)},e._makeTimeline=function(a,f,g,h,i,j,k){var l=new d;if(!e._canAnimate(a))return l;a.advanceDuringTicks=!1;var m;a.framerate?m=a.framerate:(m=c.instance.options.fps,m||(m=c.instance.fps),m||(m=15),a.framerate=m),l.instance=a,l.event=f,l.onComplete=g,l.onCompleteParams=h,l.onCancelled=k,l.speed=i,j&&b&&(l.playSound=!0,"string"==typeof j?(l.soundStart=0,l.soundAlias=j):(l.soundStart=j.start>0?j.start:0,l.soundAlias=j.alias),l.useCaptions=e.captions&&e.captions.hasCaption(l.soundAlias));for(var n,o=a.getLabels(),p=f+"_stop",q=f+"_loop",r=0,s=o.length;s>r;++r)if(n=o[r],n.label==f)l.firstFrame=n.position;else{if(n.label==p){l.lastFrame=n.position;break}if(n.label==q){l.lastFrame=n.position,l.isLooping=!0;break}}return l.length=l.lastFrame-l.firstFrame,l.startTime=l.firstFrame/m,l.duration=l.length/m,l},e._canAnimate=function(b){return b instanceof createjs.MovieClip?!0:b.framerate!==a&&b.getLabels!==a&&b.elapsedTime!==a&&b._tick!==a&&b.gotoAndStop!==a&&b.play!==a&&b.id!==a?!0:!1},e.instanceHasAnimation=function(a,b){if("function"!=typeof a.getLabels)return!1;for(var c,d=a.getLabels(),e=-1,f=-1,g=b+"_stop",h=b+"_loop",i=0,j=d.length;j>i;++i)if(c=d[i],c.label==b)e=c.position;else if(c.label==g||c.label==h){f=c.position;break}return e>=0&&f>=0},e.getDuration=function(a,b){if("function"!=typeof a.getLabels)return 0;if(Array.isArray(b)){for(var d=0,f=0,g=b.length;g>f;f++)d+=e.getDuration(a,b[f]);return d}for(var h,i=a.getLabels(),j=-1,k=-1,l=b+"_stop",m=b+"_loop",n=0,o=i.length;o>n;++n)if(h=i[n],h.label==b)j=h.position;else if(h.label==l||h.label==m){k=h.position;break}if(j>=0&&k>=0){if(!a.framerate){var p=c.instance.options.fps;p||(p=c.instance.fps),p||(p=15),a.framerate=p}return(k-j)/a.framerate}return 0},e.stop=function(a){if(f&&h[a.id]){var b=h[a.id];e._remove(b,!0)}},e.stopAll=function(a){if(e._hasTimelines())for(var b,c=f.slice(),d=0,g=c.length;g>d;d++)b=c[d],(!a||a.contains(b.instance))&&e._remove(b,!0)},e._remove=function(a,b){var c=g.indexOf(a);if(c>=0&&g.splice(c,1),c=f.indexOf(a),!(0>c)){var d=a.onComplete,i=a.onCompleteParams,j=a.onCancelled;a.instance.stop(),b&&a.soundInst&&a.soundInst.stop(),f.splice(c,1),delete h[a.instance.id],a.useCaptions&&e.captions.stop(),a.instance=null,a.event=null,a.onComplete=null,a.onCompleteParams=null,e._hasTimelines()||e._stopUpdate(),b?j&&j():d&&d.apply(null,i)}},e.pause=function(){if(f&&!i){i=!0;for(var a=0,b=f.length;b>a;a++)f[a].paused=!0;e._stopUpdate()}},e.resume=function(){if(f&&i){i=!1;for(var a=0,b=f.length;b>a;a++)f[a].paused=!1;e._hasTimelines()&&e._startUpdate()}},e.pauseInGroup=function(a,b){if(e._hasTimelines()&&b)for(var c=0,d=f.length;d>c;c++)b.contains(f[c].instance)&&(f[c].paused=a)},e.getTimeline=function(b){return e._hasTimelines()&&h[b.id]!==a?h[b.id]:null},e.getPaused=function(){return i},e._startUpdate=function(){c.instance&&c.instance.on("update",e._update)},e._stopUpdate=function(){c.instance&&c.instance.off("update",e._update)},e._update=function(a){if(f){for(var c,d,h,i=.001*a,j=f.length-1;j>=0;--j)if(c=f[j],d=c.instance,!c.paused){if(c.soundInst){if(!c.soundInst.isValid){g.push(c);continue}if(h=.001*c.soundInst.position,0>h&&(h=0),c.time=c.soundStart+h,c.useCaptions&&e.captions.seek(c.soundInst.position),c.time>=c.duration){d.gotoAndStop(c.lastFrame),g.push(c);continue}}else{if(c.time+=i*c.speed,c.time>=c.duration){if(!c.isLooping){d.gotoAndStop(c.lastFrame),g.push(c);continue}c.time-=c.duration,c.onComplete&&c.onComplete.apply(null,c.onCompleteParams)}c.playSound&&c.time>=c.soundStart&&(c.time=c.soundStart,c.soundInst=b.instance.play(c.soundAlias,l.bind(this,c),k.bind(this,c)),c.useCaptions&&e.captions.play(c.soundAlias))}d.elapsedTime=c.startTime+c.time,d.advance()}for(j=0;j<g.length;j++)c=g[j],e._remove(c)}};var k=function(a){a.playSound=!1,a.soundEnd=a.soundStart+.001*a.soundInst.length},l=function(a){a.soundEnd>0&&a.soundEnd>a.time&&(a.time=a.soundEnd),a.soundInst=null};e._hasTimelines=function(){return f?f.length>0:!1},e.toString=function(){return"[springroll.createjs.Animator]"},namespace("springroll").Animator=e,namespace("springroll.createjs").Animator=e}(),function(a){function b(a){if(!a||"object"!=typeof a)return null;var b=a.constructor();b||(b={});for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}{var c=include("createjs.Rectangle"),d=include("createjs.Container"),e=include("createjs.ColorMatrix"),f=include("createjs.ColorFilter"),g=include("createjs.ColorMatrixFilter"),h=include("createjs.Text"),i=include("createjs.Event"),j=include("createjs.Point"),k=include("createjs.Bitmap"),l=function(a,b,c){d.call(this),this.back=null,this.label=null,this._overCB=this._onMouseOver.bind(this),this._outCB=this._onMouseOut.bind(this),this._downCB=this._onMouseDown.bind(this),this._upCB=this._onMouseUp.bind(this),this._clickCB=this._onClick.bind(this),this._stateFlags={},this._statePriority=null,this._stateData={},this._width=0,this._height=0,this._offset=new j,this.buttonInitialize(a,b,c)},m=l.prototype=Object.create(d.prototype);d.prototype}l.BUTTON_PRESS="buttonPress";var n=["disabled","enabled","up","over","down"],o=["disabled","down","over","up"];m.buttonInitialize=function(d,e,f){this.mouseChildren=!1;var g,i=this._stateData;e&&(g=b(e),delete g.text,g.x===a&&(g.x="center"),g.y===a&&(g.y="center"));var j,l,m,n,p;if(d.image){j=d.image,this._statePriority=d.priority||o;var q,r;for(n=this._statePriority.length-1;n>=0;--n)p=this._statePriority[n],this._addProperty(p),"disabled"!=p&&"up"!=p&&(this._stateFlags[p]=!1),q=d[p],i[p]=q?b(q):i.up,e&&(q&&q.label?(q=q.label,r=i[p].label={},r.font=q.font||g.font,r.color=q.color||g.color,r.stroke=q.hasOwnProperty("stroke")?q.stroke:g.stroke,r.shadow=q.hasOwnProperty("shadow")?q.shadow:g.shadow,r.textBaseline=q.textBaseline||g.textBaseline,r.x=q.x||g.x,r.y=q.y||g.y):i[p].label=g);if(i.up.trim){var s=i.up.trim;l=s.width,m=s.height}else l=i.up.src.width,m=i.up.src.height;i.up||(Debug.error("Button lacks an up state! This is a serious problem! Input data follows:"),Debug.error(d)),i.over||(i.over=i.up),i.down||(i.down=i.up),i.disabled||(i.disabled=i.up),d.offset?(this._offset.x=d.offset.x,this._offset.y=d.offset.y):this._offset.x=this._offset.y=0}else j=d,l=j.width,m=j.height/3,this._statePriority=o,i.disabled=i.up={src:new c(0,0,l,m)},i.over={src:new c(0,m,l,m)},i.down={src:new c(0,2*m,l,m)},g&&(i.up.label=i.over.label=i.down.label=i.disabled.label=g),this._offset.x=this._offset.y=0;this.back=new k(j),this.addChild(this.back),this._width=l,this._height=m,e&&(this.label=new h(e.text||"",i.up.label.font,i.up.label.color),this.addChild(this.label)),this.enabled=f===a?!0:!!f},Object.defineProperty(m,"width",{get:function(){return this._width*this.scaleX},set:function(a){this.scaleX=a/this._width}}),Object.defineProperty(m,"height",{get:function(){return this._height*this.scaleY},set:function(a){this.scaleY=a/this._height}}),m.setText=function(a){if(this.label){this.label.text=a;for(var b,c=0,d=this._statePriority.length;d>c;++c)if(this._stateFlags[this._statePriority[c]]){b=this._stateData[this._statePriority[c]];break}b||(b=this._stateData.up),b=b.label,this.label.x="center"==b.x?.5*(this._width-this.label.getMeasuredWidth())+this._offset.x:b.x+this._offset.x,this.label.y="center"==b.y?.5*this._height+this._offset.y:b.y+this._offset.y}},Object.defineProperty(m,"enabled",{get:function(){return!this._stateFlags.disabled},set:function(a){this._stateFlags.disabled=!a,a?(this.cursor="pointer",this.addEventListener("mousedown",this._downCB),this.addEventListener("mouseover",this._overCB),this.addEventListener("mouseout",this._outCB)):(this.cursor=null,this.removeEventListener("mousedown",this._downCB),this.removeEventListener("mouseover",this._overCB),this.removeEventListener("mouseout",this._outCB),this.removeEventListener("pressup",this._upCB),this.removeEventListener("click",this._clickCB),this._stateFlags.down=this._stateFlags.over=!1),this._updateState()}}),m._addProperty=function(a){n.indexOf(a)>=0||Object.defineProperty(this,a,{get:function(){return this._stateFlags[a]},set:function(b){this._stateFlags[a]=b,this._updateState()}})},m._updateState=function(){if(this.back){for(var a,b=0,c=this._statePriority.length;c>b;++b)if(this._stateFlags[this._statePriority[b]]){a=this._stateData[this._statePriority[b]];break}a||(a=this._stateData.up),this.back.sourceRect=a.src,a.trim?(this.back.x=a.trim.x+this._offset.x,this.back.y=a.trim.y+this._offset.y):(this.back.x=this._offset.x,this.back.y=this._offset.y),this.label&&(a=a.label,this.label.textBaseline=a.textBaseline||"middle",this.label.stroke=a.stroke,this.label.shadow=a.shadow,this.label.font=a.font,this.label.color=a.color||"#000",this.label.x="center"==a.x?.5*(this._width-this.label.getMeasuredWidth())+this._offset.x:a.x+this._offset.x,this.label.y="center"==a.y?.5*this._height+this._offset.y:a.y+this._offset.y)}},m._onMouseDown=function(){this.addEventListener("pressup",this._upCB),this.addEventListener("click",this._clickCB),this._stateFlags.down=!0,this._updateState()},m._onMouseUp=function(){this.removeEventListener("pressup",this._upCB),this.removeEventListener("click",this._clickCB),this._stateFlags.down=!1,this._updateState()},m._onClick=function(){this.dispatchEvent(new i(l.BUTTON_PRESS))},m._onMouseOver=function(){this._stateFlags.over=!0,this._updateState()},m._onMouseOut=function(){this._stateFlags.over=!1,this._updateState()},m.destroy=function(){this.removeAllChildren(),this.removeAllEventListeners(),this._downCB=null,this._upCB=null,this._overCB=null,this._outCB=null,this.back=null,this.label=null,this._statePriority=null,this._stateFlags=null,this._stateData=null},l.generateDefaultStates=function(b,d,h){var i=b.width,j=b.height/3,l=document.createElement("canvas"),m=i,n=b.height;d&&(n+=j),h&&(Debug.log(h.rgba),m+=2*h.size,n+=j+2*h.size,h.rgba&&(h.red=h.rgba[0],h.green=h.rgba[1],h.blue=h.rgba[2],h.rgba[3]&&(h.alpha=h.rgba[3]))),l.width=m,l.height=n;var p=l.getContext("2d");p.drawImage(b,0,0);var q={image:l,up:{src:new c(0,0,i,j)},over:{src:new c(0,j,i,j)},down:{src:new c(0,2*j,i,j)}},r=new k(b);r.sourceRect=q.up.src;var s=b.height;if(d){p.save(),p.translate(0,s);var t=new e;d.saturation!==a&&t.adjustSaturation(d.saturation),d.brightness!==a&&t.adjustBrightness(2.55*d.brightness),d.contrast!==a&&t.adjustContrast(d.contrast),r.filters=[new g(t)],r.cache(0,0,q.up.src.width,q.up.src.height),r.draw(p),q.disabled={src:new c(0,s,0|i,0|j)},s+=j,p.restore()}if(h){p.save();var u=i+2*h.size,v=j+2*h.size;r.filters=[new f(0,0,0,1,h.red,h.green,h.blue,h.alpha!==a?-255+h.alpha:0)],r.scaleX=u/i,r.scaleY=v/j,r.x=0,r.y=s,r.cache(0,0,u,v),r.updateContext(p),r.draw(p),p.restore(),r.scaleX=r.scaleY=1,r.x=h.size,r.y=s+h.size,r.filters=null,r.uncache(),r.updateContext(p),r.draw(p);var w=new c(h.size,h.size,u,v);q.up.trim=w,q.over.trim=w,q.down.trim=w,q.disabled&&(q.disabled.trim=w),q.highlighted={src:new c(0,s,0|u,0|v)},q.priority=o.slice(),q.priority.unshift("highlighted"),q.offset={x:-h.size,y:-h.size}}return q},namespace("springroll").Button=l,namespace("springroll.createjs").Button=l}(),function(){var a,b=include("springroll.createjs.Button"),c=function(c,d,e,f,g){a=include("springroll.Sound"),b.call(this,c,d,e),this.clickAlias=f||"ButtonClick",this.overAlias=g||"ButtonRollover",this._audioEnabled=!0,this._onRollover=this._onRollover.bind(this),this._onButtonPress=this._onButtonPress.bind(this),this.addEventListener("rollover",this._onRollover),this.addEventListener(b.BUTTON_PRESS,this._onButtonPress)},d=b.prototype,e=c.prototype=Object.create(d);e._onButtonPress=function(){this.clickAlias&&this._audioEnabled&&a.instance.play(this.clickAlias)},e._onRollover=function(){this.overAlias&&this.enabled&&this._audioEnabled&&a.instance.play(this.overAlias)},Object.defineProperty(e,"audioEnabled",{get:function(){return this._audioEnabled},set:function(a){this._audioEnabled=a}}),e.destroy=function(){this.removeEventListener("rollover",this._onRollover),this.removeEventListener(b.BUTTON_PRESS,this._onButtonPress),this.audioEnabled=!1,d.destroy.apply(this)},namespace("springroll").SoundButton=c,namespace("springroll.createjs").SoundButton=c}(),function(){var a=function(a,b){this.event=a,this.loops=b||0};namespace("springroll").CharacterClip=a,namespace("springroll.createjs").CharacterClip=a}(),function(){var a=include("springroll.createjs.Animator"),b=function(){this._animationStack=[],this._currentAnimation=null,this._loops=0,this._interruptable=!0,this._allowFrameDropping=!1,this._character=null,this._callback=null,this._destroyed=!1},c=b.prototype;c.setCharacter=function(a){this.clear(),this._character=a,this._character&&(Debug.assert(this._character instanceof createjs.MovieClip,"character must subclass MovieClip"),this._character.stop())},c.gotoFrameAndStop=function(b){Debug.assert(this._character,"gotoFrameAndStop() requires a character!"),a.stop(this._character),this._animationStack.length=0,this._character.gotoAndStop(b)},c.playClips=function(b,c,d,e,f){if(c=c||null,d=d||!0,e=e||!0,f=f||!0,Debug.assert(this._character,"playClips requires a character!"),this._interruptable){a.stop(this._character),this._interruptable=d,this._callback&&!e&&this._callback(!0),this._callback=c,this._animationStack.length=0;for(var g in b)this._animationStack.push(b[g]);this._allowFrameDropping=f,this.startNext()}},c.startNext=function(){if(this._loops=0,this._animationStack.length>0)this._currentAnimation=this._animationStack.shift(),a.play(this._character,this._currentAnimation.event,this._animationComplete.bind(this),[this],this._allowFrameDropping);else if(this._callback){this._interruptable=!0;var b=this._callback;this._callback=null,b(!1)}},c._animationComplete=function(){this._loops++,0===this._currentAnimation.loops||this._loops<this._currentAnimation.loops?a.play(this._character,this._currentAnimation.event,this._animationComplete.bind(this),null,this._allowFrameDropping):this._currentAnimation.loops==this._loops&&this.startNext()},c.clear=function(){this._character&&a.stop(this._character),this._currentAnimation=null,this._interruptable=!0,this._callback=null,this._animationStack.length=0,this._loops=0},c.destroy=function(){this._destroyed||(this._destroyed=!0,this.clear(),this._character=null,this._animationStack=null)},namespace("springroll").CharacterController=b,namespace("springroll.createjs").CharacterController=b}(),function(){var a=function(a){this.obj=a,this.mouseDownObjPos={x:0,y:0},this.dragOffset=new createjs.Point,this.mouseDownStagePos={x:0,y:0}};namespace("springroll").DragData=a,namespace("springroll.createjs").DragData=a}(),function(){var a,b=include("springroll.createjs.DragData"),c=function(b,c,d){a||(a=include("createjs.Tween",!1)),this.draggedObj=null,this.dragStartThreshold=20,this.mouseDownStagePos={x:0,y:0},this.mouseDownObjPos={x:0,y:0},this.allowStickyClick=!0,this.isTouchMove=!1,this.isHeldDrag=!1,this.isStickyClick=!1,this.snapSettings=null,this._theStage=b,this._dragOffset=null,this._dragStartCallback=c,this._dragEndCallback=d,this._triggerHeldDrag=this._triggerHeldDrag.bind(this),this._triggerStickyClick=this._triggerStickyClick.bind(this),this._stopDrag=this._stopDrag.bind(this),this._updateObjPosition=this._updateObjPosition.bind(this),this._draggableObjects=[],this._helperPoint=null,this._multitouch=!1},d=c.prototype={};Object.defineProperty(d,"multitouch",{get:function(){return this._multitouch},set:function(a){if(this.draggedObj)if(this._multitouch)for(var b in this.draggedObj)this._stopDrag(b,!0);else this._stopDrag(null,!0);this._multitouch=!!a,this.draggedObj=a?{}:null}}),d.startDrag=function(a,b){this._objMouseDown(b,a)},d._objMouseDown=function(c,d){if(!(!this._multitouch&&this.draggedObj||this._multitouch&&!c)){var e,f,g,h;this._multitouch?(e=new b(d),this.draggedObj[c.pointerID]=e,f=e.mouseDownObjPos,g=e.mouseDownStagePos,h=e.dragOffset):(this.draggedObj=d,f=this.mouseDownObjPos,g=this.mouseDownStagePos,h=this._dragOffset=new createjs.Point),a&&a.removeTweens(d),c&&(h=d.parent.globalToLocal(c.stageX,c.stageY,h),h.x-=d.x,h.y-=d.y),f.x=d.x,f.y=d.y,c?(this._theStage._getPointerData(c.pointerID).target=d,this.allowStickyClick&&"touchstart"!=c.nativeEvent.type?(g.x=c.stageX,g.y=c.stageY,d.addEventListener("pressmove",this._triggerHeldDrag),d.addEventListener("pressup",this._triggerStickyClick)):(this.isTouchMove="touchstart"==c.nativeEvent.type,this.isHeldDrag=!0,this._startDrag(c))):(this.isHeldDrag=!0,this._startDrag())}},d._triggerStickyClick=function(a){this.isStickyClick=!0;var b=this._multitouch?this.draggedObj[a.pointerID].obj:this.draggedObj;b.removeEventListener("pressmove",this._triggerHeldDrag),b.removeEventListener("pressup",this._triggerStickyClick),this._startDrag(a)},d._triggerHeldDrag=function(a){this.isHeldMove=!0;var b,c;this._multitouch?(c=this.draggedObj[a.pointerID].obj,b=this.draggedObj[a.pointerID].mouseDownStagePos):(c=this.draggedObj,b=this.mouseDownStagePos);var d=a.stageX-b.x,e=a.stageY-b.y;d*d+e*e>=this.dragStartThreshold*this.dragStartThreshold&&(this.isHeldDrag=!0,c.removeEventListener("pressmove",this._triggerHeldDrag),c.removeEventListener("pressup",this._triggerStickyClick),this._startDrag(a))},d._startDrag=function(a){var b=this._theStage;b.addEventListener("stagemousemove",this._updateObjPosition),b.addEventListener("stagemouseup",this._stopDrag),this._dragStartCallback(this._multitouch?this.draggedObj[a.pointerID].obj:this.draggedObj)},d.stopDrag=function(a,b){var c=null;if(this._multitouch&&b)for(var d in this.draggedObj)if(this.draggedObj[d].obj==b){c=d;break}this._stopDrag(c,a===!0)},d._stopDrag=function(a,b){var c,d;if(this._multitouch){if(!a){for(d in this.draggedObj)this._stopDrag(d,b);return}d=a,a instanceof createjs.MouseEvent&&(d=a.pointerID);var e=this.draggedObj[d];if(!e)return;c=e.obj,this.mouseDownObjPos.x=e.mouseDownObjPos.x,this.mouseDownObjPos.y=e.mouseDownObjPos.y,delete this.draggedObj[d]}else c=this.draggedObj,this.draggedObj=null;if(c){c.removeEventListener("pressmove",this._triggerHeldDrag),c.removeEventListener("pressup",this._triggerStickyClick);var f=!this._multitouch;if(this._multitouch){var g=!1;for(d in this.draggedObj){g=!0;break}f=!g}f&&(this._theStage.removeEventListener("stagemousemove",this._updateObjPosition),this._theStage.removeEventListener("stagemouseup",this._stopDrag)),this.isTouchMove=!1,this.isStickyClick=!1,this.isHeldMove=!1,b!==!1&&this._dragEndCallback(c)}},d._updateObjPosition=function(a){if(this.isTouchMove||this._theStage.mouseInBounds){var b,c;if(this._multitouch){var d=this.draggedObj[a.pointerID];b=d.obj,c=d.dragOffset}else b=this.draggedObj,c=this._dragOffset;var e=b.parent.globalToLocal(a.stageX,a.stageY,this._helperPoint),g=b._dragBounds;if(g?(b.x=f(e.x-c.x,g.x,g.right),b.y=f(e.y-c.y,g.y,g.bottom)):(b.x=e.x-c.x,b.y=e.y-c.y),this.snapSettings)switch(this.snapSettings.mode){case"points":this._handlePointSnap(e,c,b);break;case"grid":break;case"line":}}},d._handlePointSnap=function(a,b,c){for(var d,f,g=this.snapSettings,h=g.dist*g.dist,i=g.points,j=a.x-b.x,k=a.y-b.y,l=-1,m=null,n=i.length-1;n>=0;--n)d=i[n],f=e(j,k,d.x,d.y),h>=f&&(l>f||-1==l)&&(l=f,m=d);m&&(c.x=m.x,c.y=m.y)};var e=function(a,b,c,d){var e=a-c,f=b-d;return e*e+f*f},f=function(a,b,c){return b>a?b:a>c?c:a},g=function(){this.addEventListener("mousedown",this._onMouseDownListener),this.cursor="pointer"},h=function(){this.removeEventListener("mousedown",this._onMouseDownListener),this.cursor=null},i=function(a){this._dragMan._objMouseDown(a,this)};d.addObject=function(a,b){b&&(b.right=b.x+b.width,b.bottom=b.y+b.height),a._dragBounds=b,this._draggableObjects.indexOf(a)>=0||(a.enableDrag=g,a.disableDrag=h,a._onMouseDownListener=i.bind(a),a._dragMan=this,this._draggableObjects.push(a))},d.removeObject=function(a){a.disableDrag(),delete a.enableDrag,delete a.disableDrag,delete a._onMouseDownListener,delete a._dragMan,delete a._dragBounds;var b=this._draggableObjects.indexOf(a);b>=0&&this._draggableObjects.splice(b,1)},d.destroy=function(){this.stopDrag(!1),this.draggedObj=null,this._updateObjPosition=null,this._dragStartCallback=null,this._dragEndCallback=null,this._triggerHeldDrag=null,this._triggerStickyClick=null,this._stopDrag=null,this._theStage=null;for(var a,b=this._draggableObjects.length-1;b>=0;--b)a=this._draggableObjects[b],a.disableDrag(),delete a.enableDrag,delete a.disableDrag,delete a._onMouseDownListener,delete a._dragMan,delete a._dragBounds;this._draggableObjects=null,this._helperPoint=null},namespace("springroll").DragManager=c,namespace("springroll.createjs").DragManager=c}(),function(){var a,b,c,d,e,f,g=include("createjs.Container"),h=function(h){if(b||(b=include("springroll.Application"),c=include("springroll.LoadTask"),d=include("springroll.TaskManager"),e=include("springroll.Sound"),f=include("springroll.ListTask"),a=include("createjs.BitmapUtils")),g.call(this),!h)throw new Error("need options to create Cutscene");this.isReady=!1,this.framerate=0,this.display="string"==typeof h.display?b.instance.getDisplay(h.display):h.display,this.config=h.configUrl,this.imageScale=h.imageScale||1,this.pathReplaceTarg=h.pathReplaceTarg||null,this.pathReplaceVal=h.pathReplaceVal||null,this._taskMan=null,this._elapsedTime=0,this._clip=null,this._currentAudioInstance=null,this._animFinished=!1,this._audioFinished=!1,this._captionsObj=h.captions||null,this._captionsObj&&(this._captionsObj.selfUpdate=!1),this._loadCallback=h.loadCallback||null,this._endCallback=null,this.update=this.update.bind(this),this._audioCallback=this._audioCallback.bind(this),this.resize=this.resize.bind(this),this.setup()},i=h.prototype=new g;i.setup=function(){this.display.stage.addChild(this),this._taskMan=new d([new c("config",this.config,this.onConfigLoaded.bind(this))]),this._taskMan.on(d.ALL_TASKS_DONE,this.onLoadComplete.bind(this)),this._taskMan.startAll()},i.onConfigLoaded=function(a){this.config=a.content,this.framerate=this.config.settings.fps;var b=[];b.push({id:"clip",src:this.config.settings.clip});var c;for(var d in this.config.images)c=this.pathReplaceTarg?this.config.images[d].replace(this.pathReplaceTarg,this.pathReplaceVal):this.config.images[d],b.push({id:d,src:c});this._taskMan.addTask(new f("art",b,this.onArtLoaded.bind(this))),this._taskMan.addTask(e.instance.createPreloadTask("audio",[config.settings.audioAlias],this.onAudioLoaded))},i.onAudioLoaded=function(){},i.onArtLoaded=function(b){window.images||(window.images={});var c,d,e,f,g={},h={};for(c in b)if(d=b[c].content,0===c.indexOf("atlasData_"))g[c.replace("atlasData_","")]=d;else if(0===c.indexOf("atlasImage_"))h[c.replace("atlasImage_","")]=d;else if("clip"==c){if(1!=this.imageScale){e=this.imageScale;for(f in this.config.images)a.replaceWithScaledBitmap(f,e)}}else images[c]=d;for(c in g)g[c]&&h[c]&&a.loadSpriteSheet(g[c].frames,h[c],this.imageScale)},i.onLoadComplete=function(){this._taskMan.off(),this._taskMan.destroy(),this._taskMan=null;var a=this._clip=new lib[this.config.settings.clipClass];this._clip.timeline&&1!=this._clip.timeline.duration||(a=this._clip.getChildAt(0)),a.mouseEnabled=!1,a.framerate=this.framerate,a.advanceDuringTicks=!1,a.gotoAndPlay(0),a.loop=!1,this.addChild(this._clip),this.resize(this.display.width,this.display.height),b.instance.on("resize",this.resize),this.isReady=!0,this._loadCallback&&(this._loadCallback(),this._loadCallback=null)},i.resize=function(a,b){if(this._clip){var c=b/this.config.settings.designedHeight;this._clip.scaleX=this._clip.scaleY=c,this.x=.5*(a-this.config.settings.designedWidth*c),this.isReady&&this.display.paused&&(this.display.paused=!1,this.display.render(0),this.display.paused=!0)}},i.start=function(a){this._endCallback=a,this._timeElapsed=0,this._animFinished=!1,this._audioFinished=!1;var c=this.config.settings.audioAlias;this._currentAudioInstance=e.instance.play(c,this._audioCallback),this._captionsObj&&this._captionsObj.play(c),b.instance.on("update",this.update)},i._audioCallback=function(){this._audioFinished=!0,this._currentAudioInstance=null,this._animFinished&&this.stop(!0)},i.update=function(a){if(!this._animFinished){if(this._currentAudioInstance){var b=.001*this._currentAudioInstance.position;0===this._timeElapsed&&b>2*a||this._currentAudioInstance&&(this._timeElapsed=.001*this._currentAudioInstance.position)}else this._timeElapsed+=.001*a;this._captionsObj&&this._captionsObj.seek(1e3*this._timeElapsed);var c=this._clip.timeline&&1!=this._clip.timeline.duration?this._clip:this._clip.getChildAt(0);c.elapsedTime=this._timeElapsed,c.currentFrame==c.timeline.duration&&(this._animFinished=!0,this._audioFinished&&this.stop(!0))}},i.stop=function(a){b.instance.off("update",this.update),this._currentAudioInstance&&e.instance.stop(this.config.settings.audioAlias),this._captionsObj.stop(),a&&this._endCallback&&(this._endCallback(),this._endCallback=null)},i.destroy=function(){b.instance.off("resize",this.resize),this.removeAllChildren(!0),e.instance.unload([this.config.settings.audioAlias]),this.config=null,this._taskMan&&(this._taskMan.off(),this._taskMan.destroy(),this._taskMan=null),this._currentAudioInstance=null,this._loadCallback=null,this._endCallback=null,this._clip=null,this._captionsObj=null,this.parent&&this.parent.removeChild(this),this.display=null},namespace("springroll").Cutscene=h,namespace("springroll.createjs").Cutscene=h}();}();