/*! SpringRoll 0.2.0 */
!function(){"use strict";!function(){var a=(include("springroll.Debug",!1),include("springroll.Animator")),b=include("createjs.BitmapMovieClip"),c=include("springroll.easeljs.DwellTimer",!1),d=include("springroll.ListTask"),e=include("springroll.SoundButton"),f=include("createjs.TextureAtlas"),g={};g.createSoundButton=function(a,b){b=b||{},!images[a];var d=new e(images[a],b.label,b.enabled,b.clickAlias,b.overAlias),f=a.charAt(0).toLowerCase()+a.slice(1),g=this.config&&this.config.sprites?this.config.sprites[f]:null,h=b.position||(g?g:{x:0,y:0});return d.x=b.x||h.x,d.y=b.x||h.y,d.name=a,c&&c.create(d),d},g.clone=function(a,c,d){var e=new b;return e.copyFrom(a),e.gotoAndStop(0),e.x=c||0,e.y=d||0,e},g.addSpritesRequest=function(a,b,c,e){var f=window.IS_SMALL_SCREEN||b.game.display.width<=350;e=e||"assets/sprites/";for(var h,i,j,k=a.length-1;k>=0;k--)h=i=null,i=a[k],b.game.isMobile&&i.mobile===!1||(h="string"==typeof i?i:i.id,j=e+(f&&i.hasHalf?"half/":"full/"),c.push(new d(h,g.generateManifest(h,j),g.onSpriteLoaded.bind(b))))},g.generateManifest=function(a,b){return void 0===b&&(b="assets/sprites/"),[{id:"animData",src:b+a+".json"},{id:"atlasData",src:b+a+"Sprite.json"},{id:"atlasImage",src:b+a+"Sprite.png"}]},g.extractLabels=function(a){for(var b=a._labels,c=[],d=null,e=b.length-1;e>=0;e--)d=b[e].label,-1===d.indexOf("_loop")&&-1===d.indexOf("_stop")&&c.push(d);return 0===c.length,c},g.cloneSpritePerLabel=function(a){for(var b=g.extractLabels(a),c={},d=null,e=null,f=b.length-1;f>=0;--f)d=b[f],e=g.clone(a),e.label=d,c[d]=e;return c},g.onSpriteLoaded=function(a,c){var d=new b(new f(a.atlasImage.content,a.atlasData.content),a.animData.content),e=this.game.config.sprites;e&&e[c.id]&&(d.x=e[c.id].x,d.y=e[c.id].y),d.gotoAndStop(0);var g=c.id.charAt(0).toLowerCase()+c.id.slice(1);this[g]=d},g.addClonesTo=function(a,b,c){var d;for(var e in a)d=a[e],g.addCloneTo(d,b,c)},g.addCloneTo=function(b,c,d){d?a.play(b,b.label):b.gotoAndStop(b.label?b.label:0),c.addChild(b)},g.calculateAnimationLengths=function(a){for(var b={},c=a._labels,d=null,e={},f=null,g=c.length-1;g>=0;g--)d=c[g],f=d.label,b[f]=d.position,-1==f.indexOf("_stop")&&-1==f.indexOf("_loop")&&(e[f]=1);var h=null;for(var i in e)h=b[i],e[i]=b[i+"_stop"]-h||b[i+"_loop"]-h||0;return e},namespace("springroll.easeljs").SpriteUtils=g}(),function(){var a,b,c=include("createjs.Container"),d=function(){b||(b=include("springroll.Application"),a=include("springroll.easeljs.AssetUtils")),c.call(this),this.game=b.instance,this.config=this.game.config,this.background=null},e=extend(d,c);e.setup=function(){},e.teardown=function(){},e.destroy=function(){this.game=null,this.config=null,this.background=null,this.removeAllChildren()},namespace("springroll.createjs").BasePanel=d}(),function(a){var b,c,d,e,f,g=include("springroll.BaseState"),h=(include("springroll.Debug",!1),function(a,h,i){if(b||(b=include("springroll.Application"),d=include("springroll.easeljs.BasePanel"),c=include("springroll.ListTask"),e=include("springroll.TaskManager"),f=include("springroll.UIScaler")),!(a instanceof d))throw"springroll.BaseState requires the panel be a springroll.easeljs.BasePanel";g.call(this,a,h,i),this.game=b.instance,this.player=this.game.player,this.config=this.game.config,this.manifest=null,this.assetsLoaded=!1,this.scaler=null,this.resizeOnReload=!0}),i=g.prototype,j=extend(h,g);j.enter=function(){this.loadingStart(),this.assetsLoaded=!1;var a=[];this.manifest.length&&a.push(new c("manifests",this.manifest,l)),this.addTasks(a),a.length?e.process(a,k.bind(this)):k.call(this)},j.addTasks=function(){},j.onAssetsLoaded=function(){};var k=function(){this.assetsLoaded=!0,this.panel.setup();var b=this.config.scaling[this.stateId];b!==a&&(!this.scaler||this.resizeOnReload)&&(this.scaler=new f(this.panel,this.config.designedSettings,b,!1));var c=this.panel.background;c&&c.image&&this.scaler.addBackground(c),this.scaler.enabled=!0,this.onAssetsLoaded(),this.loadingDone()},l=function(a){for(var b in a)-1===a[b].url.indexOf(".js")&&(images[b]=a[b].content)};j.exit=function(){if(this.assetsLoaded){if(this.panel.teardown(),this.scaler&&(this.scaler.enabled=!1,this.scaler.removeBackground(this.panel.background),this.resizeOnReload&&(this.scaler.destroy(),this.scaler=null)),this.manifest)for(var a,b=this.manifest,c=b.length,d=0;c>d;d++)a=b[d].id,delete images[a];this.assetsLoaded=!1}},j.destroy=function(){this.manifest=null,this.game=null,this.config=null,this.player=null,this.panel.destroy(),this.scaler&&(this.scaler.destroy(),this.scaler=null),i.destroy.apply(this)},namespace("springroll.createjs").BaseState=h,namespace("springroll.createjs").ManifestState=h}(),function(a){var b,c,d,e,f=include("springroll.TrackerGame"),g=include("springroll.easeljs.EaselJSDisplay"),h=function(a){c=include("createjs.Text"),d=include("springroll.LoadTask"),e=include("springroll.easeljs.BaseState"),b=include("springroll.easeljs.Animator"),f.call(this,Object.merge({manifestsPath:"assets/config/manifests.json",display:g,displayOptions:{clearView:!0},fps:30},a)),this._manifests={},this.offClickParams=[],null!==this.options.manifestsPath&&(l=l.bind(this),this.on("loading",l)),this.on("statesReady",m.bind(this)),o=o.bind(this),this.display&&this.display.stage&&this.display.stage.addEventListener("stagemousedown",o)},i=f.prototype,j=extend(h,f),k="manifestLoaded",l=function(a){this.off("loading",l),a.push(new d("manifests",this.options.manifestsPath,n.bind(this)))},m=function(){var a=this.display.stage;this.captions.textField instanceof c&&a.addChild(this.captions.textField),a.addChild(this.transition)},n=function(a,b,c){var d,e=this._manifests,f=a.content;for(var g in f)d=g.toString().toLowerCase(),e[d]||(e[d]=f[g]);this.trigger(k,c)};j.addState=function(b,c){if(!(c instanceof e))throw"springroll.easeljs.Game requires states to extend springroll.easeljs.BaseState";i.addState.call(this,b,c);var d=[],f=this.config.manifests;f!==a&&f[b]!==a&&(d=f[b]),this._manifests[b]!==a&&(d=d.concat(this._manifests[b])),c.manifest=d};var o=function(a){if(this.tracker){var b=a.target,c=b._getObjectsUnderPoint(a.stageX,a.stageY,null,!0);if(!c){var d=this.offClickParams.slice(0);d.unshift(this.normalizePosition(a.stageX,a.stageY)),this.tracker.offClick.apply(this,d)}}};j.destroy=function(){this.display&&this.display.stage&&this.display.stage.removeEventListener("stagemousedown",o),this.offClickParams=null,this._manifests=null,i.destroy.call(this)},Object.defineProperty(j,"manifests",{get:function(){return this._manifests}}),namespace("springroll.easeljs").TrackerGame=h}();}();