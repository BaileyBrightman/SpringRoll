/*! SpringRoll 0.0.6 */
!function(){"use strict";!function(){var a,b=function(b,c,d,e){a||(a=include("springroll.UIScaler")),this._item=b,this._settings=c,this._designedScreen=d,this._adapter=e;var f=e.getScale(b),g=e.getPosition(b);switch(this.origScaleX=f.x||1,this.origScaleY=f.y||1,this.origWidth=b.width||0,this.origBounds=e.getLocalBounds(b),this.origMarginHori=0,this.origMarginVert=0,c.vertAlign){case a.ALIGN_TOP:this.origMarginVert=g.y+this.origBounds.y*f.y;break;case a.ALIGN_CENTER:this.origMarginVert=.5*d.height-g.y;break;case a.ALIGN_BOTTOM:this.origMarginVert=d.height-(g.y+this.origBounds.bottom*f.y)}switch(c.horiAlign){case a.ALIGN_LEFT:this.origMarginHori=g.x+this.origBounds.x*f.x;break;case a.ALIGN_CENTER:this.origMarginHori=.5*d.width-g.x;break;case a.ALIGN_RIGHT:this.origMarginHori=d.width-(g.x+this.origBounds.right*f.x)}},c=b.prototype={};c.resize=function(b,c){var d=this._adapter,e=c/this._designedScreen.height,f=(b-this._designedScreen.width*e)/2,g=e;this._settings.minScale&&g<this._settings.minScale?g=this._settings.minScale:this._settings.maxScale&&g>this._settings.maxScale&&(g=this._settings.maxScale),d.setScale(this._item,this.origScaleX*g,"x"),d.setScale(this._item,this.origScaleY*g,"y");var h,i=null,j=null;switch(h=this.origMarginVert*e,this._settings.vertAlign){case a.ALIGN_TOP:j=h-this.origBounds.y*this.origScaleY*g;break;case a.ALIGN_CENTER:j=.5*c-h;break;case a.ALIGN_BOTTOM:j=c-h-this.origBounds.bottom*this.origScaleY*g}switch(null!==j&&d.setPosition(this._item,j,"y"),h=this.origMarginHori*e,this._settings.horiAlign){case a.ALIGN_LEFT:i=this._settings.titleSafe?f+h-this.origBounds.x*this.origScaleX*g:h-this.origBounds.x*this.origScaleX*g;break;case a.ALIGN_CENTER:i=this._settings.centeredHorizontally?.5*(b-this._item.width):.5*b-h;break;case a.ALIGN_RIGHT:i=this._settings.titleSafe?b-f-h-this.origBounds.right*this.origScaleX*g:b-h-this.origBounds.right*this.origScaleX*g}null!==i&&d.setPosition(this._item,i,"x")},c.destroy=function(){this._adapter=null,this.origBounds=null,this._item=null,this._settings=null,this._designedScreen=null},namespace("springroll").UIElement=b}(),function(){var a=function(){this.vertAlign=null,this.horiAlign=null,this.titleSafe=!1,this.maxScale=1,this.minScale=1,this.centeredHorizontally=!1};namespace("springroll").UIElementSettings=a}(),function(a){var b={},c=Math.PI/180;b.initItem=function(d,e,f){f||(f=springroll.UIScaler._getAdapter()),e.x!==a&&f.setPosition(d,e.x,"x"),e.y!==a&&f.setPosition(d,e.y,"y");var g=e.scale,h=f.getScale(d);g&&(f.setScale(d,g.x*h.x,"x"),f.setScale(d,g.y*h.y,"y")),g=e.pivot,g&&f.setPivot(d,g),e.rotation!==a&&(d.rotation=e.rotation,f.useRadians&&(d.rotation*=c)),e.hitArea&&f.setHitArea(d,b.generateHitArea(e.hitArea,1,f))},b.generateHitArea=function(a,b,c){if(b||(b=1),Array.isArray(a)){if(1==b)return new c.Polygon(a);for(var d=[],e=0,f=a.length;f>e;++e)d.push(new c.Point(a[e].x*b,a[e].y*b));return new c.Polygon(d)}return"rect"!=a.type&&a.type?"ellipse"==a.type?new c.Ellipse((a.x-.5*a.w)*b,(a.y-.5*a.h)*b,a.w*b,a.h*b):"circle"==a.type?new c.Circle(a.x*b,a.y*b,a.r*b):"sector"==a.type?new c.Sector(a.x*b,a.y*b,a.r*b,a.start,a.end):null:new c.Rectangle(a.x*b,a.y*b,a.w*b,a.h*b)},namespace("springroll").Positioner=b}(),function(a){var b=include("springroll.UIElementSettings"),c=include("springroll.UIElement"),d=include("springroll.Positioner"),e=include("springroll.Application"),f=function(b,c,d,g,h){if(this._parent=b,this._items=[],!c||!c.width||!c.height)throw"Invalid design settings";this._designedSize=c,c.maxWidth&&(e.instance.options.maxAspectRatio=c.maxWidth/c.height),this._scale=1,this._adapter=f._getAdapter(h),this._backgrounds=[],d&&this.addItems(d),this._resize=this._resize.bind(this),this.enabled=g!==a?!!g:!0},g=f.prototype={};f.ALIGN_TOP="top",f.ALIGN_BOTTOM="bottom",f.ALIGN_LEFT="left",f.ALIGN_RIGHT="right",f.ALIGN_CENTER="center",f._getAdapter=function(b){if(b===a&&(b=e.instance.display),!b.adapter)throw"UIScaler incompatible display";return b.adapter},Object.defineProperty(g,"scale",{get:function(){return this._scale}}),Object.defineProperty(g,"enabled",{get:function(){return this._enabled},set:function(a){this._enabled=a;var b=e.instance;b.off("resize",this._resize),a&&(b.on("resize",this._resize),b.triggerResize())}}),g.addItems=function(a){var b,c;for(c in a){if(b=a[c],"object"!=typeof b)throw"Scaler settings must be a plain object "+b;this._parent[c]&&this.addItem(this._parent[c],b)}return this},g.addItem=function(a,e){var g=e.align||f.ALIGN_CENTER;switch(g){case f.ALIGN_CENTER:g=g+"-"+g;break;case f.ALIGN_LEFT:case f.ALIGN_RIGHT:g=f.ALIGN_CENTER+"-"+g;break;case f.ALIGN_TOP:case f.ALIGN_BOTTOM:g=g+"-"+f.ALIGN_CENTER}if(!/^(center|top|bottom)\-(left|right|center)$/.test(g))throw"Item align '"+g+"' is invalid for "+a;d.initItem(a,e,this._adapter),g=g.split("-");var h=new b;return h.vertAlign=g[0],h.horiAlign=g[1],h.titleSafe=!!e.titleSafe,h.maxScale=e.maxScale||0/0,h.minScale=e.minScale||0/0,h.centeredHorizontally=!!e.centeredHorizontally,this._items.push(new c(a,h,this._designedSize,this._adapter)),this},g.addBackground=function(a){if(this._backgrounds.indexOf(a)>-1)throw"Background alread added to UIScaler";return this._backgrounds.push(a),this},g.removeBackground=function(a){for(var b=0;b<this._backgrounds.length;b++)if(a===this._backgrounds[b])return this._backgrounds.splice(b,1),this;return this},g._resize=function(a,b){this._scale=b/this._designedSize.height;var c,d=this._items.length;if(d>0)for(c=0;d>c;++c)this._items[c].resize(a,b);if(d=this._backgrounds.length,d>0){var e,f,g;for(c=0;d>c;c++)e=this._backgrounds[c],f=this._adapter.getBitmapSize(e),g=b/f.h,this._adapter.setScale(e,g),this._adapter.setPosition(e,.5*(a-f.w*g),"x")}},g.destroy=function(){if(this.enabled=!1,this._items.length>0)for(var a=0,b=this._items.length;b>a;++a)this._items[a].destroy();this._backgrounds=null,this._adapter=null,this._parent=null,this._designedSize=null,this._items=null},namespace("springroll").UIScaler=f}();}();