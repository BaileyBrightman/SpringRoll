/*! SpringRoll 0.2.0 */
!function(){"use strict";!function(a){var b=(include("springroll.Debug",!1),{});b.flash=function(){var b=!1;try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");c&&(b=!0)}catch(d){navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==a&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(b=!0)}return b}(),b.webgl=function(){var a=document.createElement("canvas");return"supportsContext"in a?a.supportsContext("webgl")||a.supportsContext("experimental-webgl"):!!window.WebGLRenderingContext}(),b.canvas=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),b.webaudio=function(){return"webkitAudioContext"in window||"AudioContext"in window}(),namespace("springroll").Features=b}(),function(a,b){var c=include("springroll.SavedData"),d=include("springroll.EventDispatcher"),e=include("springroll.Features"),f=include("Bellhop"),g=include("jQuery"),h=function(a,b){d.call(this),b=b||{},this.name="springroll.GameContainer",this.main=g(a),this.dom=this.main[0],this.helpButton=g(b.helpButton).click(t.bind(this)),this.captionsButton=g(b.captionsButton).click(u.bind(this)),this.soundButton=g(b.soundButton).click(v.bind(this)),this.musicButton=g(b.musicButton).click(w.bind(this)),this.sfxButton=g(b.sfxButton).click(y.bind(this)),this.voButton=g(b.voButton).click(x.bind(this)),this.pauseButton=g(b.pauseButton).click(z.bind(this)),this.messenger=null,this.loaded=!1,this.loading=!1,this._captionsStyles=Object.merge({},G,c.read(F)||{}),this._gameBlurred=!1,this._containerBlurred=!1,this._pauseTimer=null,this._isManualPause=!1,this._paused=!1,null===c.read(A)&&(this.captionsMuted=!0),null===c.read(B)&&(this.soundMuted=!1),this._pageVisibility=new springroll.PageVisibility(n.bind(this),o.bind(this))},i=d.prototype,j=extend(h,d);j.open=function(a,b,c){return this.reset(),e.canvas&&(e.webaudio||e.flash)?(this.loading=!0,this.messenger=new f,this.messenger.connect(this.dom),this.messenger.on({trackEvent:r.bind(this),progressEvent:s.bind(this),loadDone:k.bind(this),helpEnabled:l.bind(this),endGame:q.bind(this),gameFocus:m.bind(this)}),this.main.addClass("loading").prop("src",a).prop("width",window.innerWidth).prop("height",window.innerHeight),b&&this.messenger.send("singlePlay",c),void this.trigger("open")):void this.trigger("unsupported")};var k=function(){this.loading=!1,this.loaded=!0,this.main.removeClass("loading"),this.captionsButton.removeClass("disabled"),this.soundButton.removeClass("disabled"),this.sfxButton.removeClass("disabled"),this.voButton.removeClass("disabled"),this.musicButton.removeClass("disabled"),this.pauseButton.removeClass("disabled"),this.captionsMuted=!!c.read(A),this.soundMuted=!!c.read(B),this.musicMuted=!!c.read(C),this.sfxMuted=!!c.read(E),this.voMuted=!!c.read(D),this.setCaptionsStyles(c.read(F)),this.trigger("opened"),this.paused=this._paused},l=function(a){this.helpEnabled=!!a.data},m=function(a){this._gameBlurred=!a.data,p.call(this)},n=function(a){this._containerBlurred=!1,p.call(this)},o=function(a){this._containerBlurred=this._gameBlurred=!0,p.call(this)},p=function(){this._pauseTimer&&clearTimeout(this._pauseTimer),this._pauseTimer=setTimeout(function(){this._pauseTimer=null,this._isManualPause!==!0&&(this.paused=this._containerBlurred&&this._gameBlurred)}.bind(this),100)},q=function(){this.messenger.destroy(),this.messenger=null,this.reset()},r=function(a){var b=a.data,c=include("GA_obj",!1);c&&c.trackEvent(b.category,b.action,b.label,b.value),c=include("ga",!1),c&&c("send",{hitType:"event",eventCategory:b.category,eventAction:b.action,eventLabel:b.label,eventValue:b.value}),this.trigger("trackEvent",a.data)},s=function(a){this.trigger("progressEvent",a.data)},t=function(){this.paused||this.helpButton.hasClass("disabled")||this.messenger.send("playHelp")},u=function(){this.captionsMuted=!this.captionsMuted};Object.defineProperty(j,"paused",{set:function(a){this._paused=a,this.messenger&&this.messenger.send("pause",a),this.trigger(a?"paused":"resumed"),this.trigger("pause",a),this.pauseButton.removeClass("unpaused paused").addClass(a?"paused":"unpaused"),a&&!this.helpButton.hasClass("disabled")?(this.helpButton.data("paused",!0),this.helpEnabled=!1):this.helpButton.data("paused")&&(this.helpButton.removeData("paused"),this.helpEnabled=!0)},get:function(){return this._paused}});var v=function(){var a=!this.soundMuted;this.soundMuted=a,this.musicMuted=a,this.voMuted=a,this.sfxMuted=a},w=function(){this.musicMuted=!this.musicMuted,this._checkSoundMute()},x=function(){this.voMuted=!this.voMuted,this._checkSoundMute()},y=function(){this.sfxMuted=!this.sfxMuted,this._checkSoundMute()};j._checkSoundMute=function(){this.soundMuted=this.sfxMuted&&this.voMuted&&this.musicMuted};var z=function(){this.paused=!this.paused,this._isManualPause=this.paused},A="captionsMuted",B="soundMuted",C="musicMuted",D="voMuted",E="sfxMuted",F="captionsStyles",G={size:"md",background:"black-semi",color:"white",edge:"none",font:"arial",align:"top"};j._setMuteProp=function(a,b,d){b.removeClass("unmuted muted").addClass(d?"muted":"unmuted"),c.write(a,d),this.messenger&&this.messenger.send(a,d)},j.setCaptionsStyles=function(a,b){"object"==typeof a?Object.merge(this._captionsStyles,a||{}):"string"==typeof a&&(this._captionsStyles[a]=b),a=this._captionsStyles,c.write(F,a),this.messenger&&this.messenger.send(F,a)},j.getCaptionsStyles=function(a){var b=this._captionsStyles;return a?b[a]:b},j.clearCaptionsStyles=function(){this._captionsStyles=Object.merge({},G),this.setCaptionsStyles()},Object.defineProperty(j,A,{set:function(a){this._captionsMuted=a,this._setMuteProp(A,this.captionsButton,a)},get:function(){return this._captionsMuted}}),Object.defineProperty(j,B,{set:function(a){this._soundMuted=a,this._setMuteProp(B,this.soundButton,a)},get:function(){return this._soundMuted}}),Object.defineProperty(j,D,{set:function(a){this._voMuted=a,this._setMuteProp(D,this.voButton,a)},get:function(){return this._voMuted}}),Object.defineProperty(j,C,{set:function(a){this._musicMuted=a,this._setMuteProp(C,this.musicButton,a)},get:function(){return this._musicMuted}}),Object.defineProperty(j,E,{set:function(a){this._sfxMuted=a,this._setMuteProp(E,this.sfxButton,a)},get:function(){return this._sfxMuted}}),Object.defineProperty(j,"helpEnabled",{set:function(a){this._helpEnabled=a,this.helpButton.removeClass("disabled enabled").addClass(a?"enabled":"disabled"),this.trigger("helpEnabled",a)},get:function(){return this._helpEnabled}}),j.reset=function(){this.helpEnabled=!1,H(this.soundButton),H(this.captionsButton),H(this.musicButton),H(this.voButton),H(this.sfxButton),H(this.pauseButton),this.loaded=!1,this.loading=!1,this.paused=!1,this.main.attr("src",""),this.trigger("closed")},j.close=function(){this.loading||this.loaded?(this.trigger("close"),this.messenger.send("close")):this.reset()};var H=function(a){a.removeClass("enabled").addClass("disabled")};j.destroy=function(){this.reset(),this.main=null,this.dom=null,this.soundButton=null,this.pauseButton=null,this.captionsButton=null,this.musicButton=null,this.voButton=null,this.sfxButton=null,this._pageVisibility&&(this._pageVisibility.destroy(),this._pageVisibility=null),this.messenger&&(this.messenger.destroy(),this.messenger=null),i.destroy.call(this)},namespace("springroll").GameContainer=h}(document);}();