/*! SpringRoll 0.3.0 */
!function(){"use strict";!function(a,b){a.merge=function(b,c){"object"!=typeof b&&(b={});for(var d in c)if(c.hasOwnProperty(d)){var e=c[d];if("object"==typeof e&&a.isPlain(e)){b[d]=a.merge(b[d],e);continue}b[d]=e}for(var f=2,g=arguments.length;g>f;f++)a.merge(b,arguments[f]);return b},a.isPlain=function(a){var c;if(!a||"object"!=typeof a||a.nodeType||a===window)return!1;try{if(a.constructor&&!hasOwn.call(a,"constructor")&&!hasOwn.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}if(support.ownLast)for(c in a)return hasOwn.call(a,c);for(c in a);return c===b||hasOwn.call(a,c)},a.prototype.clone||a.defineProperty(a.prototype,"clone",{enumerable:!1,writable:!0,value:function(){var a={},b=this;for(var c in b)a[c]=b[c];return a}})}(Object),function(a){if(!("namespace"in a)){var b=function(b){for(var c=b.split("."),d=a,e="",f=0,g=c.length;g>f;f++)e=c[f],d[e]=d[e]||{},d=d[e];return d};a.namespace=b}}(window),function(a,b){if(!("include"in a)){var c=function(c,d){var e=c.split("."),f=a,g="";d=d!==b?!!d:!0;for(var h=0,i=e.length;i>h;h++){if(g=e[h],!f[g]){if(!d)return null;throw"Unable to include '"+c+"'"}f=f[g]}return f};a.include=c}}(window),function(a){"extend"in a||(a.extend=function(b,c){return"string"==typeof c&&(c=a.include(c)),b.prototype=Object.create(c.prototype),b.prototype})}(window),function(a){function b(a,b){return a._priority-b._priority}function c(a){if(null===a)return"null";var b=typeof a;return"object"===b||"function"===b?Object.prototype.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":b}var d=function(){this._listeners=[],this._destroyed=!1},e=d.prototype;Object.defineProperty(e,"destroyed",{get:function(){return this._destroyed}}),e.trigger=function(b){if(!this._destroyed&&this._listeners[b]!==a){var c,d=this._listeners[b].slice();arguments.length>1&&(c=Array.prototype.slice.call(arguments,1));for(var e=d.length-1;e>=0;--e){var f=d[e];f._eventDispatcherOnce&&(delete f._eventDispatcherOnce,this.off(b,f)),f.apply(this,c)}}},e.once=function(a,b,c){return this.on(a,b,c,!0)},e.on=function(a,d,e,f){if(!this._destroyed){if("object"===c(a))for(var g in a)a.hasOwnProperty(g)&&this.on(g,a[g],e,f);else if("function"===c(d))for(var h,i=a.split(" "),j=null,k=0,l=i.length;l>k;k++)j=i[k],h=this._listeners[j],h||(h=this._listeners[j]=[]),f&&(d._eventDispatcherOnce=!0),d._priority=parseInt(e)||0,-1===h.indexOf(d)&&(h.push(d),h.length>1&&h.sort(b));else if(Array.isArray(d))for(var m=0,n=d.length;n>m;m++)this.on(a,d[m],e,f);return this}},e.off=function(b,c){if(!this._destroyed){if(b===a)this._listeners=[];else if(Array.isArray(c))for(var d=0,e=c.length;e>d;d++)this.off(b,c[d]);else for(var f,g,h=b.split(" "),i=null,j=0,k=h.length;k>j;j++)i=h[j],f=this._listeners[i],f&&(c===a?f.length=0:(g=f.indexOf(c),-1!==g&&f.splice(g,1)));return this}},e.has=function(a,b){if(!a)return!1;var c=this._listeners[a];return c?b?c.indexOf(b)>=0:c.length>0:!1},e.destroy=function(){this._destroyed=!0,this._listeners=null},d.mixIn=function(a,b){a.trigger=e.trigger,a.on=e.on,a.off=e.off,a.has=e.has,a.once=e.once,b&&d.call(a)},namespace("springroll").EventDispatcher=d}(),function(a,b,c){var d=function(a,c){this._onFocus=a,this._onBlur=c,this._enabled=!1,f&&(this._onToggle=function(){b.hidden||b.webkitHidden||b.msHidden||b.mozHidden?this._onBlur():this._onFocus()}.bind(this),this.enabled=!0)},e=d.prototype,f=null;b.hidden!==c?f="visibilitychange":b.mozHidden!==c?f="mozvisibilitychange":b.msHidden!==c?f="msvisibilitychange":b.webkitHidden!==c&&(f="webkitvisibilitychange"),Object.defineProperty(e,"enabled",{get:function(){return this._enabled},set:function(c){c=!!c,this._enabled!=c&&(this._enabled=c,a.removeEventListener("pagehide",this._onBlur),a.removeEventListener("pageshow",this._onFocus),a.removeEventListener("blur",this._onBlur),a.removeEventListener("focus",this._onFocus),a.removeEventListener("visibilitychange",this._onToggle),b.removeEventListener(f,this._onToggle,!1),c&&(b.addEventListener(f,this._onToggle,!1),a.addEventListener("pagehide",this._onBlur),a.addEventListener("pageshow",this._onFocus),a.addEventListener("blur",this._onBlur),a.addEventListener("focus",this._onFocus),a.addEventListener("visibilitychange",this._onToggle,!1)))}}),e.destroy=function(){f&&this._onToggle&&(this.enabled=!1,this._onToggle=null,this._onFocus=null,this._onBlur=null)},namespace("springroll").PageVisibility=d}(window,document),function(a){var b={},c=window.Storage!==a,d=-1;if(c)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST")}catch(e){c=!1}b.remove=function(a){c?(localStorage.removeItem(a),sessionStorage.removeItem(a)):b.write(a,"",d)},b.write=function(a,b,e){if(c)e?sessionStorage.setItem(a,JSON.stringify(b)):localStorage.setItem(a,JSON.stringify(b));else{var f;f=e?e!==d?"":"; expires=Thu, 01 Jan 1970 00:00:00 GMT":"; expires="+new Date(2147483646e3).toGMTString(),document.cookie=a+"="+escape(JSON.stringify(b))+f+"; path=/"}},b.read=function(a){if(c){var d=localStorage.getItem(a)||sessionStorage.getItem(a);return d?JSON.parse(d,b.reviver):null}var e,f,g=a+"=",h=document.cookie.split(";"),i=0;for(i=0,f=h.length;f>i;i++){for(e=h[i];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(g))return JSON.parse(unescape(e.substring(g.length,e.length)),b.reviver)}return null},b.reviver=function(a,b){if(b&&"string"==typeof b.__classname){var c=include(b.__classname,!1);if(c){var d=new c;if(d.fromJSON)return d.fromJSON(b),d}}return b},namespace("springroll").SavedData=b}(),function(a){var b=(include("springroll.Debug",!1),{});b.flash=function(){var b=!1;try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");c&&(b=!0)}catch(d){navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==a&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(b=!0)}return b}(),b.webgl=function(){var a=document.createElement("canvas");return"supportsContext"in a?a.supportsContext("webgl")||a.supportsContext("experimental-webgl"):!!window.WebGLRenderingContext}(),b.canvas=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),b.webaudio=function(){return"webkitAudioContext"in window||"AudioContext"in window}(),b.websockets=function(){return"WebSocket"in window||"MozWebSocket"in window}(),b.geolocation=function(){return"geolocation"in navigator}(),b.webworkers=function(){return!!window.Worker}(),b.touch=function(){return!!("ontouchstart"in window||navigator.msPointerEnabled&&navigator.msMaxTouchPoints>0||navigator.pointerEnabled&&navigator.maxTouchPoints>0)}(),b.test=function(c){var d=c.features,e=c.ui,f=c.sizes;for(var g in d)if(b[g]!==a&&d[g]&&!b[g])return"Browser does not support "+g;if(!e.touch&&b.touch)return"Game does not support touch input";if(!e.mouse&&!b.touch)return"Game does not support mouse input";var h=Math.max(window.screen.width,window.screen.height);return!f.xsmall&&480>h?"Game doesn't support extra small screens":!f.small&&768>h?"Game doesn't support small screens":!f.medium&&992>h?"Game doesn't support medium screens":!f.large&&1200>h?"Game doesn't support large screens":!f.xlarge&&h>=1200?"Game doesn't support extra large screens":null},namespace("springroll").Features=b}(),function(){var a=include("springroll.SavedData"),b=include("springroll.EventDispatcher"),c=include("springroll.PageVisibility"),d=include("springroll.Features"),e=include("Bellhop"),f=include("jQuery"),g=function(d,e){b.call(this),e=e||{},this.name="springroll.Container",this.main=f(d),this.dom=this.main[0],this.helpButton=f(e.helpButton).click(r.bind(this)),this.captionsButton=f(e.captionsButton).click(t.bind(this)),this.soundButton=f(e.soundButton).click(u.bind(this)),this.musicButton=f(e.musicButton).click(v.bind(this)),this.sfxButton=f(e.sfxButton).click(x.bind(this)),this.voButton=f(e.voButton).click(w.bind(this)),this.pauseButton=f(e.pauseButton).click(y.bind(this)),this.client=null,this.release=null,this.loaded=!1,this.loading=!1,this._captionsStyles=Object.merge({},F,a.read(E)||{}),this._appBlurred=!1,this._containerBlurred=!1,this._pauseTimer=null,this._isManualPause=!1,this._paused=!1,null===a.read(z)&&(this.captionsMuted=!0),null===a.read(A)&&(this.soundMuted=!1),this._pageVisibility=new c(l.bind(this),m.bind(this))},h=b.prototype,i=extend(g,b);i._internalOpen=function(a,b){return b=f.extend({singlePlay:!1,playOptions:null},b),this.reset(),d.canvas&&(d.webaudio||d.flash)?(this.loading=!0,this.client=new e,this.client.connect(this.dom),this.client.on({loadDone:j.bind(this),endGame:s.bind(this),focus:k.bind(this),trackEvent:q.bind(this),analyticEvent:q.bind(this),progressEvent:n.bind(this),learningEvent:n.bind(this),helpEnabled:p.bind(this),features:o.bind(this)}),this.main.addClass("loading").prop("src",a).prop("width",window.innerWidth).prop("height",window.innerHeight),b.singlePlay&&this.client.send("singlePlay"),b.playOptions&&this.client.send("playOptions",b.playOptions),void this.trigger("open")):this.trigger("unsupported")},i.open=function(a,b,c){b=b||{},"boolean"==typeof b&&(b={singlePlay:singlePlay,playOptions:c}),this._internalOpen(a,b)},i.openRemote=function(a,b,c){"boolean"==typeof b&&(b={singlePlay:singlePlay,playOptions:c}),b=f.extend({query:"",playOptions:null,singlePlay:!1},b),this.release=null,f.getJSON(a,function(a){if(!a.success)return this.trigger("remoteError",a.error);var c=a.data,e=d.test(c.capabilities);return e?this.trigger("unsupported"):(this.release=c,void this._internalOpen(c.url+b.query,b))}.bind(this)).fail(function(){return this.trigger("remoteFailed")}.bind(this))};var j=function(){this.loading=!1,this.loaded=!0,this.main.removeClass("loading"),this.captionsButton.removeClass("disabled"),this.soundButton.removeClass("disabled"),this.sfxButton.removeClass("disabled"),this.voButton.removeClass("disabled"),this.musicButton.removeClass("disabled"),this.pauseButton.removeClass("disabled"),this.captionsMuted=!!a.read(z),this.soundMuted=!!a.read(A),this.musicMuted=!!a.read(B),this.sfxMuted=!!a.read(D),this.voMuted=!!a.read(C),this.setCaptionsStyles(a.read(E)),this.trigger("opened"),this.paused=this._paused},k=function(a){this._appBlurred=!a.data,this.manageFocus()},l=function(){this._containerBlurred=!1,this.manageFocus()},m=function(){this._containerBlurred=this._appBlurred=!0,this.manageFocus()};i.manageFocus=function(){this._pauseTimer&&clearTimeout(this._pauseTimer),this._pauseTimer=setTimeout(function(){this._pauseTimer=null,this._isManualPause!==!0&&(this.paused=this._containerBlurred&&this._appBlurred)}.bind(this),100)};var n=function(a){this.trigger("learningEvent",a.data)},o=function(a){var b=a.data;this.voButton.hide(),this.musicButton.hide(),this.soundButton.hide(),this.captionsButton.hide(),this.helpButton.hide(),b.vo&&this.voButton.show(),b.music&&this.musicButton.show(),b.sound&&this.soundButton.show(),b.captions&&this.captionsButton.show(),b.hints&&this.helpButton.show(),this.trigger("features",b)},p=function(a){this.helpEnabled=!!a.data},q=function(a){var b=a.data,c=include("GA_obj",!1);c&&c.trackEvent(b.category,b.action,b.label,b.value),c=include("ga",!1),c&&c("send",{hitType:"event",eventCategory:b.category,eventAction:b.action,eventLabel:b.label,eventValue:b.value}),this.trigger("analyticEvent",a.data)},r=function(){this.paused||this.helpButton.hasClass("disabled")||this.client.send("playHelp")},s=function(){this.client.destroy(),this.client=null,this.reset()},t=function(){this.captionsMuted=!this.captionsMuted};Object.defineProperty(i,"paused",{set:function(a){this._paused=a,this.client&&this.client.send("pause",a),this.trigger(a?"paused":"resumed"),this.trigger("pause",a),this.pauseButton.removeClass("unpaused paused").addClass(a?"paused":"unpaused"),a&&!this.helpButton.hasClass("disabled")?(this.helpButton.data("paused",!0),this.helpEnabled=!1):this.helpButton.data("paused")&&(this.helpButton.removeData("paused"),this.helpEnabled=!0)},get:function(){return this._paused}}),Object.defineProperty(i,"helpEnabled",{set:function(a){this._helpEnabled=a,this.helpButton.removeClass("disabled enabled").addClass(a?"enabled":"disabled"),this.trigger("helpEnabled",a)},get:function(){return this._helpEnabled}});var u=function(){var a=!this.soundMuted;this.soundMuted=a,this.musicMuted=a,this.voMuted=a,this.sfxMuted=a},v=function(){this.musicMuted=!this.musicMuted,this._checkSoundMute()},w=function(){this.voMuted=!this.voMuted,this._checkSoundMute()},x=function(){this.sfxMuted=!this.sfxMuted,this._checkSoundMute()};i._checkSoundMute=function(){this.soundMuted=this.sfxMuted&&this.voMuted&&this.musicMuted};var y=function(){this.paused=!this.paused,this._isManualPause=this.paused},z="captionsMuted",A="soundMuted",B="musicMuted",C="voMuted",D="sfxMuted",E="captionsStyles",F={size:"md",background:"black-semi",color:"white",edge:"none",font:"arial",align:"top"};i._setMuteProp=function(b,c,d){c.removeClass("unmuted muted").addClass(d?"muted":"unmuted"),a.write(b,d),this.client&&this.client.send(b,d)},i.setCaptionsStyles=function(b,c){"object"==typeof b?Object.merge(this._captionsStyles,b||{}):"string"==typeof b&&(this._captionsStyles[b]=c),b=this._captionsStyles,a.write(E,b),this.client&&this.client.send(E,b)},i.getCaptionsStyles=function(a){var b=this._captionsStyles;return a?b[a]:b},i.clearCaptionsStyles=function(){this._captionsStyles=Object.merge({},F),this.setCaptionsStyles()},Object.defineProperty(i,z,{set:function(a){this._captionsMuted=a,this._setMuteProp(z,this.captionsButton,a)},get:function(){return this._captionsMuted}}),Object.defineProperty(i,A,{set:function(a){this._soundMuted=a,this._setMuteProp(A,this.soundButton,a)},get:function(){return this._soundMuted}}),Object.defineProperty(i,C,{set:function(a){this._voMuted=a,this._setMuteProp(C,this.voButton,a)},get:function(){return this._voMuted}}),Object.defineProperty(i,B,{set:function(a){this._musicMuted=a,this._setMuteProp(B,this.musicButton,a)},get:function(){return this._musicMuted}}),Object.defineProperty(i,D,{set:function(a){this._sfxMuted=a,this._setMuteProp(D,this.sfxButton,a)},get:function(){return this._sfxMuted}}),i.reset=function(){this.helpEnabled=!1,G(this.soundButton),G(this.captionsButton),G(this.musicButton),G(this.voButton),G(this.sfxButton),G(this.pauseButton),this.loaded=!1,this.loading=!1,this.paused=!1,this.main.attr("src",""),this.trigger("closed")},i.close=function(){this.loading||this.loaded?(this.trigger("close"),this.client.send("close")):this.reset()};var G=function(a){a.removeClass("enabled").addClass("disabled")};i.destroy=function(){this.reset(),this.main=null,this.dom=null,this.helpButton=null,this.soundButton=null,this.pauseButton=null,this.captionsButton=null,this.musicButton=null,this.voButton=null,this.sfxButton=null,this._pageVisibility&&(this._pageVisibility.destroy(),this._pageVisibility=null),this.client&&(this.client.destroy(),this.client=null),h.destroy.call(this)},namespace("springroll").Container=g}(document);}();