/*! SpringRoll 0.3.0 */
!function(){"use strict";!function(){var a,b,c,d=include("createjs.Container"),e=function(){c||(c=include("springroll.Application"),a=include("springroll.easeljs.DwellTimer",!1),b=include("springroll.Animator",!1)),d.call(this),this.game=c.instance,this.config=this.game.config,this.background=null},f=extend(e,d);f.setup=function(){},f.teardown=function(){var a=this.children.slice();this.cleanupChildren.apply(this,a)},f.cleanupChildren=function(){var c,d,e=arguments.length;for(d=0;e>d;d++)c=arguments[d],c&&(Array.isArray(c)&&c.length>0?this.cleanupChildren.apply(this,c):(a&&a.destroy(c),b&&b.stop(c,!0),c.stop&&c.stop(),c.destroy&&c.destroy(),c.removeAllChildren&&c.removeAllChildren(!0),this.contains(c)&&this.removeChild(c)))},f.destroy=function(){this.game=null,this.config=null,this.background=null,this.removeAllChildren()},namespace("springroll.easeljs").BasePanel=e}(),function(a){var b,c,d,e,f,g=include("springroll.BaseState"),h=function(a,h,i){if(c||(c=include("springroll.Application"),e=include("springroll.easeljs.BasePanel"),d=include("springroll.ListTask"),f=include("springroll.TaskManager"),b=include("springroll.Debug",!1)),!(a instanceof e))throw"springroll.BaseState requires the panel be a springroll.easeljs.BasePanel";g.call(this,a,h,i),this.game=c.instance,this.voPlayer=this.game.voPlayer,this.config=this.game.config,this.scaling=this.game.scaling,this.manifest=null,this.assetsLoaded=!1,this.resizeOnReload=!0,this.useDefaultManifest=!0,this.delayLoadFrames=0},i=g.prototype,j=extend(h,g);j.enter=function(){this.loadingStart(),this.assetsLoaded=!1;var a=[];this.useDefaultManifest&&this.manifest&&this.manifest.length&&a.push(new d("manifests",this.manifest,l)),this.addTasks(a),a.length?f.process(a,k.bind(this)):k.call(this)},j.addTasks=function(){},j.onAssetsLoaded=function(){};var k=function(){if(this.assetsLoaded=!0,this.panel.setup(),this.scaling){var b=this.config.scaling[this.stateId];if(b!==a){this.resizeOnReload&&this.scaling.addItems(this.panel,b);var c=this.panel.background;c&&c.image&&this.scaling.addBackground(c)}else this.resizeOnReload&&(this.panel.x=this.panel.y=0,this.panel.scaleX=this.panel.scaleY=1,this.scaling.addItem(this.panel,{align:"top-left",titleSafe:!0}))}if(this.onAssetsLoaded(),this.delayLoadFrames>0){var d=this.delayLoadFrames,e=this.game,f=this.loadingDone.bind(this),g=function(){--d<=0&&(e.off("update",g),f())};e.on("update",g)}else this.loadingDone()},l=function(a){for(var b in a)-1===a[b].url.indexOf(".js")&&(images[b]=a[b].content)};j.exit=function(){if(this.assetsLoaded){if(this.scaling&&(this.scaling.removeBackground(this.panel.background),this.scaling.removeItems(this.panel)),this.panel.teardown(),this.manifest)for(var a,b=this.manifest,c=b.length,d=0;c>d;d++)a=b[d].id,delete images[a];this.assetsLoaded=!1}},j.destroy=function(){this.manifest=null,this.game=null,this.config=null,this.voPlayer=null,this.scaling=null,this.panel.destroy(),i.destroy.apply(this)},namespace("springroll.easeljs").BaseState=h,namespace("springroll.easeljs").ManifestState=h}(),function(){var a,b,c=include("springroll.ApplicationPlugin"),d=function(){c.call(this)},e=extend(d,c);e.setup=function(){this.options.add("manifestsPath","assets/config/manifests.json",!0),this.options.override("fps",30),this.options.override("display",include("springroll.easeljs.EaselJSDisplay")),this.options.override("displayOptions",{clearView:!0}),this.options.override("canvasId","stage"),a=include("springroll.LoadTask"),b=include("springroll.easeljs.BaseState"),this._manifests={},Object.defineProperty(this,"manifests",{get:function(){return this._manifests}}),this.once("configLoaded",function(b,c){this.options.manifestsPath&&c.addTask(new a("manifests",this.options.manifestsPath,f.bind(this)))}),this.on("stateAdded",function(a,c){if(!(c instanceof b))throw"States need to extend springroll.easeljs.BaseState";var d=[],e=this.config.manifests;e&&e[a]&&(d=e[a]),this._manifests[a]&&(d=d.concat(this._manifests[a])),c.manifest=d})};var f=function(a,b,c){var d,e=this._manifests,f=a.content;for(var g in f)d=g.toString().toLowerCase(),e[d]||(e[d]=f[g]);this.trigger("manifestLoaded",c)};e.teardown=function(){this._manifests=null},c.register(d)}();}();