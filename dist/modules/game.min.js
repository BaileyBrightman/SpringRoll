/*! SpringRoll 0.0.7 */
!function(){"use strict";!function(){Object.defineProperty(Array.prototype,"shuffle",{enumerable:!1,writable:!1,value:function(){for(var a,b,c=this.length;c;a=Math.floor(Math.random()*c),b=this[--c],this[c]=this[a],this[a]=b);return this}}),Object.defineProperty(Array.prototype,"random",{enumerable:!1,writable:!1,value:function(){return this[Math.floor(Math.random()*this.length)]}}),Object.defineProperty(Array.prototype,"last",{enumerable:!1,writable:!1,value:function(){return this[this.length-1]}})}(),function(a){a.getRandomInt=function(b,c){return void 0===c&&(c=b,b=0),a.floor(a.random()*(c-b+1))+b},a.dist=function(b,c,d,e){return a.sqrt((b-=d)*b+(c-=e)*c)}}(Math),function(){var a,b=function(b,c,d){a||(a=include("springroll.StateManager")),this.stateId=null,this.manager=null,this.panel=b,this._destroyed=!1,this._active=!1,this._isLoading=!1,this._canceled=!1,this._onEnterProceed=null,this._onLoadingComplete=null,this._enabled=!1,this._isTransitioning=!1,this.nextState=c||null,this.prevState=d||null},c=b.prototype;c.getCanceled=function(){return this._canceled},c._internalExit=function(){this._isTransitioning&&(this._isTransitioning=!1,this.manager._display.animator.stop(this.panel)),this._enabled=!1,this.panel.visible=!1,this._active=!1,this.exit()},c.exit=function(){},c._internalExitStart=function(){this.exitStart()},c.exitStart=function(){},c._internalEnter=function(a){this._isTransitioning&&(this._isTransitioning=!1,this.manager._display.animator.stop(this.panel)),this._enabled=!1,this._active=!0,this._canceled=!1,this._onEnterProceed=a,this.enter(),this._onEnterProceed&&(this._onEnterProceed(),this._onEnterProceed=null)},c.loadingStart=function(){return this._isLoading?void Debug.warn("loadingStart() was called while we're already loading"):(this._isLoading=!0,this.manager.loadingStart(),this._onLoadingComplete=this._onEnterProceed,void(this._onEnterProceed=null))},c.loadingDone=function(){return this._isLoading?(this._isLoading=!1,this.manager.loadingDone(),void(this._onLoadingComplete&&(this._onLoadingComplete(),this._onLoadingComplete=null))):void Debug.warn("loadingDone() was called without a load started, call loadingStart() first")},c._internalCancel=function(){this._active=!1,this._canceled=!0,this._isLoading=!1,this._internalExit(),this.cancel()},c.cancel=function(){},c.enter=function(){},c._internalEnterDone=function(){this._canceled||(this.setEnabled(!0),this.enterDone())},c.enterDone=function(){},c.getActive=function(){return this._active},c.transitionIn=function(b){this._isTransitioning=!0;var c=this;this.manager._display.animator.play(this.panel,a.TRANSITION_IN,function(){c._isTransitioning=!1,b()})},c.transitionOut=function(b){this._enabled=!1,this._isTransitioning=!0;var c=this;this.manager._display.animator.play(this.panel,a.TRANSITION_OUT,function(){c._isTransitioning=!1,b()})},c.getDestroyed=function(){return this._destroyed},c.setEnabled=function(a){this._enabled=a},c.getEnabled=function(){return this._enabled},c.destroy=function(){this.exit(),this.panel=null,this.manager=null,this._destroyed=!0,this._onEnterProceed=null,this._onLoadingComplete=null},namespace("springroll").BaseState=b}(),function(a){{var b=function(b,c,d){this.currentState=c,this.visibleState=d===a?c:d,this.type=b};b.prototype}b.TRANSITION_IN="onTransitionStateIn",b.TRANSITION_IN_DONE="onTransitionStateInDone",b.TRANSITION_OUT="onTransitionStateOut",b.TRANSITION_OUT_DONE="onTransitionStateOutDone",b.VISIBLE="onVisible",b.HIDDEN="onHidden",namespace("springroll").StateEvent=b}(),function(a){var b,c=include("springroll.EventDispatcher"),d=(include("springroll.BaseState"),include("springroll.StateEvent")),e=function(a,d,e){c.call(this),b=include("springroll.Sound",!1),this._display=a,this._transition=d,this._transitionSounds=e||null,this._states={},this._state=null,this._stateId=null,this._oldState=null,this._isLoading=!1,this._isTransitioning=!1,this._destroyed=!1,this._queueStateId=null,this._transition.stop&&this._transition.stop(),this.hideBlocker(),this._loopTransition=this._loopTransition.bind(this)},f=e.prototype=Object.create(c.prototype);e.TRANSITION_IN="onTransitionIn",e.TRANSITION_IN_DONE="onTransitionInDone",e.TRANSITION_OUT="onTransitionOut",e.TRANSITION_OUT_DONE="onTransitionOutDone",e.TRANSITION_INIT_DONE="onInitDone",e.LOADING_START="onLoadingStart",e.LOADING_DONE="onLoadingDone",f.addState=function(a,b){this._states[a]=b,b.stateId=a,b.manager=this,b._internalExit()},f.changeTransition=function(a){this._transition=a},f.getState=function(){return this._stateId},f.getCurrentState=function(){return this._state},f.getStateById=function(b){return Debug.assert(this._states[b]!==a,"No alias matching "+b),this._states[b]},f.isBusy=function(){return this._isLoading||this._isTransitioning},f.loadingStart=function(){this._destroyed||(this.trigger(e.LOADING_START),this._loopTransition())},f.loadingDone=function(){this._destroyed||this.trigger(e.LOADING_DONE)},f.showBlocker=function(){this._display.enabled=!1},f.hideBlocker=function(){this._display.enabled=!0},f.refresh=function(){Debug.assert(!!this._state,"No current state to refresh!"),this.setState(this._stateId)},Object.defineProperty(f,"state",{set:function(a){this.setState(a)},get:function(){return this._stateId}}),f.setState=function(b){if(Debug.assert(this._states[b]!==a,"No current state mattching id '"+b+"'"),this._isTransitioning)return void(this._queueStateId=b);this._stateId=b,this.showBlocker(),this._oldState=this._state,this._state=this._states[b];var c;this._oldState?this._isLoading?(this._oldState._internalCancel(),this._isLoading=!1,this._state._internalEnter(this._onStateLoaded)):(this._isTransitioning=!0,this._oldState._internalExitStart(),this.showBlocker(),c=this,this.has(d.TRANSITION_OUT)&&this.trigger(d.TRANSITION_OUT,new d(d.TRANSITION_OUT,this._state,this._oldState)),this._oldState.transitionOut(function(){c.has(d.TRANSITION_OUT_DONE)&&c.trigger(d.TRANSITION_OUT_DONE,new d(d.TRANSITION_OUT_DONE,c._state,c._oldState)),c.trigger(e.TRANSITION_OUT),c._transitioning(e.TRANSITION_OUT,function(){c.trigger(e.TRANSITION_OUT_DONE),c._isTransitioning=!1,c.has(d.HIDDEN)&&c.trigger(d.HIDDEN,new d(d.HIDDEN,c._state,c._oldState)),c._oldState.panel.visible=!1,c._oldState._internalExit(),c._oldState=null,c._loopTransition(),c._processQueue()||(c._isLoading=!0,c._state._internalEnter(c._onStateLoaded.bind(c)))})})):(this._isTransitioning=!0,this._transition.visible=!0,c=this,this._loopTransition(),c.trigger(e.TRANSITION_INIT_DONE),c._isLoading=!0,c._state._internalEnter(c._onStateLoaded.bind(c)))},f._onStateLoaded=function(){this._isLoading=!1,this._isTransitioning=!0,this.has(d.VISIBLE)&&this.trigger(d.VISIBLE,new d(d.VISIBLE,this._state)),this._state.panel.visible=!0,this.trigger(e.TRANSITION_IN);var a=this;this._transitioning(e.TRANSITION_IN,function(){a._transition.visible=!1,a.trigger(e.TRANSITION_IN_DONE),a.has(d.TRANSITION_IN)&&a.trigger(d.TRANSITION_IN,new d(d.TRANSITION_IN,a._state)),a._state.transitionIn(function(){a.has(d.TRANSITION_IN_DONE)&&a.trigger(d.TRANSITION_IN_DONE,new d(d.TRANSITION_IN_DONE,a._state)),a._isTransitioning=!1,a.hideBlocker(),a._processQueue()||a._state._internalEnterDone()})})},f._processQueue=function(){if(this._queueStateId){var a=this._queueStateId;return this._queueStateId=null,this.setState(a),!0}return!1},f._loopTransition=function(){var a,c=this._display.animator;this._transitionSounds&&b&&(a=this._transitionSounds.loop),c.instanceHasAnimation(this._transition,"transitionLoop")&&c.play(this._transition,{anim:"transitionLoop",audio:a},this._loopTransition)},f.showTransitionOut=function(a){this.showBlocker();var b=this,c=function(){b._loopTransition(),a&&a()};this._transitioning(e.TRANSITION_OUT,c)},f.showTransitionIn=function(a){var b=this;this._transitioning(e.TRANSITION_IN,function(){b.hideBlocker(),a&&a()})},f._transitioning=function(a,c){var d=this._transition;d.visible=!0;var f,g=this._display.animator;this._transitionSounds&&b&&(f=a==e.TRANSITION_IN?this._transitionSounds["in"]:this._transitionSounds.out),g.play(this._transition,{anim:a,audio:f},c)},f.next=function(){var a=typeof this._state.nextState;this._state.nextState&&("function"===a?this._state.nextState():"string"===a&&this.setState(this._state.nextState))},f.previous=function(){var a=typeof this._state.prevState;this._state.prevState&&("function"===a?this._state.prevState():"string"===a&&this.setState(this._state.prevState))},f.destroy=function(){if(this._destroyed=!0,this.off(),this._display.animator.stop(this._transition),this._transition=null,this._state=null,this._oldState=null,this._states)for(var a in this._states)this._states[a].destroy(),delete this._states[a];this._states=null},namespace("springroll").StateManager=e}(),function(){var a,b,c,d=include("springroll.Application"),e=include("springroll.StateManager"),f=function(b){c=include("springroll.Sound"),a=include("springroll.VOPlayer"),d.call(this,Object.merge({swfPath:"assets/swfs/",audioTypes:["ogg","mp3"],mute:!1,captions:null,updateTween:!0,name:"Untitled",forceMobile:!1,state:null,transition:null,transitionSounds:{"in":"TransitionIn",out:"TransitionOut"}},b)),this.name=this.options.name,this._music=null,this.player=new a,this.captions=null,this.transition=this.options.transition||null,this.manager=null;var e=navigator.userAgent;this.isIOS=e.search(/iPhone|iPad|iPod/)>-1,this.isMobile=this.isIOS||e.search(/Android|Blackberry/)>-1,this.once("beforeInit",m.bind(this))},g=d.prototype,h=f.prototype=Object.create(g),i="soundReady",j="initStates",k="statesReady",l="addStates",m=function(){this._readyToInit=!1,c.init({swfPath:this.options.swfPath,ready:n.bind(this),types:this.options.audioTypes})},n=function(){this._readyToInit=!0,this.trigger(i),this._doInit()};h.initStates=function(){if(this.trigger(j),!this.transition)throw"No options.transition";this.transition.gotoAndStop&&this.transition.gotoAndStop("onTransitionOut_stop"),this.manager=new e(this.display,this.transition,this.options.transitionSounds),this.trigger(l),this.display.stage.addChild(this.transition),this.options.state&&this.manager.setState(this.options.state),this.trigger(k)},h.addState=function(a,b){if(!this.manager)throw"StateManager no initialized";this.manager.addState(a,b),this.display.stage.addChild(b.panel)},h.addStates=function(a){for(var b in a)this.addState(b,a[b])},Object.defineProperty(h,"music",{set:function(a){if(a!=this._music){var b=c.instance;this._music&&b.fadeOut(this._music),this._music=a,this._music&&b.play(this._music,{start:b.fadeIn.bind(b,this._music),loop:-1})}},get:function(){return this._music}}),h.addSounds=function(a){return c.instance.loadConfig(a)},h.addCaptions=function(a){if(this.captions)this.captions.setDictionary(a);else{b=include("springroll.Captions");var c=new b(a,this.options.captions);this.player.captions=c,this.captions=c,this.getDisplays(function(a){a.animator&&(a.animator.captions=c)})}},h.setCaptionsDictionary=function(a){this.addCaptions(a)},h.destroy=function(){this.manager&&(this.manager.destroy(),this.manager=null),this.player&&(this.player.destroy(),this.player=null),this.transition&&(this.display.adapter.removeChildren(this.transition),this.transition=null),this.captions=null,g.destroy.call(this)},h.toString=function(){return"[Game name='"+this.name+"'']"},namespace("springroll").Game=f}();}();