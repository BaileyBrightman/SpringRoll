/*! SpringRoll 0.3.8 */
!function(){"use strict";!function(a,b,c){a.prototype.shuffle||c.defineProperty(a.prototype,"shuffle",{enumerable:!1,writable:!1,value:function(){for(var a,c,d=this.length;d;a=b.floor(b.random()*d),c=this[--d],this[d]=this[a],this[a]=c);return this}}),a.prototype.random||c.defineProperty(a.prototype,"random",{enumerable:!1,writable:!1,value:function(){return this[b.floor(b.random()*this.length)]}}),a.prototype.last||c.defineProperty(a.prototype,"last",{enumerable:!1,writable:!1,value:function(){return this[this.length-1]}})}(Array,Math,Object),function(a){a.randomInt=function(b,c){return void 0===c&&(c=b,b=0),a.floor(a.random()*(c-b+1))+b},a.dist=function(b,c,d,e){return a.sqrt(a.distSq(b,c,d,e))},a.distSq=function(a,b,c,d){return"number"==typeof a.x&&a.x==a.x&&(d=c,c=b,b=a.y,a=a.x),"number"==typeof c.x&&c.x==c.x&&(d=c.y,c=c.x),(a-c)*(a-c)+(b-d)*(b-d)},a.clamp=function(a,b,c){return void 0===c&&(c=b,b=0),a>c?c:b>a?b:a}}(Math),function(a,b){a.prototype.toPaddedString||b.defineProperty(a.prototype,"toPaddedString",{enumerable:!1,writable:!1,value:function(a){a||(a=2);var b;num<0&&(num*=-1,b="-");for(var c=String(Math.floor(num));c.length<a;)c="0"+c;return b&&(c=b+c),c}})}(Number,Object),function(a,b,c){a.merge=function(b,c){b&&"object"==typeof b||(b={});for(var d in c)if(c.hasOwnProperty(d)){var e=c[d];if("object"==typeof e&&a.isPlain(e)){b[d]=a.merge(b[d],e);continue}b[d]=e}for(var f=2,g=arguments.length;g>f;f++)a.merge(b,arguments[f]);return b},a.isPlain=function(a){var d,e=b.hasOwnProperty;if(!a||"object"!=typeof a||a.nodeType||a===window)return!1;try{if(a.constructor&&!e.call(a,"constructor")&&!e.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(f){return!1}if(b.ownLast)for(d in a)return e.call(a,d);for(d in a);return d===c||e.call(a,d)},a.prototype.clone||a.defineProperty(a.prototype,"clone",{enumerable:!1,writable:!0,value:function(){var a={},b=this;for(var c in b)a[c]=b[c];return a}})}(Object,{}),function(a,b){b.defineProperty(a.prototype,"format",{enumerable:!1,writable:!1,value:function(){if(arguments.length<1)return this;var a=Array.isArray(a)?a:Array.prototype.slice.call(arguments);return this.replace(/([^%]|^)%(?:(\d+)\$)?s/g,function(b,c,d){return d?c+a[parseInt(d)-1]:c+a.shift()}).replace(/%%s/g,"%s")}}),a.prototype.reverse||b.defineProperty(a.prototype,"reverse",{enumerable:!1,writable:!1,value:function(){for(var a="",b=this.length-1;b>=0;b--)a+=this[b];return a}})}(String,Object),function(a){"extend"in a||(a.extend=function(b,c){return"string"==typeof c&&(c=a.include(c)),b.prototype=Object.create(c.prototype),b.prototype})}(window),function(a,b){if(!("include"in a)){var c=function(c,d){var e=c.split("."),f=a,g="";d=d!==b?!!d:!0;for(var h=0,i=e.length;i>h;h++){if(g=e[h],!f[g]){if(!d)return null;throw"Unable to include '"+c+"'"}f=f[g]}return f};a.include=c}}(window),function(a,b){if(!("mixin"in a)){var c=function(c,d){if("string"==typeof d&&(d=a.include(d)),!d.prototype)throw"no mixin prototype";var e=d.prototype;for(var f in e){var g=b.getOwnPropertyDescriptor(e,f);g?b.defineProperty(c,f,g):c[f]=e[f]}return d.apply(c,Array.prototype.slice.call(arguments,2)),c};a.mixin=c}}(window,Object),function(a){if(!("namespace"in a)){var b=function(b){for(var c=b.split("."),d=a,e="",f=0,g=c.length;g>f;f++)e=c[f],d[e]=d[e]||{},d=d[e];return d};a.namespace=b}}(window),function(){var a=function(a,b,c,d){b[c]?b[d]=a:a()};a.create=function(b,c,d,e){return a.bind(this,b,c,d,e)},namespace("springroll").CombinedCallback=a}(),function(a){var b,c=function(c,d,e,f,g){b||(b=include("springroll.Application")),"boolean"==typeof e&&(e={repeat:!!e,autoDestroy:f===a?!0:!!f,useFrames:!!g}),e=Object.merge({repeat:!1,autoDestroy:!0,useFrames:!1},e||{}),this._callback=c,this._delay=d,this._timer=d,this._repeat=e.repeat,this._autoDestroy=e.autoDestroy,this._useFrames=e.useFrames,this._paused=!1,this._update=this._update.bind(this),b.instance.on("update",this._update)},d=c.prototype;d._update=function(a){return this._callback?(this._timer-=this._useFrames?1:a,void(this._timer<=0&&(this._callback(),this._repeat?this._timer+=this._delay:this._autoDestroy?this.destroy():b.instance.off("update",this._update)))):void this.destroy()},d.restart=function(){if(this._callback){var a=b.instance;a.has("update",this._update)||a.on("update",this._update),this._timer=this._delay,this._paused=!1}},d.stop=function(){b.instance.off("update",this._update),this._paused=!1},Object.defineProperty(d,"paused",{get:function(){return this._paused},set:function(a){if(this._callback){var c=b.instance;this._paused&&!a?(this._paused=!1,c.has("update",this._update)||c.on("update",this._update)):a&&c.has("update",this._update)&&(this._paused=!0,c.off("update",this._update))}}}),d.destroy=function(){b.instance.off("update",this._update),this._callback=null},namespace("springroll").DelayedCall=c}(),function(){var a,b=function(b,c,d){void 0===a&&(a=include("springroll.Debug",!1)),this.name=b,this._value=c,this._toString=d||this.name};Object.defineProperty(b.prototype,"asInt",{get:function(){return this._value}}),b.prototype.toString=function(){return this._toString};var c=function(){var a=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);Object.defineProperty(this,"_byValue",{enumerable:!1,writable:!1,value:[]}),Object.defineProperty(this,"rawEnumValues",{enumerable:!1,writable:!1,value:a});for(var c,d,e,f=0,g=0,h=a.length;h>g;++g)"string"==typeof a[g]?e=a[g]:(e=a[g].name,d=a[g].value||f,f=d),this[e]||(c="string"==typeof a[g]?new b(e,f,e):new b(e,d,a[g].toString||e),this[c.name]=c,this._byValue[f]?Array.isArray(this._byValue[f])?this._byValue[f].push(c):this._byValue[f]=[this._byValue[f],c]:this._byValue[f]=c,f++);Object.defineProperty(this,"length",{enumerable:!1,writable:!1,value:a.length}),Object.defineProperty(this,"next",{enumerable:!1,writable:!1,value:function(a){var b=a.asInt+1;return b>=f?this.first:this.valueFromInt(b)}}),Object.defineProperty(this,"first",{enumerable:!1,writable:!1,value:this.valueFromInt(a[0].value||0)}),Object.defineProperty(this,"last",{enumerable:!1,writable:!1,value:this.valueFromInt(f-1)})};Object.defineProperty(c.prototype,"valueFromInt",{enumerable:!1,writable:!1,value:function(a){var b=this._byValue[a];return b?Array.isArray(b)?b[0]:b:null}}),namespace("springroll").Enum=c}(),function(a){var b={},c=window.Storage!==a,d=-1;if(c)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST")}catch(e){c=!1}b.remove=function(a){c?(localStorage.removeItem(a),sessionStorage.removeItem(a)):b.write(a,"",d)},b.write=function(a,b,e){if(c)e?sessionStorage.setItem(a,JSON.stringify(b)):localStorage.setItem(a,JSON.stringify(b));else{var f;f=e?e!==d?"":"; expires=Thu, 01 Jan 1970 00:00:00 GMT":"; expires="+new Date(2147483646e3).toGMTString(),document.cookie=a+"="+escape(JSON.stringify(b))+f+"; path=/"}},b.read=function(a){if(c){var d=localStorage.getItem(a)||sessionStorage.getItem(a);return d?JSON.parse(d,b.reviver):null}var e,f,g=a+"=",h=document.cookie.split(";"),i=0;for(i=0,f=h.length;f>i;i++){for(e=h[i];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(g))return JSON.parse(unescape(e.substring(g.length,e.length)),b.reviver)}return null},b.reviver=function(a,b){if(b&&"string"==typeof b.__classname){var c=include(b.__classname,!1);if(c){var d=new c;if(d.fromJSON)return d.fromJSON(b),d}}return b},namespace("springroll").SavedData=b}(),function(a){var b=include("performance",!1),c=b&&(b.now||b.mozNow||b.msNow||b.oNow||b.webkitNow);c&&(b.now=c);var d={};d.now=c?function(){return b.now()}:Date.now,namespace("springroll").TimeUtils=d}(window),function(){var a=function(a){this.max=-1,this.options=[];var b=0;for(var c in a)b+=a[c],this.options.push({key:c,value:b}),this.max+=a[c]},b=a.prototype={};b.random=function(){for(var a=Math.randomInt(0,this.max),b=0,c=this.options,d=c.length;d>b;++b)if(a<c[b].value)return c[b].key;return null},namespace("springroll").WeightedRandom=a}(),function(){for(var a=["ms","moz","webkit","o"],b=a.length,c=0;b>c&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[a[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[c]+"CancelAnimationFrame"]||window[a[c]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame){var d=include("springroll.TimeUtils"),e=0;window.requestAnimationFrame=function(a){var b=d.now(),c=Math.max(0,16-(b-e)),f=window.setTimeout(function(){a(b+c)},c);return e=b+c,f},window.cancelAnimationFrame=function(a){clearTimeout(a)}}window.requestAnimFrame=window.requestAnimationFrame}(),function(a){function b(a,b){return a._priority-b._priority}function c(a){if(null===a)return"null";var b=typeof a;return"object"===b||"function"===b?Object.prototype.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":b}var d=function(){this._listeners=[],this._destroyed=!1},e=d.prototype;Object.defineProperty(e,"destroyed",{enumerable:!0,get:function(){return this._destroyed}}),e.trigger=function(b){if(!this._destroyed&&this._listeners[b]!==a){var c,d=this._listeners[b].slice();arguments.length>1&&(c=Array.prototype.slice.call(arguments,1));for(var e=d.length-1;e>=0;--e){var f=d[e];f._eventDispatcherOnce&&(delete f._eventDispatcherOnce,this.off(b,f)),f.apply(this,c)}}},e.once=function(a,b,c){return this.on(a,b,c,!0)},e.on=function(a,d,e,f){if(!this._destroyed){if("object"===c(a))for(var g in a)a.hasOwnProperty(g)&&this.on(g,a[g],e,f);else if("function"===c(d))for(var h,i=a.split(" "),j=null,k=0,l=i.length;l>k;k++)j=i[k],h=this._listeners[j],h||(h=this._listeners[j]=[]),f&&(d._eventDispatcherOnce=!0),d._priority=parseInt(e)||0,-1===h.indexOf(d)&&(h.push(d),h.length>1&&h.sort(b));else if(Array.isArray(d))for(var m=0,n=d.length;n>m;m++)this.on(a,d[m],e,f);return this}},e.off=function(b,c){if(!this._destroyed){if(b===a)this._listeners=[];else if(Array.isArray(c))for(var d=0,e=c.length;e>d;d++)this.off(b,c[d]);else for(var f,g,h=b.split(" "),i=null,j=0,k=h.length;k>j;j++)i=h[j],f=this._listeners[i],f&&(c===a?f.length=0:(g=f.indexOf(c),-1!==g&&f.splice(g,1)));return this}},e.has=function(a,b){if(!a)return!1;var c=this._listeners[a];return c?b?c.indexOf(b)>=0:c.length>0:!1},e.destroy=function(){this._destroyed=!0,this._listeners=null},namespace("springroll").EventDispatcher=d}(),function(a){var b=include("springroll.EventDispatcher"),c=function(){b.call(this),this._properties={}},d=b.prototype,e=extend(c,b),f=function(a,b){var c=this._properties[a];if(c.readOnly)throw"Property '"+a+"' is read-only";var d=c.value;c.value=b,d!=b&&this.trigger(a,b)},g=function(a){var b=this._properties[a];if(b.responder){var c=b.responder();return b.value=c,c}return b.value};e.add=function(b,c,d){var e=this._properties,i=e[b];if(i!==a)return i.setValue(c),i.setReadOnly(d===a?i.readOnly:d),this;if(this.hasOwnProperty(b))throw"Object already has property "+b;return e[b]=new h(b,c,d),Object.defineProperty(this,b,{get:g.bind(this,b),set:f.bind(this,b)}),this},e.readOnly=function(b){var c,d;for(var e in arguments){if(d=arguments[e],c=this._properties[d],c===a)throw"Property "+d+" does not exist";c.readOnly=!0}},e.respond=function(b,c){var d=this._properties[b];if(d===a)throw"Property "+b+" does not exist";return d.responder=c,d.value=c(),this};var h=function(a,b,c){this.name=a,this.setValue(b),this.setReadOnly(c),this.responder=null};h.prototype.setValue=function(b){this.value=b===a?null:b},h.prototype.setReadOnly=function(b){this.readOnly=b===a?!1:!!b},e.destroy=function(){var a;for(var b in this._properties)a=this._properties[b],a.value=null,a.responder=null;this._properties=null,d.destroy.call(this)},namespace("springroll").PropertyDispatcher=c}(),function(a){var b,c=include("createjs.Tween",!1),d=include("createjs.Ticker",!1),e=include("springroll.PropertyDispatcher"),f=function(c,d){b===a&&(b=include("springroll.Debug",!1)),e.call(this),this._options=d||{},this._app=c},g=extend(f,e);g.init=function(){var a=this._options,b=this._app;a=Object.merge({},i,a),a.useQueryString&&Object.merge(a,h());for(var e in a)this.add(e,a[e]);this.readOnly("name","useQueryString","canvasId","display","displayOptions","uniformResize"),this.on("updateTween",function(a){c&&(d&&d.setPaused(!!a),b.off("update",c.tick),a&&b.on("update",c.tick))});var f=this._properties;for(var g in f)this.trigger(g,f[g].value)};var h=function(){var b={},c=window.location.search;if(!c)return b;var d=c.substr(c.indexOf("?")+1),e=d.indexOf("#");d=0>e?d:d.substring(0,e);for(var f,g=d.split("&"),h=0,i=g.length;i>h;h++){f=g[h].split("=");var j=f[1];"true"===j||j===a?j=!0:"false"===j&&(j=!1),b[f[0]]=j}return b};g.asDOMElement=function(a){var b=this._properties[a];b&&b.value&&"string"==typeof b.value&&(b.value=document.getElementById(b.value))},g.override=function(b,c){if(i[b]===a)throw"ApplicationOptions doesn't have default name '"+b+"'";i[b]=c};var i={raf:!0,fps:60,useQueryString:!1,canvasId:null,display:null,displayOptions:null,updateTween:!0,crossOrigin:!1,name:""};namespace("springroll").ApplicationOptions=f}(),function(){var a,b=function(b){a||(a=include("springroll.Application")),this.priority=b||0,this.setup=function(){},this.preload=null,this.teardown=function(){},a._plugins.push(this),a._plugins.sort(function(a,b){return b.priority-a.priority})};namespace("springroll").ApplicationPlugin=b}(),function(a){var b=include("springroll.TimeUtils"),c=include("springroll.EventDispatcher"),d=include("springroll.ApplicationOptions"),e=function(a,b){if(q)throw"Only one Application can be opened at a time";q=this,c.call(this),this.options=new d(this,a),this.display=null,this.init=b||null,p={},o=[],i=this._tick.bind(this),e._plugins.forEach(function(a){a.setup.call(q)}),this.options.init(),this.name=this.options.name,setTimeout(this._preInit.bind(this),0)},f=c.prototype,g=extend(e,c);e._plugins=[];var h=0,i=null,j=!1,k=!0,l=-1,m=!1,n=0,o=null,p=null,q=null;Object.defineProperty(e,"instance",{get:function(){return q}}),g._preInit=function(){if(!this.destroyed){var a=this.options;m=a.raf,a.on("raf",function(a){m=a}),a.on("fps",function(a){"number"==typeof a&&(n=1e3/a|0)}),a.canvasId&&a.display&&this.addDisplay(a.canvasId,a.display,a.displayOptions);var b=[];e._plugins.forEach(function(a){a.preload&&b.push(a.preload.bind(q))}),this.load(b,this._doInit.bind(this),!1)}},g._doInit=function(){this.destroyed||(this.trigger("beforeInit"),this.paused=!1,this.trigger("init"),this.init&&this.init.call(this),this.trigger("afterInit"))},Object.defineProperty(g,"enabled",{set:function(a){k=a,o.forEach(function(b){b.enabled=a})},get:function(){return k}}),Object.defineProperty(g,"paused",{get:function(){return j},set:function(a){j=!!a,this.trigger("pause",j),this.trigger(j?"paused":"resumed",j),j?-1!=l&&(m?cancelAnimationFrame(l):clearTimeout(l),l=-1):-1==l&&i&&(h=b.now(),l=m?requestAnimFrame(i):r(i))}});var r=function(a,b){var c=n;return b&&(c=Math.max(0,n-b)),setTimeout(a,c)};g.addDisplay=function(a,b,c){if(p[a])throw"Display exists with id '"+a+"'";var d=new b(a,c);return p[a]=d,o.push(d),d.enabled=k,this.display||(this.display=d),this.trigger("displayAdded",d),d},Object.defineProperty(g,"displays",{get:function(){return o}}),g.getDisplay=function(a){return p[a]},g.removeDisplay=function(a){var b=p[a];b&&(o.splice(o.indexOf(b),1),b.destroy(),delete p[a],this.trigger("displayRemoved",a))},g._tick=function(){if(j)return void(l=-1);var a=b.now(),c=a-h;if(h=a,this.trigger("update",c),o)for(var d=0;d<o.length;d++)o[d].render(c);i&&(l=m?requestAnimFrame(i):r(i,b.now()-h))},g.destroy=function(){if(!this.destroyed){this.paused=!0,this.trigger("destroy");var a=e._plugins.slice().reverse();a.forEach(function(a){a.teardown.call(q)}),o.forEach(function(a){a.destroy()}),o=null,p=null,q=i=null,this.display=null,this.options.destroy(),this.options=null,f.destroy.call(this)}},g.toString=function(){return"[Application name='"+this.name+"']"},namespace("springroll").Application=e}(),function(a,b,c){var d=function(a,d){this._onFocus=a,this._onBlur=d,this._enabled=!1,(f||b.onfocusin!==c)&&(this._onToggle=function(){b.hidden||b.webkitHidden||b.msHidden||b.mozHidden?this._onBlur():this._onFocus()}.bind(this),this.enabled=!0)},e=d.prototype,f=null;b.hidden!==c?f="visibilitychange":b.mozHidden!==c?f="mozvisibilitychange":b.msHidden!==c?f="msvisibilitychange":b.webkitHidden!==c&&(f="webkitvisibilitychange");var g=!f&&b.onfocusin!==c;Object.defineProperty(e,"enabled",{get:function(){return this._enabled},set:function(c){c=!!c,this._enabled!=c&&(this._enabled=c,a.removeEventListener("pagehide",this._onBlur),a.removeEventListener("pageshow",this._onFocus),a.removeEventListener("blur",this._onBlur),a.removeEventListener("focus",this._onFocus),a.removeEventListener("visibilitychange",this._onToggle),b.removeEventListener(f,this._onToggle,!1),g&&(b.removeEventListener("focusin",this._onFocus),b.removeEventListener("focusout",this._onBlur)),c&&(b.addEventListener(f,this._onToggle,!1),a.addEventListener("pagehide",this._onBlur),a.addEventListener("pageshow",this._onFocus),a.addEventListener("blur",this._onBlur),a.addEventListener("focus",this._onFocus),a.addEventListener("visibilitychange",this._onToggle,!1),g&&(b.addEventListener("focusin",this._onFocus),b.addEventListener("focusout",this._onBlur))))}}),e.destroy=function(){f&&this._onToggle&&(this.enabled=!1,this._onToggle=null,this._onFocus=null,this._onBlur=null)},namespace("springroll").PageVisibility=d}(window,document),function(){var a=include("springroll.ApplicationPlugin"),b=new a;b.setup=function(){var a=include("springroll.PageVisibility"),b=this._visibility=new a(d.bind(this),c.bind(this));this.options.add("autoPause",!0).on("autoPause",function(a){b.enabled=a}).respond("autoPause",function(){return b.enabled})};var c=function(){this.paused=!0},d=function(){this.paused=!1};b.teardown=function(){this._visibility&&this._visibility.destroy(),this._visibility=null}}(),function(){var a=function(){this._filters=[]},b=a.prototype;b.add=function(a,b){if(!a||"string"!=typeof a&&a instanceof RegExp==!1)throw"invalide replace value";if("string"!=typeof b)throw"invalid replacement value";if(this._filters){for(var c=this._filters.length-1;c>=0;c--)if(a.toString()==this._filters[c].replace.toString())throw"Filter already exists.";this._filters.push({replace:a,replacement:b})}},b.filter=function(a){if(!this._filters)return a;for(var b=this._filters.length-1;b>=0;b--){var c=this._filters[b].replace,d=this._filters[b].replacement;a=a.replace(c,d)}return a},b.destroy=function(){this._filters=null},namespace("springroll").StringFilters=a}(),function(){var a=include("springroll.ApplicationPlugin"),b=new a(110);b.setup=function(){var a=include("springroll.StringFilters");this.filters=new a},b.teardown=function(){this.filters&&this.filters.destroy(),this.filters=null}}(),function(){var a=include("springroll.ApplicationPlugin"),b=new a(100),c=null,d=0,e=0,f=0,g=0,h={width:0,height:0};b.setup=function(){this.options.add("maxWidth",0),this.options.add("maxHeight",0),this.options.add("uniformResize",!0),this.options.add("resizeElement","frame",!0),this.options.on("maxWidth",function(a){d=a}),this.options.on("maxHeight",function(a){e=a}),this.once("displayAdded",function(a){f=a.width,g=a.height,d||(d=f),e||(e=g)}),this.triggerResize=function(){c&&(h.width=0|(c.innerWidth||c.clientWidth),h.height=0|(c.innerHeight||c.clientHeight),this.calculateDisplaySize(h),h.width=Math.ceil(h.width),h.height=Math.ceil(h.height),this.displays.forEach(function(a){a.resize(h.width,h.height)}),this.trigger("resize",h.width,h.height),this.displays.forEach(function(a){a.render(0,!0)}))},this.calculateDisplaySize=function(a){if(g&&this.options.uniformResize){var b=d/g,c=f/e,h=a.width/a.height;c>h?a.height=a.width/c:h>b&&(a.width=a.height*b)}},this.once("beforeInit",this.triggerResize)},b.preload=function(a){var b=this.options;b.asDOMElement("resizeElement"),b.resizeElement&&(c=b.resizeElement,this.triggerResize=this.triggerResize.bind(this),window.addEventListener("resize",this.triggerResize)),a()},b.teardown=function(){c&&window.removeEventListener("resize",this.triggerResize),c=null,h.width=h.height=f=g=e=d=0}}(),function(a){var b=function(a){this._app=a,this._versions={},this._filters=[],this._globalVersion=null,this._applySpecificVersion=this._applySpecificVersion.bind(this),this._applyGlobalVersion=this._applyGlobalVersion.bind(this),this.cacheBust=!1},c=b.prototype={};Object.defineProperty(c,"cacheBust",{get:function(){return!(!this._globalVersion||0!==this._globalVersion.indexOf("cb="))},set:function(a){if(a)this._globalVersion="cb="+Date.now(),this.unregisterURLFilter(this._applySpecificVersion),this.registerURLFilter(this._applyGlobalVersion);else{var b=this._app.options.version;this._globalVersion=b?"v="+b:null,this._globalVersion?(this.unregisterURLFilter(this._applySpecificVersion),this.registerURLFilter(this._applyGlobalVersion)):(this.unregisterURLFilter(this._applyGlobalVersion),this.registerURLFilter(this._applySpecificVersion))}}}),c.destroy=function(){this._app=null,this._versions=null,this._filters=null,this._applySpecificVersion=null,this._applyGlobalVersion=null},c.addVersionsFile=function(a,b,c){if(this.cacheBust)return void(b&&b());this.addVersion(a,Date.now().toString()),a=this._applySpecificVersion(a);var d=this;this._app.load(a,function(a){if(a&&a.content){var e,f,g=a.content.replace(/\r/g,"").split("\n");for(e=0,len=g.length;e<len;e++)g[e]&&(f=g[e].split(" "),2==f.length&&d.addVersion((c||"")+f[0],f[1]))}b&&b()})},c.addVersion=function(a,b){this._versions[a]||(this._versions[a]=b)},c.registerURLFilter=function(a){-1==this._filters.indexOf(a)&&this._filters.push(a)},c.unregisterURLFilter=function(a){var b=this._filters.indexOf(a);b>-1&&this._filters.splice(b,1)},c._applySpecificVersion=function(a){var b=this._app.options.basePath;if(b&&b.indexOf("?")>0)return a;var c=this._versions[a];return c&&/(\?|\&)v\=[0-9]*/.test(a)===!1&&(a=a+(a.indexOf("?")<0?"?":"&")+"v="+c.version),a},c._applyGlobalVersion=function(a){if(!this._globalVersion)return a;var b=this._app.options.basePath;if(b&&b.indexOf("?")>0)return a;var c=0===this._globalVersion.indexOf("cb=")?/(\?|\&)cb\=[0-9]*/:/(\?|\&)v\=/;return c.test(a)===!1&&(a=a+(a.indexOf("?")<0?"?":"&")+this._globalVersion),a},c._applyBasePath=function(a){var b=this._app.options.basePath;return b&&/^http(s)?\:/.test(a)===!1&&-1==a.search(b)&&(a=b+a),a},c.prepare=function(a,b){b&&(a=this._applyBasePath(a));for(var c=0,d=this._filters.length;d>c;++c)a=this._filters[c](a);return a},namespace("springroll").CacheManager=b}(),function(){var a=function(b){this.status=a.WAITING,this.complete=b.complete||null,this.id=b.id||null,this.originalAsset=b},b=a.prototype;a.WAITING=0,a.RUNNING=1,a.FINISHED=2,b.start=function(a){a()},b.destroy=function(){this.status=a.FINISHED,this.id=null,this.complete=null,this.originalAsset=null},namespace("springroll").Task=a}(),function(){var a=include("springroll.Task"),b=function(b){a.call(this,b),this.async=b.async},c=extend(b,a);b.test=function(a){return!!a.async},c.start=function(a){this.async(a)},c.destroy=function(){a.prototype.destroy.call(this),this.async=null},namespace("springroll").FunctionTask=b}(),function(){var a=include("springroll.Task"),b=include("springroll.Application"),c=function(b){a.call(this,b),this.color=b.color,this.alpha=b.alpha},d=extend(c,a);c.test=function(a){return!!a.color&&!!a.alpha},d.start=function(a){b.instance.load({alpha:this.alpha,color:this.color},function(b){a(c.mergeAlpha(b.color.content,b.alpha.content))})},c.mergeAlpha=function(a,b,c){c||(c=document.createElement("canvas")),c.width=Math.max(b.width,a.width),c.height=Math.max(b.height,a.height);var d=c.getContext("2d");return d.save(),d.drawImage(a,0,0),d.globalCompositeOperation="destination-in",d.drawImage(b,0,0),d.restore(),c},namespace("springroll").ColorAlphaTask=c}(),function(){var a=include("springroll.Task"),b=include("springroll.Application"),c=function(b){a.call(this,b),this.src=b.src,this.progress=b.progress,this.priority=b.priority,this.data=b.data},d=extend(c,a);c.test=function(a){return!!a.src},d.start=function(a){b.instance.loader.load(this.src,a,this.progress,this.priority,this.data,this.originalAsset)},d.destroy=function(){a.prototype.destroy.call(this),this.data=null,this.progress=null},namespace("springroll").LoadTask=c}(),function(){function a(a){return d(a)?{src:a}:e(a)?{async:a}:a}function b(a){for(var b,c=f.taskDefs,d=0,e=c.length;e>d;d++)if(b=c[d],b.test(a))return b;return null}function c(a){return"object"==typeof a}function d(a){return"string"==typeof a}function e(a){return"function"==typeof a}var f,g=include("springroll.Task"),h=include("springroll.EventDispatcher"),i=function(a,b,c){h.call(this),f||(f=include("springroll.MultiLoader")),this.complete=b||null,this.mode=m,this.parallel=!!c,this.tasks=[],this.results=null,this.mode=this.addTasks(a),this.results=o(this.mode),this.nextTask()},j=h.prototype,k=extend(i,h),l=0,m=1,n=2;k.addTasks=function(d){if(!this.destroyed){var e,f=m;d=a(d);var g=b(d);if(g)return this.addTask(e),l;if(Array.isArray(d))for(var h=0;h<d.length;h++)e=a(d[h]),e.id||(f=n),this.addTask(e);else if(c(d))for(var i in d)e=a(d[i]),e.id||(e.id=i),this.addTask(e);return f}},k.addTask=function(a){var c=b(a);c&&this.tasks.push(new c(a))},k.nextTask=function(){for(var a=this.tasks,b=0;b<a.length;b++){var c=a[b];if(c.status===g.WAITING&&(c.status=g.RUNNING,c.start(this.taskDone.bind(this,c)),!this.parallel))return}},k.taskDone=function(a,b){if(!this.destroyed){b=b||null;var c=this.tasks.indexOf(a);if(-1!==c){this.tasks.splice(c,1);var d=[];if(b)switch(this.mode){case l:this.results=b;break;case n:this.results.push(b);break;case m:this.results[a.id]=b}a.complete&&a.complete(b,a.originalAsset,d),this.trigger("taskDone",b,a.originalAsset,d),a.destroy();var e=this.addTasks(d);if(this.mode===m&&e!==this.mode)throw"Assets require IDs";this.tasks.length?this.nextTask():(this.complete&&this.complete(this.results),this.trigger("complete",this.results))}}};var o=function(a){switch(a){case l:return null;case n:return[];case m:return{}}};k.destroy=function(){this.trigger("destroyed"),this.tasks.forEach(function(a){a.status=g.FINISHED,a.destroy()}),this.results=null,this.complete=null,this.tasks=null,j.destroy.call(this)},namespace("springroll").MultiLoaderResult=i}(),function(a){var b=include("springroll.MultiLoaderResult"),c=(include("springroll.Task"),function(){this.loads=[]}),d=c.prototype;d.register=function(a,b){"string"==typeof a&&(a=include(a)),a.priority=b||0,e.push(a),e.sort(function(a,b){return b.priority-a.priority})};var e=[];Object.defineProperty(c,"taskDefs",{get:function(){return e}}),d.load=function(c,d,e){var f=new b(c,d,e===a?!0:!!e);return this.loads.push(f),f.once("complete",this._onLoaded.bind(this,f)),f},d._onLoaded=function(a){var b=this.loads.indexOf(a);b>-1&&this.loads.splice(b,1),a.destroy()},d.destroy=function(){this.loads=null,e.length=0},namespace("springroll").MultiLoader=c}(),function(){var a=function(){this.url=null,this.data=null,this.originalAsset=null,this.callback=null,this.priority=0,this.progress=0,this.updateCallback=null,this._boundFail=null,this._boundProgress=null,this._boundComplete=null},b=a.prototype;a.PRIORITY_HIGH=1,a.PRIORITY_NORMAL=0,a.PRIORITY_LOW=-1,b.toString=function(){return"[LoaderQueueItem(url:'"+this.url+"', priority:"+this.priority+")]"},b.reset=function(){this.callback=this.updateCallback=this.data=this.originalAsset=this.url=null,this.progress=0},b.destroy=function(){this.reset(),this._boundFail=null,this._boundProgress=null,this._boundComplete=null},namespace("springroll").LoaderQueueItem=a}(),function(){var a=function(a,b,c,d,e){this.content=a,this.url=b,this.loader=c,this.data=d,this.originalAsset=e,this.id=null},b=a.prototype;b.toString=function(){return"[LoaderResult('"+this.url+"')]"},b.reset=function(){this.content=this.url=this.loader=this.data=this.originalAsset=this.id=null},b.destroy=function(){this.reset()},namespace("springroll").LoaderResult=a}(),function(){var a,b,c,d=include("springroll.LoaderQueueItem"),e=include("springroll.CacheManager"),f=include("springroll.LoaderResult"),g=function(d){a||(a=include("createjs.LoadQueue"),b=include("createjs.Sound",!1),c=include("springroll.Debug",!1)),this._app=d,this._canLoad=!0,this.maxSimultaneousLoads=2,this.cacheManager=new e(d),m=[],n=[],j=[],k={},l={},p={}},h=g.prototype,i=null,j=null,k=null,l=null,m=null,n=null,o=0,p=null;g.init=function(a){return i||(i=new g(a)),i},Object.defineProperty(g,"instance",{get:function(){return i}}),h.destroy=function(){var a,b=this.queue;if(b){this.queue.forEach(function(a){a.destroy()}),m.forEach(function(a){a.destroy()});for(a in l)k[a].destroy(),l[a].close()}i=null,this.cacheManager&&this.cacheManager.destroy(),this.cacheManager=null,j=null,n=null,m=null,k=null,p=null,l=null},h.load=function(a,b,c,e,f,g){var h=this._getQI(),i=this._app.options.basePath;void 0!==i&&/^http(s)?\:/.test(a)===!1&&-1==a.search(i)&&(h.basePath=i),h.url=a,h.callback=b,h.updateCallback=c||null,h.priority=e||d.PRIORITY_NORMAL,h.data=f||null,h.originalAsset=g||null,j.push(h),j.sort(function(a,b){return a.priority-b.priority}),this._tryNextLoad()},h._onLoadFailed=function(a,b){if(i){var c=l[a.url];c.removeAllEventListeners(),c.close(),r(c),delete k[a.url],delete l[a.url],p[a.url]?p[a.url]++:p[a.url]=1,p[a.url]>3?this._loadDone(a,null):(o--,j.push(a),this._tryNextLoad())}},h._onLoadProgress=function(a,b){a.progress=b.progress,a.updateCallback&&a.updateCallback(a.progress)},h._onLoadCompleted=function(a,b){if(i){var c=l[a.url];c.removeAllEventListeners(),c.close(),r(c),delete k[a.url],delete l[a.url],this._loadDone(a,this._getResult(b.result,a.url,c,a.data,a.originalAsset))}},h._tryNextLoad=function(){if(!(o>this.maxSimultaneousLoads-1||0===j.length)){o++;var a=j.shift();k[a.url]=a;var b=this._getLoader(a.basePath);l[a.url]=b,b.addEventListener("fileload",a._boundComplete),b.addEventListener("error",a._boundFail),b.addEventListener("fileprogress",a._boundProgress);var c=this.cacheManager.prepare(a.url);b.loadFile(a.originalAsset?{id:a.originalAsset.id,src:c,data:a.originalAsset}:c)}},h._loadDone=function(a,b){o--;var c=a.originalAsset;c&&c.id&&b&&(b.id=c.id),a.callback(b),q(a),this._tryNextLoad()},h.cancel=function(a){var b=k[a],c=l[a];if(b&&c)return c.close(),delete l[a],delete k[b.url],o--,r(c),q(b),!0;for(var d=0,e=j.length;e>d;d++)if(b=j[d],b.url==a)return j.splice(d,1),q(b),!0;return!1},h._getQI=function(){var a;return m.length?a=m.pop():(a=new d,a._boundFail=this._onLoadFailed.bind(this,a),a._boundProgress=this._onLoadProgress.bind(this,a),a._boundComplete=this._onLoadCompleted.bind(this,a)),a};var q=function(a){a.reset(),m.push(a)};h._getLoader=function(c){var d;return n.length?(d=n.pop(),d._basePath=c):d=new a(!0,c,this._app.options.crossOrigin),b&&d.installPlugin(b),d};var r=function(a){a.removeAll(),n.push(a)};h._getResult=function(a,b,c,d,e){return new f(a,b,c,d,e)},namespace("springroll").Loader=g}(),function(a){var b,c=include("springroll.Application"),d=include("springroll.LoaderResult"),e={},f=null;e.init=function(c){b===a&&(b=include("springroll.Debug",!1)),f={}},e.load=function(a,b,c){if(Array.isArray(b)&&(c=b,b=null),a&&a.length){for(var d,e=0;e<a.length;e++)if(d=a[e],!d.id)throw"asset missing id";c?c.push({async:g.bind(null,a),complete:b}):g(a,b)}else b&&setTimeout(b,0)};var g=function(a,b){c.instance.load(a,function(a){var c;for(var e in a)c=a[e],f[e]=c instanceof d?c.content:c;b&&b(a)})};e.get=function(a){return f[a]},e.unload=function(a){"string"==typeof a&&(a=Array.prototype.slice.call(arguments)),a.forEach(function(a){var b=a.id||a,c=f[b];c.destroy&&c.destroy(),delete f[b]})},e.unloadAll=function(){for(var a in f){var b=f[a];b.destroy&&b.destroy(),delete f[a]}},namespace("springroll").AssetManager=e}(),function(a){var b=include("springroll.ApplicationPlugin"),c=include("springroll.AssetManager"),d=new b;d.setup=function(){c.init()},d.teardown=function(){c.unloadAll()}}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("springroll.Loader"),c=include("springroll.MultiLoader"),d=new a(100);
d.setup=function(){var a=this.loader=b.init(this),d=this.multiLoader=new c;d.register("springroll.LoadTask",0),d.register("springroll.FunctionTask",10),d.register("springroll.ColorAlphaTask",20),this.options.add("cacheBust",!1).respond("cacheBust",function(){return a.cacheManager.cacheBust}).on("cacheBust",function(b){a.cacheManager.cacheBust="true"==b||!!b}),this.options.add("basePath",null),this.options.add("version",null,!0),this.options.add("versionsFile",null,!0),this.load=function(a,b,c,d,e){return"string"==typeof a&&(a={src:a,complete:b,progress:c,priority:d,data:e}),this.multiLoader.load(a,b,c)}},d.preload=function(a){var b=this.options.versionsFile;b?this.loader.cacheManager.addVersionsFile(b,a):a()},d.teardown=function(){this.loader&&(this.loader.destroy(),this.loader=null),this.multiLoader&&(this.multiLoader.destroy(),this.multiLoader=null)}}(),function(){var a,b=include("springroll.ApplicationPlugin"),c=new b(80);c.setup=function(){a=include("springroll.Debug",!1),this.options.add("configPath",null,!0),this.options.add("preload",[],!0),this.config=null},c.preload=function(a){var b=this.options.preload||[],c=this.options.configPath;c&&b.push({id:"config",src:c,complete:d.bind(this)}),this.trigger("loading",b);var f=e.bind(this,a);b.length?this.load(b,f):f()};var d=function(a,b){var c=this.config=a.content;this.trigger("configLoaded",c,b)},e=function(a,b){this.trigger("loaded",b),a()};c.teardown=function(){this.config=null}}(),function(a){var b=function(a,b){b=b||{},this.canvas=document.getElementById(a),this.id=a,this.width=this.canvas.width,this.height=this.canvas.height,this.stage=null,this.paused=!1,this._enabled=!1,this._visible="none"!=this.canvas.style.display,this.canvas.onmousedown=function(a){a.preventDefault()},this.animator=null,this.adapter=null},c=b.prototype;Object.defineProperty(c,"enabled",{get:function(){return this._enabled},set:function(a){this._enabled=a}}),Object.defineProperty(c,"visible",{get:function(){return this._visible},set:function(a){this._visible=a,this.canvas.style.display=a?"block":"none"}}),c.resize=function(a,b){this.width=this.canvas.width=a,this.height=this.canvas.height=b},c.render=function(a,b){},c.destroy=function(){this.enabled=!1,this.animator=null,this.adapter=null,this.stage=null,this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas.onmousedown=null,this.canvas=null},namespace("springroll").AbstractDisplay=b}(),function(){var a=include("springroll.Application"),b=include("springroll.EventDispatcher");a.prototype.getDisplays=function(a){return console.warn("getDisplays is now deprecated, please use displays property, e.g.: app.displays.forEach(function(display){});"),"function"==typeof a&&_displays.forEach(a),_displays},b.mixIn=function(a,c){return console.log("mixIn is now deprecated, please use window.mixin, e.g.: mixin(object, EventDispatcher);"),mixin(a,b)}}();}();